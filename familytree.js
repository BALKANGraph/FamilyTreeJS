FamilyTree.__defaultConfig=FamilyTree._defaultConfig,FamilyTree._defaultConfig=function(){var e=FamilyTree.__defaultConfig();return e.nodeTreeMenu=null,e.template="tommy",e.mode="light",e.minPartnerSeparation=30,e.partnerChildrenSplitSeparation=10,e.siblingSeparation=35,e.tags["children-group"]={template:"cgroup",subTreeConfig:{siblingSeparation:7,columns:1}},e},FamilyTree.events.on("render",(function(e,t){if(e.recentRoots||(e.recentRoots=[]),e.config.roots)for(var i=0;i<e.config.roots.length;i++){var r=e.recentRoots.indexOf(e.config.roots[i]);-1!=r&&e.recentRoots.splice(r,1),e.recentRoots.unshift(e.config.roots[i])}})),FamilyTree.events.on("render-link",(function(e,t){null!=t.cnode.ppid&&t.cnode.layout!=FamilyTree.mixed&&(t.html+='<use xlink:href="#dot" x="'+t.p.xa+'" y="'+t.p.ya+'"/>')})),FamilyTree.events.on("click",(function(e,t){var i=e._get(t.node.id);if(i._ft_method)return"addParentNode"==i._ft_method?e[i._ft_method](i._ft_childId,i._ft_type,i._ft_data,null,!0):"addChildAndPartnerNodes"==i._ft_method?e[i._ft_method](i._ft_id,i._ft_childData,i._ft_parentData,null,!0):e[i._ft_method](i._ft_data,null,!0),!1;for(var r=t.event.target;r;){if(r.getAttribute&&(r.hasAttribute("data-ctrl-n-t-menu-id")||r.hasAttribute("data-ctrl-n-t-menu-c"))){var a=r.getAttribute("data-ctrl-n-t-menu-id");return FamilyTree.isNEU(a)?e.hideTreeMenu(!0):e.showTreeMenu(a),t.event.stopPropagation(),t.event.preventDefault(),!1}r=r.parentNode}})),FamilyTree.prototype.getRecentRootsByNodeId=function(e){this.recentRoots||(this.recentRoots=[]);var t=this.recentRoots,i=this.getNode(e);return i?(i.rids.sort((function(e,i){var r=t.indexOf(e),a=t.indexOf(i);return-1==r?1e3:-1==a?-1e3:r-a})),i.rids):[]},FamilyTree.prototype._nodeHasHiddenParent=function(e){return!(e.parent||FamilyTree.isNEU(e.pid)||!this.getNode(e.pid))||(!(!e.isPartner||FamilyTree.isNEU(e.mid)||!this.getNode(e.mid))||(!(!e.isPartner||FamilyTree.isNEU(e.fid)||!this.getNode(e.fid))||!!(e.isPartner&&e.pids.length>1)))},FamilyTree.prototype._center=FamilyTree.prototype.center,FamilyTree.prototype.center=function(e,t,i){var r=this.getRecentRootsByNodeId(e);Array.isArray(this.config.roots)||(roots=[]),FamilyTree._changeRootOption(this.config.roots,r,this.manager.rootList),this._center(e,t,i)},FamilyTree.localStorage={},FamilyTree.localStorage.getItem=function(e){return localStorage.getItem(e)},FamilyTree.localStorage.setItem=function(e,t){try{localStorage.setItem(e,t)}catch(e){e.code==e.QUOTA_EXCEEDED_ERR?(console.warn("Local storage quota exceeded"),localStorage.clear()):(console.error("Local storage error code:"+e.code),console.error(e))}},FamilyTree.prototype.addChildNode=function(e,t,i){this.hideTreeMenu(!1);var r=this;if(!e||FamilyTree.isNEU(e.mid)&&FamilyTree.isNEU(e.fid))console.error("addSonNode invalid data");else{if(FamilyTree.isNEU(e.id)&&(e.id=this.generateId()),!0===i)if(!1===FamilyTree.events.publish("add",[this,e]))return!1;this.add(e);var a="";FamilyTree.isNEU(e.pid)?FamilyTree.isNEU(e.mid)?FamilyTree.isNEU(e.fid)||(a=e.fid):a=e.mid:a=e.pid,r._draw(!1,FamilyTree.action.insert,{id:a,insertedNodeId:e.id},(function(){r.ripple(e.id),t&&t(),FamilyTree.events.publish("added",[r,e.id])})),FamilyTree.events.publish("adding",[r,e.id])}},FamilyTree.prototype.addChildAndPartnerNodes=function(e,t,i,r,a){this.hideTreeMenu(!1);var o=this;if(!t||FamilyTree.isNEU(t.mid)&&FamilyTree.isNEU(t.fid))console.error("addChildAndPartnerNodes invalid childData");else if(i){FamilyTree.isNEU(t.id)&&(t.id=this.generateId()),FamilyTree.isNEU(i.id)&&(i.id=this.generateId()),"_ft_partner"==t.mid?t.mid=i.id:"_ft_partner"==t.fid&&(t.fid=i.id);var n=null,l=null;if(Array.isArray(i.pids)&&(1!=i.pids.length&&console.error("addChildAndPartnerNodes parentData.pids has to have one partner"),n=this.get(i.pids[0]),l=JSON.parse(JSON.stringify(n)),Array.isArray(n.pids)||(n.pids=[]),n.pids.push(i.id)),!0===a){if(!1===FamilyTree.events.publish("add",[this,t]))return!1;if(!1===FamilyTree.events.publish("add",[this,i]))return!1;if(n)if(!1===FamilyTree.events.publish("update",[this,l,n]))return!1}this.add(t),this.add(i),n&&this.update(n);var s=this.getRecentRootsByNodeId(e);FamilyTree._changeRootOption(this.config.roots,s,this.manager.rootList);var d="";n?d=n.id:FamilyTree.isNEU(t.pid)?FamilyTree.isNEU(t.mid)?FamilyTree.isNEU(t.fid)||(d=t.fid):d=t.mid:d=t.pid,o._draw(!1,FamilyTree.action.update,{id:d},(function(){o.ripple(t.id),o.ripple(i.id),r&&r(),FamilyTree.events.publish("added",[o,t.id]),FamilyTree.events.publish("added",[o,i.id])})),FamilyTree.events.publish("adding",[o,t.id]),FamilyTree.events.publish("adding",[o,i.id])}else console.error("addChildAndPartnerNodes invalid data")},FamilyTree.prototype.addPartnerNode=function(e,t,i){this.hideTreeMenu(!1);var r=this;if(e&&Array.isArray(e.pids)&&1==e.pids.length){FamilyTree.isNEU(e.id)&&(e.id=this.generateId());var a=this.get(e.pids[0]),o=JSON.parse(JSON.stringify(a));if(Array.isArray(a.pids)||(a.pids=[]),a.pids.push(e.id),!0===i){var n=FamilyTree.events.publish("update",[this,o,a]);if(!1===n)return!1;if(!1===(n=FamilyTree.events.publish("add",[this,e])))return!1}this.update(a),this.add(e);var l=this.getRecentRootsByNodeId(a.id);FamilyTree._changeRootOption(this.config.roots,l,this.manager.rootList);var s=a.id;r._draw(!1,FamilyTree.action.insert,{id:s,insertedNodeId:e.id},(function(){r.ripple(e.id),t&&t(),FamilyTree.events.publish("added",[r,e.id])})),FamilyTree.events.publish("adding",[r,e.id])}else console.error("addPartnerNode invalid data")},FamilyTree.prototype.addParentNode=function(e,t,i,r,a){this.hideTreeMenu(!1);var o=this;if(i){if(["mid","fid"].has(t))if(FamilyTree.isNEU(e))console.error("addParentNode invalid childId");else{FamilyTree.isNEU(i.id)&&(i.id=this.generateId());var n=this.get(e),l=JSON.parse(JSON.stringify(n));n[t]=i.id;var s=null,d=null;if(Array.isArray(i.pids)&&(1!=i.pids.length&&console.error("addParentNode: data has to have one partner"),s=this.get(i.pids[0]),d=JSON.parse(JSON.stringify(s)),Array.isArray(s.pids)||(s.pids=[]),s.pids.push(i.id)),!0===a){if(!1===FamilyTree.events.publish("update",[this,l,n]))return!1;if(d)if(!1===FamilyTree.events.publish("update",[this,d,s]))return!1;if(!1===FamilyTree.events.publish("add",[this,i]))return!1}this.update(n),s&&this.update(s),this.add(i);var c=e;this.config.roots=[i.id],this._draw(!1,FamilyTree.action.insert,{id:c,insertedNodeId:i.id},(function(){o.ripple(i.id),r&&r(),FamilyTree.events.publish("added",[o,i.id])})),FamilyTree.events.publish("adding",[o,i.id])}else console.error("addParentNode invalid type")}else console.error("addParentNode invalid data")},FamilyTree.prototype.canRemove=function(e){var t=this.getNode(e);return!!t&&!(t.pids.length>1)},FamilyTree.prototype.removeNode=function(e,t,i){if(this.canRemove(e))return alert("note implemented"),!0},"undefined"==typeof FamilyTree&&(FamilyTree={}),FamilyTree._ajax=function(e,t,i,r,a){null==r&&(r="arraybuffer");var o=new XMLHttpRequest;o.onload=function(e){4==o.readyState&&200===this.status&&(null==e.target?a(this.response):a(e.target.response))},o.onerror=function(e){a({error:e})},o.open(t,e),o.responseType=r,o.setRequestHeader("Content-Type","application/json"),null==i?o.send():o.send(i)},"undefined"==typeof FamilyTree&&(FamilyTree={}),FamilyTree.anim=function(e,t,i,r,a,o,n){var l,s=10,d=1,c=r/s+1;document.getElementsByTagName("g");return Array.isArray(e)||(e=[e]),Array.isArray(t)||(t=[t]),Array.isArray(i)||(i=[i]),l=setInterval((function(){for(var m=0;m<e.length;m++)for(var p in i[m]){var h=FamilyTree._arrayContains(["top","left","right","bottom","width","height"],p.toLowerCase())?"px":"";switch(p.toLowerCase()){case"d":var u=a((d*s-s)/r)*(i[m][p][0]-t[m][p][0])+t[m][p][0],f=a((d*s-s)/r)*(i[m][p][1]-t[m][p][1])+t[m][p][1];e[m].setAttribute("d",e[m].getAttribute("d")+" L"+u+" "+f);break;case"r":var y=a((d*s-s)/r)*(i[m][p]-t[m][p])+t[m][p];e[m].setAttribute("r",y);break;case"x1":y=a((d*s-s)/r)*(i[m][p]-t[m][p])+t[m][p];e[m].setAttribute("x1",y);break;case"x2":y=a((d*s-s)/r)*(i[m][p]-t[m][p])+t[m][p];e[m].setAttribute("x2",y);break;case"y1":y=a((d*s-s)/r)*(i[m][p]-t[m][p])+t[m][p];e[m].setAttribute("y1",y);break;case"y2":y=a((d*s-s)/r)*(i[m][p]-t[m][p])+t[m][p];e[m].setAttribute("y2",y);break;case"rotate3d":if(i[m][p]){var g=t[m][p],b=i[m][p],v=[0,0,0,0];for(var x in g)v[x]=a((d*s-s)/r)*(b[x]-g[x])+g[x];e[m].style.transform="rotate3d("+v.toString()+"deg)"}break;case"transform":if(i[m][p]){g=t[m][p],b=i[m][p],v=[0,0,0,0,0,0];for(var x in g)v[x]=a((d*s-s)/r)*(b[x]-g[x])+g[x];e[m].hasAttribute("transform")?e[m].setAttribute("transform","matrix("+v.toString()+")"):e[m].style.transform="matrix("+v.toString()+")"}break;case"viewbox":if(i[m][p]){g=t[m][p],b=i[m][p],v=[0,0,0,0];for(var x in g)v[x]=a((d*s-s)/r)*(b[x]-g[x])+g[x];e[m].setAttribute("viewBox",v.toString())}break;case"margin":if(i[m][p]){g=t[m][p],b=i[m][p],v=[0,0,0,0];for(var x in g)v[x]=a((d*s-s)/r)*(b[x]-g[x])+g[x];var T="";for(x=0;x<v.length;x++)T+=parseInt(v[x])+"px ";e[m]&&e[m].style&&(e[m].style[p]=T)}break;case"scrolly":y=a((d*s-s)/r)*(i[m][p]-t[m][p])+t[m][p];e[m].scrollTo(0,y);break;default:y=a((d*s-s)/r)*(i[m][p]-t[m][p])+t[m][p];e[m]&&e[m].style&&(e[m].style[p]=y+h)}}n&&n(),(d+=1)>c+1&&(clearInterval(l),o&&o(e))}),s)},FamilyTree.anim.inPow=function(e){return e<0?0:e>1?1:Math.pow(e,2)},FamilyTree.anim.outPow=function(e){if(e<0)return 0;if(e>1)return 1;return-1*(Math.pow(e-1,2)+-1)},FamilyTree.anim.inOutPow=function(e){if(e<0)return 0;if(e>1)return 1;if((e*=2)<1)return FamilyTree.anim.inPow(e,2)/2;return-.5*(Math.pow(e-2,2)+-2)},FamilyTree.anim.inSin=function(e){return e<0?0:e>1?1:1-Math.cos(e*(Math.PI/2))},FamilyTree.anim.outSin=function(e){return e<0?0:e>1?1:Math.sin(e*(Math.PI/2))},FamilyTree.anim.inOutSin=function(e){return e<0?0:e>1?1:-.5*(Math.cos(Math.PI*e)-1)},FamilyTree.anim.inExp=function(e){return e<0?0:e>1?1:Math.pow(2,10*(e-1))},FamilyTree.anim.outExp=function(e){return e<0?0:e>1?1:1-Math.pow(2,-10*e)},FamilyTree.anim.inOutExp=function(e){return e<0?0:e>1?1:e<.5?.5*Math.pow(2,10*(2*e-1)):.5*(2-Math.pow(2,10*(-2*e+1)))},FamilyTree.anim.inCirc=function(e){return e<0?0:e>1?1:-(Math.sqrt(1-e*e)-1)},FamilyTree.anim.outCirc=function(e){return e<0?0:e>1?1:Math.sqrt(1-(e-1)*(e-1))},FamilyTree.anim.inOutCirc=function(e){return e<0?0:e>1?1:e<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(2*e-2)*(2*e-2))+1)},FamilyTree.anim.rebound=function(e){return e<0?0:e>1?1:e<1/2.75?1-7.5625*e*e:e<2/2.75?1-(7.5625*(e-1.5/2.75)*(e-1.5/2.75)+.75):e<2.5/2.75?1-(7.5625*(e-2.25/2.75)*(e-2.25/2.75)+.9375):1-(7.5625*(e-2.625/2.75)*(e-2.625/2.75)+.984375)},FamilyTree.anim.inBack=function(e){return e<0?0:e>1?1:e*e*(2.70158*e-1.70158)},FamilyTree.anim.outBack=function(e){return e<0?0:e>1?1:(e-1)*(e-1)*(2.70158*(e-1)+1.70158)+1},FamilyTree.anim.inOutBack=function(e){return e<0?0:e>1?1:e<.5?4*e*e*(7.1898*e-2.5949)*.5:.5*((2*e-2)*(2*e-2)*(3.5949*(2*e-2)+2.5949)+2)},FamilyTree.anim.impulse=function(e){var t=2*e;return t*Math.exp(1-t)},FamilyTree.anim.expPulse=function(e){return Math.exp(-2*Math.pow(e,2))},"undefined"==typeof FamilyTree&&(FamilyTree={}),FamilyTree.prototype._attachInitEventHandlers=function(e){this._addEvent(window,"resize",this._resizeHandler)},FamilyTree.prototype._attachEventHandlers=function(e){e=this.getSvg();var t=/iPad|iPhone|iPod/.test(navigator.platform)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1;this.config.enableTouch||t||/Mobi/i.test(navigator.userAgent)||/Android/i.test(navigator.userAgent)?(this._addEvent(e,"touchstart",this._globalMouseDownHandler),this._addEvent(e,"touchend",this._globalClickHandler)):(this._addEvent(e,"mousedown",this._globalMouseDownHandler),this._addEvent(e,"click",this._globalClickHandler),this._addEvent(e,"contextmenu",this._globalContextHandler),this._addEvent(e,"dblclick",this._globalDbClickHandler),this.config.mouseScrool!=FamilyTree.action.zoom&&this.config.mouseScrool!=FamilyTree.action.ctrlZoom||(this._addEvent(e,"DOMMouseScroll",this._mouseScrollHandler),this._addEvent(e,"mousewheel",this._mouseScrollHandler)));var i=this.getMenuButton();i&&this._addEvent(i,"click",this._menuClickHandler)},FamilyTree.prototype._addEvent=function(e,t,i,r){var a,o;(r||(r=""),e.getListenerList||(e.getListenerList={}),e.getListenerList[t+r])||(a=this,o=i,i=function(){if(o)return o.apply(a,[this,arguments[0]])},e.addEventListener?"mousewheel"==t?e.addEventListener(t,n,{passive:!1}):e.addEventListener(t,n,!1):e.attachEvent("on"+t,(function(){var t=i.call(e,window.event);return!1===t&&(window.event.returnValue=!1,window.event.cancelBubble=!0),t})),e.getListenerList[t+r]=n);function n(e){var t=i.apply(this,arguments);return!1===t&&(e.stopPropagation(),e.preventDefault()),t}},FamilyTree.prototype._removeEvent=function(e,t){if(e.getListenerList[t]){var i=e.getListenerList[t];e.removeEventListener(t,i,!1),delete e.getListenerList[t]}},"undefined"==typeof FamilyTree&&(FamilyTree={}),FamilyTree.OC_VERSION=FamilyTree.VERSION,FamilyTree.VERSION="1.00.00",FamilyTree.RENDER_LINKS_BEFORE_NODES=!0,FamilyTree._intersects=function(e,t,i){var r=e.x-i.siblingSeparation/4,a=e.y,o=e.x+e.w+i.siblingSeparation/4,n=e.y;switch(i.orientation){case FamilyTree.orientation.right:case FamilyTree.orientation.right_top:case FamilyTree.orientation.left:case FamilyTree.orientation.left_top:r=e.x,a=e.y-i.siblingSeparation/4,o=e.x,n=e.y+e.h+i.siblingSeparation/4}var l,s,d,c=t.p,m=t.q,p=t.r,h=t.s;return 0!==(l=(o-r)*(h-m)-(p-c)*(n-a))&&(s=((a-n)*(p-r)+(o-r)*(h-a))/l,0<(d=((h-m)*(p-r)+(c-p)*(h-a))/l)&&d<1&&0<s&&s<1)},FamilyTree._addPoint=function(e,t,i,r,a){switch(i.orientation){case FamilyTree.orientation.top:case FamilyTree.orientation.top_left:return FamilyTree._addPointTop(e,t,i,r,a);case FamilyTree.orientation.bottom:case FamilyTree.orientation.bottom_left:return FamilyTree._addPointBottom(e,t,i,r,a);case FamilyTree.orientation.left:case FamilyTree.orientation.left_top:return FamilyTree._addPointLeft(e,t,i,r,a);case FamilyTree.orientation.right:case FamilyTree.orientation.right_top:return FamilyTree._addPointRight(e,t,i,r,a)}},FamilyTree._addPointTop=function(e,t,i,r,a){var o,n,l;return"left"==a?o=e.leftNeighbor?e.x+(e.leftNeighbor.x+e.leftNeighbor.w-e.x)/2:e.x-i.siblingSeparation/2:"right"==a&&(o=e.rightNeighbor?e.x+e.w+(e.rightNeighbor.x-(e.x+e.w))/2:e.x+e.w+i.siblingSeparation/2),t.push([o,t[t.length-1][1]]),t.push([o,e.y-i.levelSeparation/3]),n=t[t.length-1][1],l=o,r.p=o,r.q=n,r.r=l,r},FamilyTree._addPointBottom=function(e,t,i,r,a){var o,n,l;return"left"==a?o=e.leftNeighbor?e.x+(e.leftNeighbor.x+e.leftNeighbor.w-e.x)/2:e.x-i.siblingSeparation/2:"right"==a&&(o=e.rightNeighbor?e.x+e.w+(e.rightNeighbor.x-(e.x+e.w))/2:e.x+e.w+i.siblingSeparation/2),t.push([o,t[t.length-1][1]]),t.push([o,e.y+e.h+i.levelSeparation/3]),n=t[t.length-1][1],l=o,r.p=o,r.q=n,r.r=l,r},FamilyTree._addPointLeft=function(e,t,i,r,a){var o,n=t[t.length-1][0];return"bottom"==a?o=e.rightNeighbor?e.y+e.h+(e.rightNeighbor.y-(e.y+e.h))/2:e.y+e.h+i.siblingSeparation/2:"top"==a&&(o=e.leftNeighbor?e.y+(e.leftNeighbor.y+e.leftNeighbor.h-e.y)/2:e.y-i.siblingSeparation/2),t.push([t[t.length-1][0],o]),t.push([e.x-i.levelSeparation/3,o]),n=t[t.length-1][0],s=o,r.p=n,r.q=o,r.s=s,r},FamilyTree._addPointRight=function(e,t,i,r,a){var o,n=t[t.length-1][0];return"bottom"==a?o=e.rightNeighbor?e.y+e.h+(e.rightNeighbor.y-(e.y+e.h))/2:e.y+e.h+i.siblingSeparation/2:"top"==a&&(o=e.leftNeighbor?e.y+(e.leftNeighbor.y+e.leftNeighbor.h-e.y)/2:e.y-i.siblingSeparation/2),t.push([t[t.length-1][0],o]),t.push([e.x+e.w+i.levelSeparation/3,o]),n=t[t.length-1][0],s=o,r.p=n,r.q=o,r.s=s,r},FamilyTree.editUI=function(){},FamilyTree.editUI.prototype.init=function(e){this.obj=e,this.fields=null,this._event_id=FamilyTree._guid()},FamilyTree.editUI.prototype.on=function(e,t){return FamilyTree.events.on(e,t,this._event_id),this},FamilyTree.editUI.prototype.show=function(e,t,i){if(this.hide(),!1===FamilyTree.events.publish("show",[this,e]))return!1;var r=this,a=this.content(e,t,i);this.obj.element.appendChild(a.element),FamilyTree.input.init(this.obj.element),i?!t&&a.focusId&&FamilyTree.editUI.ficusElement(a.focusId):this.interval=FamilyTree.anim(a.element,{right:-20,opacity:0},{right:0,opacity:1},300,FamilyTree.anim.outSin,(function(){!t&&a.focusId&&FamilyTree.editUI.ficusElement(a.focusId)})),this.obj.element.querySelector("[data-edit-from-close]").addEventListener("click",(function(e){r.hide()})),this.obj.element.querySelector("[data-edit-from-cancel]").addEventListener("click",(function(e){r.hide()})),this.obj.element.querySelector("[data-edit-from-save]").addEventListener("click",(function(t){var i=FamilyTree.input.validateAndGetData(a.element);if(!1!==i){var o=r.obj.get(e),n=FamilyTree.mergeDeep(o,i);r.obj.updateNode(n,null,!0),r.hide()}}));for(var o=this.obj.element.querySelectorAll("[ba-input-btn]"),n=0;n<o.length;n++){o[n].addEventListener("click",(function(t){FamilyTree.events.publish("element-btn-click",[r,{input:this.parentNode.querySelector("input"),nodeId:e}])}))}this.obj.element.querySelector("[data-add-more-fields-btn]").addEventListener("click",(function(e){e.stopPropagation(),e.preventDefault();var t=this,i=FamilyTree.elements.textbox({},{type:"textbox",label:r.obj.config.editForm.addMoreFieldName,btn:r.obj.config.editForm.addMoreBtn},"280px");t.parentNode.insertAdjacentHTML("beforebegin",i.html),t.style.display="none",FamilyTree.input.init(t.parentNode.previousSibling);var a=document.getElementById(i.id);a.focus(),a.nextElementSibling.addEventListener("click",(function(e){e.stopPropagation(),e.preventDefault();var i=r.obj.element.querySelector('[data-binding="'+a.value+'"]');if(FamilyTree.isNEU(a.value)||i)a.focus();else{var o=FamilyTree.elements.textbox({},{type:"textbox",label:a.value,binding:a.value},"280px");a.parentNode.parentNode.parentNode.removeChild(a.parentNode.parentNode),t.parentNode.insertAdjacentHTML("beforebegin",o.html),t.style.display="",FamilyTree.input.init(t.parentNode.previousSibling),document.getElementById(o.id).focus()}}))})),this.obj.element.querySelector("[data-edit-from-btns]").addEventListener("click",(function(t){for(var i=t.target;i&&i.hasAttribute&&!i.hasAttribute("data-edit-from-btn");)i=i.parentNode;if(i&&i.hasAttribute){var o=i.getAttribute("data-edit-from-btn"),n={button:r.obj.config.editForm.buttons[o],name:o,nodeId:e,event:t};if(!1===FamilyTree.events.publish("button-click",[r,n]))return!1;switch(o){case"edit":r.obj.editUI.show(e,!1,!0);break;case"pdf":r.obj.exportPDFProfile({id:e,filename:a.title}),r.hide();break;case"png":r.obj.exportPNGProfile({id:e,filename:a.title}),r.hide();break;case"share":r.obj.shareProfile(e);break;case"remove":r.obj.removeNode(e),r.hide()}}}))},FamilyTree.editUI.ficusElement=function(e){if(!FamilyTree.isNEU(e)){var t=document.getElementById(e);t&&(t.focus(),t.value&&t.value.length&&(t.selectionStart=t.selectionEnd=t.value.length))}},FamilyTree.editUI.prototype.content=function(e,t,i,r,a){var o,n=this.obj.config.editForm.readOnly,l=JSON.parse(JSON.stringify(this.obj.config.editForm.elements)),s=this.obj.config.editForm.addMore,d=this.obj.config.editForm.buttons,c=this.obj.config.editForm.titleBinding,m=this.obj.config.editForm.photoBinding,p=this.obj.getNode(e),h=this.obj._get(e),u=FamilyTree.t(p.templateName,p.min,this.obj.getScale()),f=h[c],y=h[m];if(this.obj.config.editForm.generateElementsFromFields)for(var g=0;g<this.fields.length;g++){var b=this.fields[g];if("tags"!=b){for(var v=!1,x=0;x<l.length;x++){if(Array.isArray(l[x])){for(var T=0;T<l[x].length;T++)if(b==l[x][T].binding){v=!0;break}}else if(b==l[x].binding){v=!0;break}if(v)break}v||l.push({type:"textbox",label:b,binding:b})}}FamilyTree.isNEU(f)&&(f=""),y=FamilyTree.isNEU(y)?FamilyTree.icon.user(150,150,"#8C8C8C",0,0):`<img style="width: 100%;height:100%;border-radius: 50%;" src="${y}"></img>`;var F=!t,_=t?"display:none;":"",w=t||!s?"display:none;":"",k=u.editFormHeaderColor?`style="background-color:${u.editFormHeaderColor};"`:"",A=document.createElement("div");if(A.setAttribute("data-edit-form",""),A.classList.add("edit-form"),A.classList.add(this.obj.config.mode),A.classList.add(p.templateName),Array.isArray(p.tags)&&p.tags.length)for(g=0;g<p.tags.length;g++)A.classList.add(p.tags[g]);A.style.display="flex",A.style.opacity=i?1:0,A.style.right=i?0:"-20px",r&&(A.style.width=r);var C=[],S=a?"":'<svg data-edit-from-close class="edit-form-close"><path style="fill:#ffffff;" d="M21.205,5.007c-0.429-0.444-1.143-0.444-1.587,0c-0.429,0.429-0.429,1.143,0,1.571l8.047,8.047H1.111 C0.492,14.626,0,15.118,0,15.737c0,0.619,0.492,1.127,1.111,1.127h26.554l-8.047,8.032c-0.429,0.444-0.429,1.159,0,1.587 c0.444,0.444,1.159,0.444,1.587,0l9.952-9.952c0.444-0.429,0.444-1.143,0-1.571L21.205,5.007z"></path></svg>';return A.innerHTML=`<div>\n                        <div class="edit-form-header" ${k}>\n                            ${S}\n                            <h1 class="edit-form-title">${f}</h1>\n                            <div class="edit-form-avatar">${y}</div>                        \n                        </div>\n                        <div data-edit-from-btns class="edit-form-instruments">\n                        ${function(){if(a)return"";var e="";for(var i in d){var r=d[i];FamilyTree.isNEU(r)||(F&&r.hideIfEditMode||t&&r.hideIfDetailsMode||n&&r.hideIfDetailsMode||(e+=`<div data-edit-from-btn='${i}' class="ba-img-button" ${k} title="${r.text}">${r.icon}</div>`))}return e}()}    \n                        </div>\n                    </div>\n                    <div class="edit-form-fields">\n                        <div class="edit-form-fields-inner">\n                            <div class="ba-form-fieldset">\n                                ${function(){for(var e="",i=0;i<l.length;i++){var r=l[i];if(Array.isArray(r)){e+='<div class="ba-form-field-100 ba-form-fieldset">';for(var a=0;a<r.length;a++){var n=r[a],s=FamilyTree.elements[n.type](h,n,"unset",t);!FamilyTree.isNEU(s.id)&&FamilyTree.isNEU(o)&&FamilyTree.isNEU(s.value)&&(o=s.id),FamilyTree.isNEU(s.value)||C.push(`${n.label}: ${s.value}`),e+=s.html}e+="</div>"}else{s=FamilyTree.elements[r.type](h,r,"280px",t);!FamilyTree.isNEU(s.id)&&FamilyTree.isNEU(o)&&FamilyTree.isNEU(s.value)&&(o=s.id),FamilyTree.isNEU(s.value)||C.push(`${r.label}: ${s.value}`),e+=s.html}}return e}()}\n\n                                <div class="ba-form-field" style="min-width: 280px; text-align:center; ${w}">\n                                    <a data-add-more-fields-btn href="#" class="ba-link">${s}</a>\n                                </div>\n                            </div>        \n                        </div>\n                    </div>\n                    <div class="ba-form-fieldset" style="padding: 14px 10px; ${_}">\n                        <div class="ba-form-field" style="min-width: initial;">\n                            <button data-edit-from-cancel type="button" class="ba-button transparent">Cancel</button>\n                        </div>\n                        <div class="ba-form-field" style="min-width: initial;">\n                            <button data-edit-from-save type="button" class="ba-button">Save and close</button>\n                        </div>\n                    </div>`,{element:A,focusId:o,title:f,shareText:C.join("\n")}},FamilyTree.editUI.prototype.hide=function(){if(!1===FamilyTree.events.publish("hide",[this]))return!1;FamilyTree.isNEU(this.interval)&&(clearInterval(this.interval),this.interval=null);var e=this.obj.element.querySelector("[data-edit-form]");e&&e.parentNode&&e.parentNode.removeChild(e)},FamilyTree.prototype.getSvg=function(){var e=this.element.getElementsByTagName("svg");return e&&e.length?e[0]:null},FamilyTree.prototype.getPointerElement=function(){return this.element.querySelector("g[data-pointer]")},FamilyTree.prototype.getNodeElement=function(e){return this.element.querySelector("g["+FamilyTree.attr.node_id+"='"+e+"']")},FamilyTree.prototype.getMenuButton=function(){return this.element.querySelector("["+FamilyTree.attr.control_export_menu+"]")},FamilyTree.menuUI=function(){},FamilyTree.menuUI.prototype.init=function(e,t){this.obj=e,this.wrapper=null,this.menu=t,this._event_id=FamilyTree._guid()},FamilyTree.menuUI.prototype.showStickIn=function(e,t,i,r){this._show(e,null,t,i,r)},FamilyTree.menuUI.prototype.show=function(e,t,i,r,a){this._show(e,t,i,r,a)},FamilyTree.menuUI.prototype._show=function(e,t,i,r,a){var o=this;this.hide();var n="";a||(a=this.menu);var l={firstNodeId:i,secondNodeId:r,menu:a};if(!1===FamilyTree.events.publish("show",[this,l]))return!1;for(var s in a=l.menu){var d=a[s].icon,c=a[s].text;void 0===d&&(d=FamilyTree.icon[s](24,24,"#7A7A7A")),"function"==typeof c&&(c=c()),"function"==typeof d&&(d=d()),n+="<div "+FamilyTree.attr.item+'="'+s+'">'+d+"<span>&nbsp;&nbsp;"+c+"</span></div>"}if(""!=n){if(this.wrapper=document.createElement("div"),this.wrapper.className="chart-menu",this.wrapper.style.left="-99999px",this.wrapper.style.top="-99999px",this.wrapper.innerHTML=n,this.obj.element.appendChild(this.wrapper),null==t){var m=FamilyTree._menuPosition(e,this.wrapper,this.obj.getSvg());e=m.x,t=m.y}var p=e+45;this.wrapper.style.left=p+"px",this.wrapper.style.top=t+"px",this.wrapper.style.left=p-this.wrapper.offsetWidth+"px";var h=e-this.wrapper.offsetWidth;FamilyTree.anim(this.wrapper,{opacity:0,left:p-this.wrapper.offsetWidth},{opacity:1,left:h},300,FamilyTree.anim.inOutPow);for(var u=this.wrapper.getElementsByTagName("div"),f=0;f<u.length;f++){(s=u[f]).addEventListener("click",(function(e){var t,n=this.getAttribute(FamilyTree.attr.item);if(void 0===a[n].onClick)if("add"===n){var l={id:o.obj.generateId(),pid:i};o.obj.addNode(l,null,!0)}else if("edit"===n){var s=o.obj.getNode(i);o.obj.editUI.show(s.id)}else if("details"===n){s=o.obj.getNode(i);o.obj.editUI.show(s.id,!0)}else"remove"===n?o.obj.removeNode(i,null,!0):"svg"===n?o.obj.exportSVG({filename:"FamilyTree.svg",expandChildren:!1,nodeId:i}):"pdf"===n?o.obj.exportPDF({filename:"FamilyTree.pdf",expandChildren:!1,nodeId:i}):"png"===n?o.obj.exportPNG({filename:"FamilyTree.png",expandChildren:!1,nodeId:i}):"csv"===n?o.obj.exportCSV():"xml"===n&&o.obj.exportXML();else t=a[n].onClick.call(o.obj,i,r);0!=t&&o.hide()}))}}},FamilyTree.menuUI.prototype.hide=function(){null!=this.wrapper&&(this.obj.element.removeChild(this.wrapper),this.wrapper=null)},FamilyTree.menuUI.prototype.on=function(e,t){return FamilyTree.events.on(e,t,this._event_id),this},FamilyTree.circleMenuUI=function(){},FamilyTree.circleMenuUI.prototype.init=function(e,t){this.obj=e,this.menu=t,this._menu=null,this._buttonsInterval=[],this._linesInterval=[],this._event_id=FamilyTree._guid()},FamilyTree.circleMenuUI.prototype.show=function(e,t){this._show(e,t)},FamilyTree.circleMenuUI.prototype._show=function(e,t){var i=this,r=this.obj.getNode(e),a=FamilyTree.t(r.templateName,r.min,this.obj.getScale());if(!FamilyTree.isNEU(a.nodeCircleMenuButton)){var o=this.obj.getSvg(),n=this.obj.element.querySelector("["+FamilyTree.attr.control_node_circle_menu_id+'="'+e+'"]'),l=this.obj.getNodeElement(e),s=FamilyTree._getTransform(n),d=FamilyTree._getTransform(l),c=s[4]+d[4],m=s[5]+d[5],p=n.querySelectorAll("line"),h=this.obj.element.querySelector("["+FamilyTree.attr.control_node_circle_menu_wrraper_id+"]");if(FamilyTree.isNEU(h)||h.getAttribute(FamilyTree.attr.control_node_circle_menu_wrraper_id)!=e){this.hide(),t||(t=this.menu);var u={nodeId:e,menu:t},f=FamilyTree.events.publish("show",[this,u]);if(this._menu=t,!1===f)return!1;for(var y=0,g=Object.keys(u.menu).length,b=2*a.nodeCircleMenuButton.radius+4,v=2*Math.PI*b,x=v/g-(2*a.nodeCircleMenuButton.radius+2);x<0;)b+=8,x=(v=2*Math.PI*b)/g-(2*a.nodeCircleMenuButton.radius+2);for(var T in(h=document.createElementNS("http://www.w3.org/2000/svg","g")).setAttribute(FamilyTree.attr.control_node_circle_menu_wrraper_id,e),h.setAttribute("transform","matrix(1,0,0,1,"+c+","+m+")"),o.appendChild(h),u.menu){var F=u.menu[T].icon,_=u.menu[T].color,w=u.menu[T].text;"function"==typeof F&&(F=F()),"function"==typeof _&&(_=_()),"function"==typeof w&&(w=w());var k=document.createElementNS("http://www.w3.org/2000/svg","g");k.setAttribute("transform","matrix(1,0,0,1,0,0)"),k.setAttribute(FamilyTree.attr.control_node_circle_menu_name,T),k.style.cursor="pointer";var A=document.createElementNS("http://www.w3.org/2000/svg","title");FamilyTree.isNEU(w)||(A.innerHTML=w);var C=document.createElementNS("http://www.w3.org/2000/svg","circle");C.setAttribute("cx",0),C.setAttribute("cy",0),C.setAttribute("r",a.nodeCircleMenuButton.radius),C.setAttribute("fill",_),C.setAttribute("stroke-width","1"),C.setAttribute("stroke",a.nodeCircleMenuButton.stroke),k.appendChild(C),k.appendChild(A),k.innerHTML+=F,h.appendChild(k);var S=k.getElementsByTagName("svg")[0];if(S.setAttribute("pointer-events","none"),S){var N=parseInt(S.getAttribute("width")),I=parseInt(S.getAttribute("height"));S.setAttribute("x",-N/2),S.setAttribute("y",-I/2)}var M=y*Math.PI/(g/2);y++;var L=Math.cos(M)*b,E=Math.sin(M)*b;this._buttonsInterval.push(FamilyTree.anim(k,{transform:[1,0,0,1,0,0]},{transform:[1,0,0,1,L,E]},250,FamilyTree.anim.outBack,(function(e){var t=e[0].getAttribute(FamilyTree.attr.control_node_circle_menu_name),r=e[0].parentNode.getAttribute(FamilyTree.attr.control_node_circle_menu_wrraper_id);e[0].addEventListener("mouseenter",(function(e){FamilyTree.events.publish("mouseenter",[i,{from:r,menuItem:u.menu[t],menuItemName:t,event:e}])})),e[0].addEventListener("mouseout",(function(e){FamilyTree.events.publish("mouseout",[i,{from:r,menuItem:u.menu[t],menuItemName:t,event:e}])}))})))}this._linesInterval.push(FamilyTree.anim(p[0],{x1:-a.nodeCircleMenuButton.radius/2,y1:-6,x2:a.nodeCircleMenuButton.radius/2,y2:-6},{x1:-7,y1:-7,x2:7,y2:7},500,FamilyTree.anim.inOutSin)),this._linesInterval.push(FamilyTree.anim(p[1],{x1:-a.nodeCircleMenuButton.radius/2,y1:0,x2:a.nodeCircleMenuButton.radius/2,y2:0},{x1:0,y1:0,x2:0,y2:0},500,FamilyTree.anim.inOutSin)),this._linesInterval.push(FamilyTree.anim(p[2],{x1:-a.nodeCircleMenuButton.radius/2,y1:6,x2:a.nodeCircleMenuButton.radius/2,y2:6},{x1:-7,y1:7,x2:7,y2:-7},500,FamilyTree.anim.inOutSin))}else this.hide()}},FamilyTree.circleMenuUI.prototype.hide=function(){for(var e=this._buttonsInterval.length-1;e>=0;e--)clearInterval(this._buttonsInterval[e]),this._buttonsInterval.splice(e,1);this._buttonsInterval=[];for(e=this._linesInterval.length-1;e>=0;e--)clearInterval(this._linesInterval[e]),this._linesInterval.splice(e,1);this._linesInterval=[];var t=this.obj.element.querySelector("["+FamilyTree.attr.control_node_circle_menu_wrraper_id+"]");if(null!=t){var i=t.getAttribute(FamilyTree.attr.control_node_circle_menu_wrraper_id),r=this.obj.getNode(i),a=FamilyTree.t(r.templateName,r.min,this.obj.getScale()),o=this.obj.element.querySelector("["+FamilyTree.attr.control_node_circle_menu_id+'="'+i+'"]').querySelectorAll("line");o[0].setAttribute("x1",-a.nodeCircleMenuButton.radius/2),o[0].setAttribute("x2",a.nodeCircleMenuButton.radius/2),o[0].setAttribute("y1",-6),o[0].setAttribute("y2",-6),o[1].setAttribute("x1",-a.nodeCircleMenuButton.radius/2),o[1].setAttribute("x2",a.nodeCircleMenuButton.radius/2),o[1].setAttribute("y1",0),o[1].setAttribute("y2",0),o[2].setAttribute("x1",-a.nodeCircleMenuButton.radius/2),o[2].setAttribute("x2",a.nodeCircleMenuButton.radius/2),o[2].setAttribute("y1",6),o[2].setAttribute("y2",6),t.parentElement.removeChild(t),t=null}},FamilyTree.circleMenuUI.prototype.on=function(e,t){return FamilyTree.events.on(e,t,this._event_id),this},FamilyTree.toolbarUI=function(){},FamilyTree.toolbarUI.expandAllIcon='<svg style="margin-bottom:7px;box-shadow: 0px 1px 4px rgba(0,0,0,0.3); border: 1px solid #cacaca;background-color: #f9f9f9;display: block;cursor: pointer;" width="32px" height="32px"><marker id="arrow" viewBox="0 0 10 10" refX="5" refY="5" markerWidth="4" markerHeight="4" orient="auto-start-reverse"><path d="M 0 0 L 10 5 L 0 10 z" fill="#757575" /></marker><line x1="11" y1="11" x2="6" y2="6" stroke="#757575" stroke-width="2" marker-end="url(#arrow)" /><line x1="21" y1="11" x2="26" y2="6" stroke="#757575" stroke-width="2" marker-end="url(#arrow)" /><line x1="21" y1="21" x2="26" y2="26" stroke="#757575" stroke-width="2" marker-end="url(#arrow)" /><line x1="11" y1="21" x2="6" y2="26" stroke="#757575" stroke-width="2" marker-end="url(#arrow)" /><rect x="12" y="12" width="8" height="8" fill="#757575"></rect></svg>',FamilyTree.toolbarUI.fitIcon='<svg  style="margin-bottom:7px;box-shadow: 0px 1px 4px rgba(0,0,0,0.3); border: 1px solid #cacaca;background-color: #f9f9f9;display: block;cursor: pointer;" width="32px" height="32px"><path stroke-width="3" fill="none" stroke="#757575" d="M4,11 L4,4 L11,4"></path><path stroke-width="3" fill="none" stroke="#757575" d="M28,11 L28,4 L21,4"></path><path stroke-width="3" fill="none" stroke="#757575" d="M28,21 L28,28 L21,28"></path><path stroke-width="3" fill="none" stroke="#757575" d="M4,21 L4,28 L11,28"></path><circle cx="16" cy="16" r="5" fill="#757575"></circle></svg>',FamilyTree.toolbarUI.openFullScreenIcon='<svg  style="margin-bottom:7px;box-shadow: 0px 1px 4px rgba(0,0,0,0.3); border: 1px solid #cacaca;background-color: #f9f9f9;display: block;cursor: pointer;" width="32px" height="32px"><path stroke-width="3" fill="none" stroke="#757575" d="M4,11 L4,4 L11,4"></path><path stroke-width="3" fill="none" stroke="#757575" d="M28,11 L28,4 L21,4"></path><path stroke-width="3" fill="none" stroke="#757575" d="M28,21 L28,28 L21,28"></path><path stroke-width="3" fill="none" stroke="#757575" d="M4,21 L4,28 L11,28"></path><line x1="5" y1="5" x2="27" y2="27" stroke-width="3" stroke="#757575"></line><line x1="5" y1="27" x2="27" y2="5" stroke-width="3" stroke="#757575"></line></svg>',FamilyTree.toolbarUI.closeFullScreenIcon='<svg  style="margin-bottom:7px;box-shadow: 0px 1px 4px rgba(0,0,0,0.3); border: 1px solid #cacaca;background-color: #f9f9f9;display: block;cursor: pointer;" width="32px" height="32px"><path stroke-width="3" fill="none" stroke="#757575" d="M4,11 L4,4 L11,4"></path><path stroke-width="3" fill="none" stroke="#757575" d="M28,11 L28,4 L21,4"></path><path stroke-width="3" fill="none" stroke="#757575" d="M28,21 L28,28 L21,28"></path><path stroke-width="3" fill="none" stroke="#757575" d="M4,21 L4,28 L11,28"></path><rect x="11" y="11" width="10" height="10" stroke-width="3" fill="none" stroke="#757575" ></rect></svg>',FamilyTree.toolbarUI.zoomInIcon='<svg style="box-shadow: 0px 1px 4px rgba(0,0,0,0.3); border-left: 1px solid #cacaca; border-right: 1px solid #cacaca; border-top: 1px solid #cacaca; background-color: #f9f9f9;display: block; cursor: pointer;" width="32px" height="32px" ><g><rect fill="#f9f9f9" x="0" y="0" width="32" height="32" ></rect><line x1="8" y1="16" x2="24" y2="16" stroke-width="3" stroke="#757575"></line><line x1="16" y1="8" x2="16" y2="24" stroke-width="3" stroke="#757575"></line></g><line x1="4" y1="32" x2="28" y2="32" stroke-width="1" stroke="#cacaca"></line></svg>',FamilyTree.toolbarUI.zoomOutIcon='<svg style="box-shadow: 0px 1px 4px rgba(0,0,0,0.3); margin-bottom:7px; border-left: 1px solid #cacaca; border-right: 1px solid #cacaca; border-bottom: 1px solid #cacaca; background-color: #f9f9f9;display: block; cursor: pointer;" width="32px" height="32px" ><g><rect fill="#f9f9f9" x="0" y="0" width="32" height="32" ></rect><line x1="8" y1="16" x2="24" y2="16" stroke-width="3" stroke="#757575"></line></g></svg>',FamilyTree.toolbarUI.layoutIcon="<svg "+FamilyTree.attr.tlbr+'="layout" style="box-shadow: 0px 1px 4px rgba(0,0,0,0.3); border: 1px solid #cacaca;background-color: #f9f9f9;display: block;cursor: pointer;" width="32px" height="32px"><path stroke-width="3" fill="none" stroke="#757575" d="M8,24 L16,14 L24,24"></path><path stroke-width="3" fill="none" stroke="#757575" d="M8,16 L16,8 L24,16"></path></svg>',FamilyTree.toolbarUI.prototype.init=function(e,t){if(t){this.obj=e,this.toolbar=t,this._visible=!1,this.div=document.createElement("div"),this.div.classList.add("bg-toolbar-container"),Object.assign(this.div.style,{position:"absolute",padding:"3px",right:this.obj.config.padding-10+"px",bottom:this.obj.config.padding-10+"px"}),t.expandAll&&(this.div.innerHTML+="<div "+FamilyTree.attr.tlbr+'="expand">'+FamilyTree.toolbarUI.expandAllIcon+"</div>"),t.fit&&(this.div.innerHTML+="<div "+FamilyTree.attr.tlbr+'="fit">'+FamilyTree.toolbarUI.fitIcon+"</div>"),t.zoom&&(this.div.innerHTML+="<div "+FamilyTree.attr.tlbr+'="plus">'+FamilyTree.toolbarUI.zoomInIcon+"</div>",this.div.innerHTML+="<div "+FamilyTree.attr.tlbr+'="minus">'+FamilyTree.toolbarUI.zoomOutIcon+"</div>"),t.layout&&(this.div.innerHTML+="<div "+FamilyTree.attr.tlbr+'="layout">'+FamilyTree.toolbarUI.layoutIcon+"</div>",this.layouts=document.createElement("div"),this.layouts.innerHTML="<svg "+FamilyTree.attr.layout+'="normal" style="cursor: pointer;" width="110" height="100"><rect fill="#039BE5" x="35" y="0" width="50" height="27"></rect><rect fill="#F57C00" x="7" y="41" width="50" height="27"></rect><rect fill="#F57C00" x="63" y="41" width="50" height="27"></rect><line stroke="#000000" x1="60" x2="60" y1="27" y2="35" stroke-width="1"></line><line stroke="#000000" x1="32" x2="88" y1="35" y2="35" stroke-width="1"></line><line stroke="#000000" x1="32" x2="32" y1="35" y2="41" stroke-width="1"></line><line stroke="#000000" x1="88" x2="88" y1="35" y2="41" stroke-width="1"></line></svg><svg '+FamilyTree.attr.layout+'="treeRightOffset" style="cursor: pointer;" width="110" height="100"><rect fill="#039BE5" x="35" y="0" width="50" height="27"></rect><rect fill="#F57C00" x="40" y="41" width="50" height="27"></rect><rect fill="#F57C00" x="40" y="73" width="50" height="27"></rect><line stroke="#000000" x1="60" x2="60" y1="27" y2="35" stroke-width="1"></line><line stroke="#000000" x1="60" x2="35" y1="35" y2="35" stroke-width="1"></line><line stroke="#000000" x1="35" x2="35" y1="35" y2="86" stroke-width="1"></line><line stroke="#000000" x1="35" x2="40" y1="86" y2="86" stroke-width="1"></line><line stroke="#000000" x1="35" x2="40" y1="54" y2="54" stroke-width="1"></line></svg><svg '+FamilyTree.attr.layout+'="treeLeftOffset" style="cursor: pointer;" width="110" height="100"><rect fill="#039BE5" x="35" y="0" width="50" height="27"></rect><rect fill="#F57C00" x="30" y="41" width="50" height="27"></rect><rect fill="#F57C00" x="30" y="73" width="50" height="27"></rect><line stroke="#000000" x1="60" x2="60" y1="27" y2="35" stroke-width="1"></line><line stroke="#000000" x1="60" x2="85" y1="35" y2="35" stroke-width="1"></line><line stroke="#000000" x1="85" x2="85" y1="35" y2="86" stroke-width="1"></line><line stroke="#000000" x1="80" x2="85" y1="86" y2="86" stroke-width="1"></line><line stroke="#000000" x1="80" x2="85" y1="54" y2="54" stroke-width="1"></line></svg><svg '+FamilyTree.attr.layout+'="mixed" style="cursor: pointer;" width="110" height="100"><rect fill="#039BE5" x="35" y="0" width="50" height="27"></rect><rect fill="#F57C00" x="35" y="41" width="50" height="27"></rect><rect fill="#F57C00" x="35" y="73" width="50" height="27"></rect><line stroke="#000000" x1="60" x2="60" y1="27" y2="41" stroke-width="1"></line><line stroke="#000000" x1="60" x2="60" y1="68" y2="73" stroke-width="1"></line></svg><svg '+FamilyTree.attr.layout+'="tree" style="cursor: pointer;" width="110" height="100"><rect fill="#039BE5" x="35" y="0" width="50" height="27"></rect><rect fill="#F57C00" x="7" y="41" width="50" height="27"></rect><rect fill="#F57C00" x="7" y="73" width="50" height="27"></rect><rect fill="#F57C00" x="63" y="41" width="50" height="27"></rect><rect fill="#F57C00" x="63" y="73" width="50" height="27"></rect><line stroke="#000000" x1="60" x2="60" y1="27" y2="86" stroke-width="1"></line><line stroke="#000000" x1="57" x2="63" y1="54" y2="54" stroke-width="1"></line><line stroke="#000000" x1="57" x2="63" y1="86" y2="86" stroke-width="1"></line></svg>',this.obj.element.appendChild(this.layouts),Object.assign(this.layouts.style,{position:"absolute",width:"100%",left:"0",bottom:"-145px","box-shadow":"0px 1px 4px rgba(0,0,0,0.3)","background-color":"#f9f9f9",height:"123px","padding-top":"20px","border-top":"1px solid #cacaca"})),t.fullScreen&&(this.div.innerHTML+="<div "+FamilyTree.attr.tlbr+'="fullScreen">'+FamilyTree.toolbarUI.openFullScreenIcon+"</div>"),this.obj.element.appendChild(this.div),this.layoutBtn=this.div.querySelector("["+FamilyTree.attr.tlbr+'="layout"]');var i=this.div.querySelector("["+FamilyTree.attr.tlbr+'="plus"]'),r=this.div.querySelector("["+FamilyTree.attr.tlbr+'="minus"]'),a=this.div.querySelector("["+FamilyTree.attr.tlbr+'="fit"]'),o=this.div.querySelector("["+FamilyTree.attr.tlbr+'="fullScreen"]'),n=this.div.querySelector("["+FamilyTree.attr.tlbr+'="expand"]'),l=this;i&&i.addEventListener("click",(function(){l.obj.zoom(!0,null,!0)})),r&&r.addEventListener("click",(function(){l.obj.zoom(!1,null,!0)})),a&&a.addEventListener("click",(function(){l.obj.fit()})),o&&o.addEventListener("click",(function(){l.obj.toggleFullScreen()})),n&&n.addEventListener("click",(function(){l.obj.expand(null,"all")})),this.layoutBtn&&this.layoutBtn.addEventListener("click",(function(){l._visible?l.hideLayout():l.showLayout()})),this.layouts&&this.layouts.addEventListener("click",(function(e){for(var t=e.target;t;){if(t.hasAttribute&&t.hasAttribute(FamilyTree.attr.layout)){t=t.getAttribute(FamilyTree.attr.layout),l.obj.setLayout(FamilyTree[t]);break}t=t.parentNode}}))}},FamilyTree.toolbarUI.prototype.showLayout=function(){this._visible=!0,this.layoutBtn.style.transform="rotate(180deg) translateX(0px) translateY(0px)",FamilyTree.anim(this.div,{bottom:this.obj.config.padding-10},{bottom:this.obj.config.padding+135},this.obj.config.anim.duration,this.obj.config.anim.func),FamilyTree.anim(this.layouts,{bottom:-145},{bottom:0},this.obj.config.anim.duration,this.obj.config.anim.func)},FamilyTree.toolbarUI.prototype.hideLayout=function(){this._visible=!1,this.layoutBtn.style.transform="rotate(0deg) translateX(0px) translateY(0px)",FamilyTree.anim(this.div,{bottom:this.obj.config.padding+135},{bottom:this.obj.config.padding-10},this.obj.config.anim.duration,this.obj.config.anim.func),FamilyTree.anim(this.layouts,{bottom:0},{bottom:-145},this.obj.config.anim.duration,this.obj.config.anim.func)},FamilyTree.notifierUI=function(){},FamilyTree.notifierUI.prototype.init=function(e){this.obj=e},FamilyTree.notifierUI.prototype.show=function(e,t){if(null!=e){1==e&&(e=FamilyTree.MAX_NODES_MESS,t="#FFCA28"),2==e&&(e=FamilyTree.OFFLINE_MESS,t="#FFCA28");var i=document.createElement("div");i.innerHTML=e,Object.assign(i.style,{position:"absolute","background-color":t,color:"#ffffff",padding:"15px","border-radius":"40px",opacity:0,overflow:"hidden","white-space":"nowrap","text-align":"center"}),this.obj.element.appendChild(i);var r=this.obj.width()/2-i.offsetWidth/2,a=this.obj.height()/2-i.offsetHeight/2;i.style.left=r+"px",i.style.top=a+"px";var o=i.offsetWidth;i.style.width="20px",FamilyTree.anim(i,{opacity:0,width:10},{opacity:1,width:o},this.obj.config.anim.duration,this.obj.config.anim.func)}},FamilyTree.icon.ft=function(e,t,i,r,a){return`<svg width="${e}" height="${t}" x="${r}" y="${a}" viewBox="0 0 512 512"  >\n                <path fill="${i}" d="m336.061 377.731c-5.086-6.54-14.511-7.717-21.049-2.631l-44.012 34.231v-200.331c0-8.284-6.716-15-15-15s-15 6.716-15 15v200.331l-44.011-34.231c-6.538-5.086-15.962-3.908-21.049 2.631-5.086 6.539-3.908 15.963 2.631 21.049l62.429 48.556v49.664c0 8.284 6.716 15 15 15s15-6.716 15-15v-49.664l62.429-48.556c6.54-5.086 7.717-14.51 2.632-21.049z" />\n                <path fill="${i}" d="m271 497v-49.664l62.429-48.556c6.54-5.086 7.717-14.51 2.631-21.049-5.086-6.54-14.511-7.717-21.049-2.631l-44.011 34.231v-200.331c0-8.284-6.716-15-15-15v318c8.284 0 15-6.716 15-15z" />\n                <path fill="${i}" d="m320 512h-128c-8.284 0-15-6.716-15-15s6.716-15 15-15h128c8.284 0 15 6.716 15 15s-6.716 15-15 15z" />\n                <path fill="${i}" d="m320 482h-64v30h64c8.284 0 15-6.716 15-15s-6.716-15-15-15z" />\n                <path fill="${i}" d="m400 439c-61.206 0-111-49.794-111-111s49.794-111 111-111 111 49.794 111 111-49.794 111-111 111z" />\n                <path fill="${i}" d="m112 439c-61.206 0-111-49.794-111-111s49.794-111 111-111 111 49.794 111 111-49.794 111-111 111z" />\n                <path fill="${i}" d="m256 222c-61.206 0-111-49.794-111-111s49.794-111 111-111 111 49.794 111 111-49.794 111-111 111z" />\n                <path fill="${i}" d="m367 111c0-61.206-49.794-111-111-111v222c61.206 0 111-49.794 111-111z" />\n            </svg>`},FamilyTree.icon.addUser=function(e,t,i,r,a){return FamilyTree.isNEU(r)&&(r=0),FamilyTree.isNEU(a)&&(a=0),`<svg width="${e}" height="${t}" x="${r}" y="${a}" viewBox="0 0 512 512" >\n                <path fill="${i}" d="M300.434,257.599c-25.945,27.304-60.622,43.875-98.602,43.875c-37.979,0-72.656-16.571-98.602-43.875 c-45.617,28.738-77.826,76.818-85.092,132.736c-1.659,12.77,8.291,24.107,21.201,24.107h225.846 c0-53.371,32.011-99.402,77.838-119.914C330.812,280.165,316.452,267.69,300.434,257.599z"/>\n                <ellipse fill="${i}" cx="201.828" cy="133.868" rx="112.229" ry="133.868"/>\n                <path fill="${i}" d="M396.486,316.885c-53.794,0-97.558,43.764-97.558,97.558S342.693,512,396.486,512c53.792,0,97.557-43.764,97.557-97.558 S450.279,316.885,396.486,316.885z M435.199,431.315h-21.841v21.841c0,9.318-7.554,16.872-16.872,16.872 c-9.318,0-16.872-7.554-16.872-16.872v-21.841h-21.842c-9.318,0-16.872-7.554-16.872-16.872c0-9.319,7.554-16.872,16.872-16.872 h21.842v-21.841c0-9.318,7.554-16.872,16.872-16.872c9.318,0,16.872,7.554,16.872,16.872v21.841h21.841 c9.318,0,16.872,7.554,16.872,16.872C452.072,423.761,444.518,431.315,435.199,431.315z"/>\n            </svg>`},FamilyTree.icon.close=function(e,t,i,r,a){return FamilyTree.isNEU(r)&&(r=0),FamilyTree.isNEU(a)&&(a=0),`<svg width="${e}" height="${t}" x="${r}" y="${a}" viewBox="0 0 512 512">\n    <path fill="${i}" d="m256 0c-141.49 0-256 114.5-256 256 0 141.49 114.5 256 256 256 141.49 0 256-114.5 256-256 0-141.49-114.5-256-256-256zm-12.284 317.397-58.121 58.132c-6.565 6.553-15.283 10.166-24.557 10.166-19.196 0-34.734-15.526-34.734-34.734 0-9.274 3.612-17.992 10.166-24.557l58.132-58.121c6.785-6.784 6.785-17.783 0-24.568l-58.132-58.121c-6.553-6.565-10.166-15.283-10.166-24.557 0-19.196 15.526-34.734 34.734-34.734 9.274 0 17.992 3.613 24.557 10.166l58.121 58.132c6.785 6.773 17.784 6.773 24.568 0l58.121-58.132c6.565-6.553 15.283-10.166 24.557-10.166 19.196 0 34.734 15.526 34.734 34.734 0 9.274-3.612 17.992-10.166 24.557l-58.132 58.121c-6.785 6.784-6.785 17.783 0 24.568l58.132 58.121c6.553 6.565 10.166 15.283 10.166 24.557 0 19.196-15.526 34.734-34.734 34.734-9.274 0-17.992-3.613-24.557-10.166l-58.121-58.132c-6.784-6.784-17.784-6.773-24.568 0z"/>\n    </svg>`},FamilyTree.icon.daughter=function(e,t,i,r,a){return FamilyTree.isNEU(r)&&(r=0),FamilyTree.isNEU(a)&&(a=0),`<svg width="${e}" height="${t}" x="${r}" y="${a}" viewBox="0 0 512.879 512.879">\n                <path fill="${i}" d="M213.773,238.933c4.71,0,8.533-3.823,8.533-8.533v-5.615c0.546,0.529,0.922,0.964,0.964,1.024 c1.519,2.918,4.497,4.591,7.578,4.591c1.323,0,2.671-0.307,3.934-0.964c4.181-2.176,5.803-7.33,3.627-11.511 c-2.534-4.872-10.581-13.124-24.636-13.124c-14.054,0-22.101,8.252-24.636,13.124c-2.125,4.087-0.555,8.969,3.456,11.23 c4.011,2.287,9.156,0.811,11.563-3.123c0.077-0.128,0.495-0.623,1.084-1.195v5.564 C205.239,235.11,209.062,238.933,213.773,238.933z"/>\n                <path fill="${i}" d="M256.439,332.8c20.028,0,30.507-9.907,31.633-11.034c3.294-3.294,3.285-8.568,0.043-11.913 c-3.234-3.354-8.61-3.439-12.015-0.247c-0.265,0.247-6.699,6.127-19.661,6.127c-12.774,0-19.209-5.709-19.652-6.118 c-3.336-3.251-8.678-3.217-11.981,0.085c-3.337,3.337-3.337,8.73,0,12.066C225.933,322.893,236.412,332.8,256.439,332.8z"/>\n                <path fill="${i}" d="M365.666,293.547c-49.826-66.441-75.093-133.623-75.093-199.68c0-4.71-3.823-8.533-8.533-8.533s-8.533,3.823-8.533,8.533 c0,68.369,25.31,137.489,75.255,205.542c-12.228,21.623-50.483,76.058-92.322,76.058c-45.218,0-86.255-63.59-94.763-80.614 c-8.388-16.768-24.704-66.765-24.704-98.586v-25.754c20.378-0.572,73.404-3.405,121.813-17.246 c4.531-1.289,7.151-6.016,5.854-10.547c-1.289-4.531-6.008-7.159-10.547-5.854C196.254,153.387,129.114,153.6,128.439,153.6 c-4.71,0-8.533,3.823-8.533,8.533v34.133c0,34.935,17.254,87.723,26.496,106.214c0.452,0.905,46.797,90.052,110.037,90.052 s109.585-89.148,110.037-90.052C367.919,299.588,367.603,296.132,365.666,293.547z"/>\n                <path fill="${i}" d="M316.173,392.533c-4.71,0-8.533,3.823-8.533,8.533v17.067c0,0.06,0.034,0.111,0.034,0.171 c0,0.051-0.034,0.094-0.034,0.154c-0.034,5.205-1.749,50.876-51.2,50.876s-51.166-45.986-51.2-51.2v-17.067 c0-4.71-3.823-8.533-8.533-8.533s-8.533,3.823-8.533,8.533v8.687c-116.028,1.638-168.917,35.9-178.765,65.417l-8.533,25.6 c-1.493,4.471,0.93,9.301,5.402,10.795C7.172,511.863,8.085,512,8.973,512c3.575,0,6.903-2.261,8.098-5.837l8.533-25.6 c6.076-18.227,48.034-52.335,163.132-53.845c3.106,24.422,19.721,59.682,67.704,59.682c53.999,0,68.267-44.425,68.267-67.917 c0-0.06-0.034-0.111-0.034-0.171c0-0.068,0.034-0.119,0.034-0.179v-17.067C324.706,396.356,320.883,392.533,316.173,392.533z"/>\n                <path fill="${i}" d="M256.695,273.067h-0.085c-4.71,0-8.491,3.823-8.491,8.533c0,4.71,3.866,8.533,8.576,8.533 c4.719,0,8.533-3.823,8.533-8.533C265.229,276.89,261.414,273.067,256.695,273.067z"/>\n                <path fill="${i}" d="M512.004,501.641l-8.533-25.591c-4.659-13.978-22.34-28.228-49.792-40.141c-4.318-1.877-9.352,0.102-11.23,4.429 c-1.869,4.318,0.111,9.353,4.437,11.221c26.266,11.401,38.178,23.219,40.388,29.884l8.533,25.6 c1.195,3.575,4.523,5.837,8.098,5.837c0.887,0,1.801-0.145,2.697-0.444C511.074,510.942,513.498,506.112,512.004,501.641z"/>\n                <path fill="${i}" d="M256.439,0c-115.558,0-179.2,63.642-179.2,179.2V256c0,66.039-24.909,141.611-25.165,142.37 c-1.485,4.471,0.93,9.301,5.402,10.795c4.48,1.476,9.301-0.93,10.795-5.402c1.058-3.191,26.035-78.908,26.035-147.763v-76.8 c0-134.008,88.175-162.133,162.133-162.133c100.454,0,162.133,94.43,162.133,162.133v17.067 c0,34.458-21.111,74.163-41.532,112.572c-18.133,34.116-35.268,66.338-35.268,92.228c0,54.11,35.14,89.873,36.634,91.366 c1.596,1.604,3.772,2.5,6.033,2.5c2.261,0,4.437-0.896,6.033-2.5c1.493-1.493,36.634-37.257,36.634-91.366 c0-53.197-17.562-72.303-19.567-74.3c-3.285-3.285-8.559-3.285-11.904-0.051c-3.354,3.234-3.439,8.61-0.265,12.015 c0.145,0.154,14.669,16.256,14.669,62.336c0,33.937-16.444,60.16-25.617,72.149c-9.19-11.947-25.583-38.05-25.583-72.149 c0-21.632,16.162-52.036,33.271-84.215c21.402-40.252,43.529-81.869,43.529-120.585V179.2C435.639,94.438,362.04,0,256.439,0z"/>\n            </svg>`},FamilyTree.icon.son=function(e,t,i,r,a){return FamilyTree.isNEU(r)&&(r=0),FamilyTree.isNEU(a)&&(a=0),`<svg width="${e}" height="${t}" x="${r}" y="${a}"  viewBox="0 0 512.002 512.002">\n                <path fill="${i}" d="M238.934,213.334c0-4.71-3.823-8.533-8.533-8.533h-34.133c-4.71,0-8.533,3.823-8.533,8.533 c0,4.71,3.823,8.533,8.533,8.533h8.533c0,4.71,3.823,8.533,8.533,8.533c4.71,0,8.533-3.823,8.533-8.533h8.533 C235.111,221.867,238.934,218.044,238.934,213.334z"/>\n                <path fill="${i}" d="M121.601,255.19c4.565,13.466,17.178,49.98,24.371,64.358c13.551,27.11,51.977,72.986,110.029,72.986 s96.478-45.875,110.037-72.986c7.185-14.379,19.797-50.893,24.371-64.358c11.025-2.85,19.191-12.885,19.191-24.789v-34.133 c0-11.127-7.134-20.617-17.067-24.141v-44.126c0-33.69-17.741-95.923-83.354-101.931c-0.137-4.028-1.476-7.27-2.953-9.668 c-8.38-13.559-31.94-16.401-50.227-16.401c-151.842,0-153.6,143.616-153.6,145.067c0,4.71,3.814,8.525,8.525,8.525h0.009 c4.702,0,8.525-3.806,8.533-8.516c0.017-5.222,1.937-128.009,136.533-128.009c24.132,0,33.801,5.222,35.703,8.311 c0.282,0.435,0.998,1.604-0.666,4.941c-1.323,2.645-1.178,5.786,0.375,8.303c1.553,2.509,4.301,4.045,7.253,4.045 c75.656,0,76.791,81.86,76.8,85.333v51.2c0,4.71,3.823,8.533,8.533,8.533c4.702,0,8.533,3.831,8.533,8.533v34.133 c0,4.702-3.831,8.533-8.533,8.533c-3.669,0-6.929,2.347-8.098,5.837c-0.162,0.503-16.964,50.816-25.131,67.149 c-1.297,2.594-32.495,63.548-94.771,63.548s-93.466-60.954-94.763-63.548c-8.166-16.333-24.977-66.645-25.139-67.149 c-1.161-3.49-4.42-5.837-8.098-5.837c-4.702,0-8.533-3.831-8.533-8.533v-34.133c0-2.313,0.93-4.412,2.423-5.948 c3.396,7.62,10.607,14.481,23.177,14.481c3.234,0,6.187-1.826,7.637-4.719c7.535-15.061,15.283-30.575,17.399-46.652 c43.665-1.758,108.979-17.323,139.742-41.105c8.201,29.764,32.742,54.596,33.988,55.842c3.337,3.337,8.738,3.337,12.066,0 c3.337-3.336,3.337-8.73,0-12.066c-0.316-0.316-31.633-31.983-31.633-62.234c0-3.831-2.56-7.202-6.255-8.226 c-3.703-1.024-7.62,0.546-9.591,3.831c-14.549,24.243-94.746,47.061-146.287,47.061c-4.71,0-8.533,3.823-8.533,8.533 c0,13.295-6.127,27.102-13.286,41.6c-2.901-1.604-3.703-4.753-3.78-7.467c0-4.71-3.823-8.533-8.533-8.533 c-14.114,0-25.6,11.486-25.6,25.6v34.133C102.401,242.305,110.576,252.34,121.601,255.19z"/>\n                <path fill="${i}" d="M256.001,332.801c20.028,0,30.507-9.907,31.633-11.034c3.294-3.294,3.285-8.567,0.051-11.913 c-3.243-3.354-8.619-3.439-12.023-0.247c-0.265,0.247-6.699,6.127-19.661,6.127c-12.774,0-19.209-5.709-19.652-6.118 c-3.336-3.251-8.678-3.217-11.981,0.085c-3.328,3.337-3.328,8.73,0,12.066C225.503,322.893,235.982,332.801,256.001,332.801z"/>\n                <path fill="${i}" d="M264.79,281.601c0-4.71-3.814-8.533-8.533-8.533h-0.085c-4.71,0-8.491,3.823-8.491,8.533c0,4.71,3.866,8.533,8.576,8.533 C260.976,290.134,264.79,286.311,264.79,281.601z"/>\n                <path fill="${i}" d="M511.745,501.394l-8.713-34.756c-4.386-13.158-30.285-55.484-178.765-56.636v-8.934c0-4.71-3.823-8.533-8.533-8.533 s-8.533,3.823-8.533,8.533v17.067c0,0.06,0.034,0.111,0.034,0.171c0,0.051-0.034,0.094-0.034,0.154 c-0.034,5.205-1.749,50.876-51.2,50.876s-51.166-45.986-51.2-51.2v-17.067c0-4.71-3.823-8.533-8.533-8.533 s-8.533,3.823-8.533,8.533v8.619C77.168,410.556,21.786,428.203,8.79,467.26l-8.533,34.133 c-1.143,4.574,1.638,9.207,6.212,10.351c4.557,1.143,9.199-1.638,10.342-6.204l8.354-33.51 c9.916-29.739,63.309-44.595,163.132-45.338c3.098,24.431,19.712,59.708,67.704,59.708c47.983,0,64.597-35.063,67.703-59.366 c116.958,0.862,157.628,28.467,162.953,44.373l8.533,34.133c0.973,3.874,4.446,6.46,8.269,6.46c0.691,0,1.382-0.077,2.082-0.256 C510.115,510.601,512.888,505.968,511.745,501.394z"/>\n                <path fill="${i}" d="M298.668,230.401c4.71,0,8.533-3.823,8.533-8.533h8.533c4.71,0,8.533-3.823,8.533-8.533c0-4.71-3.823-8.533-8.533-8.533 h-34.133c-4.71,0-8.533,3.823-8.533,8.533c0,4.71,3.823,8.533,8.533,8.533h8.533 C290.134,226.578,293.957,230.401,298.668,230.401z"/>\n            </svg>`},FamilyTree.icon.wife=function(e,t,i,r,a){return FamilyTree.isNEU(r)&&(r=0),FamilyTree.isNEU(a)&&(a=0),`<svg width="${e}" height="${t}" x="${r}" y="${a}" viewBox="0 0 512 512" >\n                <path fill="${i}" d="M128,307.2c4.719,0,8.533-3.823,8.533-8.533V281.6c0-4.71-3.814-8.533-8.533-8.533c-4.719,0-8.533,3.823-8.533,8.533 v17.067C119.467,303.377,123.281,307.2,128,307.2z"/>\n                <path fill="${i}" d="M384,273.067c-4.719,0-8.533,3.823-8.533,8.533v17.067c0,4.71,3.814,8.533,8.533,8.533c4.719,0,8.533-3.823,8.533-8.533 V281.6C392.533,276.89,388.719,273.067,384,273.067z"/>\n                <path fill="${i}" d="M392.183,433.109c-0.162-0.606-0.418-1.152-0.7-1.715c-0.162-0.299-0.196-0.64-0.384-0.93 c-0.094-0.128-0.23-0.196-0.324-0.324c-0.358-0.469-0.802-0.845-1.254-1.246c-0.418-0.375-0.819-0.742-1.306-1.016 c-0.145-0.094-0.23-0.23-0.392-0.316l-34.133-17.067c-2.748-1.357-6.008-1.161-8.55,0.538l-51.209,34.133 c-2.372,1.587-3.797,4.25-3.797,7.1v30.259c-5.077,4.062-17.545,12.407-34.133,12.407c-16.427,0-29.013-8.388-34.133-12.433 v-30.234c0-2.85-1.425-5.513-3.797-7.1l-51.2-34.133c-2.543-1.698-5.803-1.894-8.55-0.538l-34.133,17.067 c-0.154,0.077-0.239,0.213-0.375,0.299c-0.512,0.29-0.939,0.674-1.374,1.075c-0.435,0.384-0.853,0.734-1.186,1.178 c-0.102,0.137-0.256,0.213-0.35,0.35c-0.205,0.307-0.239,0.657-0.401,0.99c-0.265,0.529-0.521,1.05-0.674,1.63 c-0.137,0.529-0.179,1.05-0.205,1.596c-0.034,0.538-0.06,1.058,0.008,1.604c0.068,0.597,0.265,1.143,0.461,1.707 c0.119,0.341,0.111,0.7,0.273,1.024c0.077,0.154,0.222,0.247,0.307,0.393c0.282,0.495,0.666,0.913,1.058,1.348 c0.384,0.427,0.742,0.853,1.186,1.195c0.137,0.102,0.213,0.256,0.35,0.35l51.2,34.133c1.459,0.973,3.106,1.434,4.727,1.434 c2.756,0,5.47-1.331,7.108-3.797c2.62-3.925,1.562-9.225-2.364-11.836l-38.972-25.975l16.555-8.277l43.281,28.851V486.4 c0,2.261,0.896,4.437,2.5,6.033C208.102,493.235,227.2,512,256,512s47.898-18.765,48.7-19.567c1.604-1.596,2.5-3.772,2.5-6.033 v-29.568l43.29-28.851l16.546,8.277l-38.972,25.975c-3.925,2.611-4.983,7.91-2.364,11.836c1.638,2.466,4.352,3.797,7.108,3.797 c1.621,0,3.268-0.461,4.727-1.434l51.2-34.133c0.137-0.094,0.205-0.239,0.333-0.341c0.478-0.35,0.853-0.794,1.254-1.246 c0.358-0.427,0.725-0.811,0.998-1.289c0.085-0.154,0.239-0.247,0.324-0.41c0.171-0.35,0.171-0.725,0.29-1.084 c0.179-0.538,0.367-1.05,0.435-1.613c0.077-0.58,0.051-1.126,0.009-1.698C392.354,434.108,392.32,433.613,392.183,433.109z"/>\n                <path fill="${i}" d="M57.037,409.165c0.896,0.29,1.809,0.435,2.697,0.435c3.575,0,6.903-2.261,8.09-5.837 C68.89,400.572,93.867,324.855,93.867,256v-76.8C93.867,45.193,182.033,17.067,256,17.067c25.199,0,77.636,0,85.649,11.128 c0.333,0.452,0.828,1.135,0.128,3.243c-0.956,2.842-0.341,5.965,1.604,8.235c1.946,2.278,4.932,3.362,7.885,2.876 c10.863-1.792,20.412,0.93,29.184,8.354c22.895,19.396,37.683,69.76,37.683,128.299V256c0,77.457,25.071,145.22,26.138,148.062 c1.656,4.412,6.571,6.639,10.991,5.001c4.412-1.655,6.647-6.571,5.001-10.991C460.006,397.406,435.2,330.257,435.2,256v-76.8 c0-50.415-11.486-114.014-43.716-141.321c-9.745-8.243-20.932-12.621-32.836-12.902c-0.683-2.773-1.903-5.035-3.149-6.767 C343.356,1.374,303.258,0,256,0C140.442,0,76.8,63.642,76.8,179.2V256c0,66.039-24.909,141.611-25.156,142.37 C50.15,402.842,52.565,407.672,57.037,409.165z"/>\n                <path fill="${i}" d="M91.802,426.923C19.814,444.919,1.195,498.492,0.444,500.77c-1.493,4.471,0.922,9.301,5.393,10.795 C6.733,511.864,7.646,512,8.533,512c3.576,0,6.904-2.261,8.09-5.837c0.162-0.469,16.316-46.942,79.309-62.686 c4.574-1.143,7.356-5.777,6.212-10.351C101.001,428.561,96.367,425.771,91.802,426.923z"/>\n                <path fill="${i}" d="M213.333,238.933c4.719,0,8.533-3.823,8.533-8.533v-5.615c0.546,0.529,0.922,0.964,0.964,1.024 c1.519,2.918,4.497,4.591,7.578,4.591c1.323,0,2.671-0.307,3.934-0.964c4.173-2.176,5.803-7.33,3.627-11.511 c-2.534-4.873-10.59-13.124-24.636-13.124c-14.046,0-22.101,8.252-24.636,13.124c-2.125,4.087-0.546,8.969,3.456,11.23 c3.985,2.261,9.148,0.819,11.554-3.123c0.085-0.128,0.503-0.623,1.092-1.195v5.564C204.8,235.11,208.614,238.933,213.333,238.933 z"/>\n                <path fill="${i}" d="M511.556,500.77c-0.751-2.278-19.371-55.851-91.358-73.847c-4.574-1.161-9.199,1.638-10.342,6.204 c-1.143,4.574,1.638,9.207,6.212,10.351c62.524,15.633,78.66,60.809,79.309,62.686c1.186,3.576,4.514,5.837,8.09,5.837 c0.888,0,1.801-0.137,2.697-0.435C510.635,510.071,513.05,505.242,511.556,500.77z"/>\n                <path fill="${i}" d="M256,332.8c20.028,0,30.507-9.907,31.633-11.034c3.294-3.294,3.285-8.567,0.051-11.913 c-3.251-3.345-8.61-3.439-12.015-0.247c-0.273,0.247-6.707,6.127-19.669,6.127c-12.774,0-19.208-5.709-19.652-6.118 c-3.32-3.251-8.67-3.226-11.981,0.085c-3.337,3.337-3.337,8.73,0,12.066C225.493,322.893,235.972,332.8,256,332.8z"/>\n                <path fill="${i}" d="M298.667,238.933c4.719,0,8.533-3.823,8.533-8.533v-5.615c0.546,0.529,0.922,0.964,0.964,1.024 c1.519,2.918,4.497,4.591,7.578,4.591c1.323,0,2.671-0.307,3.934-0.964c4.173-2.176,5.803-7.33,3.627-11.511 c-2.534-4.873-10.59-13.124-24.636-13.124c-14.046,0-22.101,8.252-24.636,13.124c-2.125,4.087-0.546,8.969,3.456,11.23 c3.994,2.261,9.156,0.819,11.554-3.123c0.085-0.128,0.503-0.623,1.092-1.195v5.564 C290.133,235.11,293.948,238.933,298.667,238.933z"/>\n                <path fill="${i}" d="M389.129,189.449c-8.542-6.443-30.729-26.957-30.729-44.382c0-4.71-3.814-8.533-8.533-8.533s-8.533,3.823-8.533,8.533 c0,24.678,24.354,47.249,34.014,55.228c-1.835,33.476-24.917,95.223-33.118,111.625c-7.654,15.317-48.154,63.548-86.229,63.548 s-78.575-48.23-86.229-63.548c-8.542-17.084-33.237-83.379-33.237-115.652v-25.728c33.835-0.802,157.321-6.929,218.453-52.779 c3.772-2.825,4.54-8.175,1.707-11.947c-2.825-3.772-8.175-4.54-11.947-1.707C279.561,152.994,129.51,153.6,128,153.6 c-4.719,0-8.533,3.823-8.533,8.533v34.133c0,36.625,26.871,106.965,35.029,123.281c10.385,20.77,55.834,72.986,101.504,72.986 s91.119-52.216,101.504-72.986c8.158-16.316,35.029-86.656,35.029-123.281C392.533,193.587,391.27,191.061,389.129,189.449z"/>\n            </svg>`},FamilyTree.icon.husband=function(e,t,i,r,a){return FamilyTree.isNEU(r)&&(r=0),FamilyTree.isNEU(a)&&(a=0),`<svg width="${e}" height="${t}" x="${r}" y="${a}" viewBox="0 0 512.007 512.007" >\n                <path fill="${i}" d="M121.835,255.249c6.229,16.196,26.803,68.42,41.737,90.82l1.348,2.039c10.957,16.614,29.295,44.425,91.085,44.425 c61.79,0,80.128-27.81,91.085-44.425l1.348-2.039c14.933-22.4,35.507-74.624,41.737-90.82c11.145-2.773,19.43-12.86,19.43-24.849 v-34.133c0-11.127-7.134-20.617-17.067-24.141V128c0-33.69-17.741-95.923-83.362-101.931c-0.128-4.028-1.459-7.27-2.944-9.668 C297.844,2.85,274.292,0,256.005,0c-151.842,0-153.6,143.616-153.6,145.067c0,4.71,3.814,8.525,8.516,8.525h0.017 c4.702,0,8.516-3.806,8.533-8.508c0.017-5.231,1.937-128.017,136.533-128.017c24.132,0,33.801,5.222,35.712,8.311 c0.265,0.435,0.99,1.604-0.683,4.941c-1.323,2.645-1.178,5.786,0.375,8.303c1.562,2.509,4.301,4.045,7.262,4.045 c75.657,0,76.791,81.86,76.8,85.333v51.2c0,4.71,3.814,8.533,8.533,8.533c4.71,0,8.533,3.831,8.533,8.533V230.4 c0,4.702-3.823,8.533-8.533,8.533c-3.558,0-6.741,2.21-7.996,5.538c-0.247,0.674-25.446,67.644-41.771,92.126l-1.399,2.116 c-10.223,15.514-24.235,36.753-76.834,36.753c-52.599,0-66.611-21.239-76.834-36.753l-1.399-2.116 c-16.324-24.482-41.523-91.452-41.771-92.126c-1.254-3.328-4.437-5.538-7.996-5.538c-4.71,0-8.533-3.831-8.533-8.533v-34.133 c0-2.313,0.922-4.412,2.423-5.948c3.089,6.955,9.421,13.21,20.053,14.268l29.193,21.897c2.27,16.623,16.418,29.517,33.664,29.517 h17.067c18.825,0,34.133-15.309,34.133-34.133c0,18.825,15.309,34.133,34.133,34.133h17.067 c17.237,0,31.394-12.894,33.664-29.517l31.189-23.39c3.772-2.825,4.54-8.175,1.707-11.947c-2.825-3.772-8.175-4.548-11.947-1.707 l-21.751,16.316c-3.251-10.402-12.86-18.022-24.329-18.022h-34.133c-14.114,0-25.6,11.486-25.6,25.6 c0-14.114-11.486-25.6-25.6-25.6h-34.133c-11.469,0-21.077,7.62-24.328,18.022l-16.282-12.211 c6.716-16.23,12.8-40.235,14.524-57.088c26.897-0.478,104.713-3.763,139.332-25.37c7.851,30.31,33.058,55.817,34.321,57.08 c3.336,3.336,8.73,3.336,12.066,0c3.336-3.337,3.336-8.73,0-12.066c-0.316-0.316-31.633-31.983-31.633-62.234 c0-3.831-2.56-7.202-6.255-8.226c-3.661-1.016-7.629,0.546-9.591,3.831c-12.425,20.693-93.022,29.995-146.287,29.995 c-4.719,0-8.533,3.823-8.533,8.533c0,13.858-6.554,41.515-13.508,58.539c-2.722-1.638-3.49-4.693-3.558-7.339 c0-4.71-3.814-8.533-8.533-8.533c-14.114,0-25.6,11.486-25.6,25.6V230.4C102.405,242.389,110.691,252.476,121.835,255.249z M273.071,213.333c0-4.702,3.823-8.533,8.533-8.533h34.133c4.71,0,8.533,3.831,8.533,8.533v8.533 c0,9.412-7.654,17.067-17.067,17.067h-17.067c-9.412,0-17.067-7.654-17.067-17.067V213.333z M187.738,213.333 c0-4.702,3.823-8.533,8.533-8.533h34.133c4.71,0,8.533,3.831,8.533,8.533v8.533c0,9.412-7.654,17.067-17.067,17.067h-17.067 c-9.412,0-17.067-7.654-17.067-17.067V213.333z"/>\n                <path fill="${i}" d="M298.663,307.226c0.009-4.702-3.797-8.533-8.499-8.559c-0.162,0-15.42-0.171-30.345-7.629 c-2.398-1.203-5.231-1.203-7.629,0c-14.925,7.458-30.182,7.629-30.319,7.629c-4.719,0-8.533,3.823-8.533,8.533 s3.814,8.533,8.533,8.533c0.725,0,16.853-0.094,34.133-7.646c17.28,7.552,33.408,7.646,34.133,7.646 C294.84,315.733,298.646,311.927,298.663,307.226z"/>\n                <path fill="${i}" d="M247.471,324.267c-4.719,0-8.533,3.823-8.533,8.533c0,4.71,3.814,8.533,8.533,8.533h17.067 c4.719,0,8.533-3.823,8.533-8.533c0-4.71-3.814-8.533-8.533-8.533H247.471z"/>\n                <path fill="${i}" d="M511.749,501.393l-8.721-34.756c-12.706-38.135-73.114-56.687-184.67-56.687c-0.879,0-1.758,0-2.645,0.009 c-4.053,0.009-7.544,2.867-8.337,6.852l-17.067,84.975c-0.93,4.625,2.065,9.122,6.682,10.052 c4.608,0.896,9.114-2.074,10.044-6.69l15.693-78.114c97.724,0.452,154.436,15.957,163.934,44.373l8.533,34.133 c0.973,3.874,4.446,6.468,8.269,6.46c0.683,0,1.382-0.077,2.074-0.256C510.11,510.601,512.892,505.976,511.749,501.393z"/>\n                <path fill="${i}" d="M204.634,416.461c-0.794-3.994-4.292-6.861-8.363-6.861c-116.386,0-174.148,17.596-187.477,57.66l-8.533,34.133 c-1.152,4.582,1.638,9.207,6.212,10.351C7.164,511.923,7.864,512,8.547,512c3.823,0,7.296-2.586,8.269-6.46l8.346-33.51 c9.95-29.841,63.667-44.689,164.122-45.338l15.693,78.447c0.913,4.617,5.367,7.629,10.035,6.699 c4.617-0.93,7.62-5.427,6.69-10.044L204.634,416.461z"/>\n                <path fill="${i}" d="M256.005,409.6c-14.114,0-25.6,11.486-25.6,25.6c0,11.11,7.159,20.489,17.067,24.021v44.245 c0,4.71,3.814,8.533,8.533,8.533c4.719,0,8.533-3.823,8.533-8.533V459.23c9.907-3.541,17.067-12.919,17.067-24.03 C281.605,421.086,270.119,409.6,256.005,409.6z M256.005,443.733c-4.71,0-8.533-3.831-8.533-8.533 c0-4.702,3.823-8.533,8.533-8.533c4.71,0,8.533,3.831,8.533,8.533C264.538,439.902,260.715,443.733,256.005,443.733z"/>\n            </svg>`},FamilyTree.icon.father=function(e,t,i,r,a){return FamilyTree.isNEU(r)&&(r=0),FamilyTree.isNEU(a)&&(a=0),`<svg width="${e}" height="${t}" x="${r}" y="${a}" viewBox="0 0 512.002 512.002" >\n                <path fill="${i}" d="M366.934,128.001c0-4.71-3.814-8.533-8.533-8.533c-2.091,0-51.2-0.683-51.2-59.733c0-4.71-3.814-8.533-8.533-8.533 s-8.533,3.823-8.533,8.533c0,75.921,67.584,76.8,68.267,76.8C363.12,136.534,366.934,132.711,366.934,128.001z"/>\n                <path fill="${i}" d="M256.001,196.268c0-14.114-11.486-25.6-25.6-25.6h-34.133c-11.46,0-21.069,7.62-24.329,18.022l-21.751-16.316 c-3.772-2.825-9.114-2.048-11.947,1.707c-2.825,3.772-2.065,9.122,1.707,11.947l31.189,23.39 c2.278,16.623,16.418,29.517,33.664,29.517h17.067c18.825,0,34.133-15.309,34.133-34.133c0,18.825,15.309,34.133,34.133,34.133 h17.067c17.237,0,31.394-12.894,33.664-29.517l31.189-23.39c3.772-2.825,4.54-8.175,1.707-11.947 c-2.825-3.772-8.175-4.548-11.947-1.707l-21.751,16.316c-3.251-10.402-12.86-18.022-24.329-18.022h-34.133 C267.487,170.668,256.001,182.153,256.001,196.268z M238.934,204.801c0,9.412-7.654,17.067-17.067,17.067h-17.067 c-9.412,0-17.067-7.654-17.067-17.067v-8.533c0-4.702,3.831-8.533,8.533-8.533h34.133c4.702,0,8.533,3.831,8.533,8.533V204.801z M324.268,196.268v8.533c0,9.412-7.654,17.067-17.067,17.067h-17.067c-9.412,0-17.067-7.654-17.067-17.067v-8.533 c0-4.702,3.823-8.533,8.533-8.533h34.133C320.445,187.734,324.268,191.566,324.268,196.268z"/>\n                <path fill="${i}" d="M298.659,307.226c0.009-4.702-3.797-8.533-8.499-8.559c-0.162,0-15.42-0.171-30.345-7.629 c-2.398-1.203-5.231-1.203-7.629,0c-14.925,7.458-30.191,7.629-30.319,7.629c-4.71,0-8.533,3.823-8.533,8.533 s3.823,8.533,8.533,8.533c0.725,0,16.845-0.094,34.133-7.646c17.28,7.552,33.408,7.646,34.133,7.646 C294.836,315.734,298.642,311.928,298.659,307.226z"/>\n                <path fill="${i}" d="M120.986,237.953c4.378,18.611,18.91,76.877,34.048,99.584c10.974,16.452,36.668,54.997,100.966,54.997 s89.993-38.545,100.966-54.997c15.138-22.707,29.67-80.973,34.048-99.584c10.718-3.055,18.586-12.937,18.586-24.619v-34.133 c0-11.127-7.134-20.617-17.067-24.141v-44.126c0-1.109-1.562-110.933-136.533-110.933c-151.842,0-153.6,126.72-153.6,128 c0,4.702,3.806,8.516,8.516,8.525h0.017c4.693,0,8.516-3.806,8.533-8.499c0.017-4.54,2.048-110.959,136.533-110.959 c117.581,0,119.441,90.061,119.467,93.867v51.2c0,4.71,3.814,8.533,8.533,8.533c4.71,0,8.533,3.831,8.533,8.533v34.133 c0,4.702-3.823,8.533-8.533,8.533c-4.002,0-7.458,2.782-8.337,6.682c-0.162,0.751-16.896,75.52-32.896,99.516 c-10.257,15.386-31.599,47.403-86.767,47.403s-76.51-32.017-86.767-47.403c-15.992-23.979-32.734-98.765-32.905-99.516 c-0.87-3.9-4.326-6.682-8.329-6.682c-4.702,0-8.533-3.831-8.533-8.533v-34.133c0-4.702,3.831-8.533,8.533-8.533 c1.323,0,2.637-0.307,3.814-0.896c2.978-1.493,72.986-37.333,72.986-110.037c0-4.71-3.823-8.533-8.533-8.533 s-8.533,3.823-8.533,8.533c0,56.678-52.523,88.636-62.08,93.978c-13.022,1.186-23.253,12.169-23.253,25.489v34.133 C102.401,225.016,110.269,234.898,120.986,237.953z"/>\n                <path fill="${i}" d="M196.097,416.462c-0.794-3.994-4.292-6.861-8.363-6.861c-140.399,0-168.892,27.409-178.944,57.66l-8.533,34.133 c-1.143,4.582,1.638,9.207,6.204,10.351c0.7,0.179,1.391,0.256,2.082,0.256c3.823,0,7.296-2.586,8.269-6.46l8.354-33.51 c7.339-22.025,31.718-44.527,155.58-45.338l15.693,78.447c0.913,4.617,5.393,7.603,10.035,6.699 c4.625-0.93,7.62-5.427,6.69-10.044L196.097,416.462z"/>\n                <path fill="${i}" d="M511.745,501.394l-8.721-34.756c-7.117-21.342-39.689-57.216-178.782-56.678c-4.062,0.009-7.544,2.867-8.337,6.852 l-17.067,84.975c-0.93,4.625,2.065,9.122,6.682,10.052c4.591,0.896,9.114-2.074,10.044-6.69l15.693-78.114 c103.714,0.674,148.412,23.484,155.401,44.373l8.533,34.133c0.973,3.874,4.446,6.468,8.269,6.46c0.683,0,1.382-0.077,2.074-0.256 C510.106,510.601,512.888,505.976,511.745,501.394z"/>\n                <path fill="${i}" d="M256.257,426.668h-0.085c-4.71,0-8.491,3.823-8.491,8.533s3.866,8.533,8.576,8.533c4.71,0,8.533-3.823,8.533-8.533 S260.967,426.668,256.257,426.668z"/>\n                <path fill="${i}" d="M256.257,494.934h-0.085c-4.71,0-8.491,3.823-8.491,8.533s3.866,8.533,8.576,8.533c4.71,0,8.533-3.823,8.533-8.533 S260.967,494.934,256.257,494.934z"/>\n                <path fill="${i}" d="M247.468,324.268c-4.71,0-8.533,3.823-8.533,8.533c0,4.71,3.823,8.533,8.533,8.533h17.067 c4.719,0,8.533-3.823,8.533-8.533c0-4.71-3.814-8.533-8.533-8.533H247.468z"/>\n                <path fill="${i}" d="M256.257,460.801h-0.085c-4.71,0-8.491,3.823-8.491,8.533c0,4.71,3.866,8.533,8.576,8.533 c4.71,0,8.533-3.823,8.533-8.533C264.79,464.624,260.967,460.801,256.257,460.801z"/>\n            </svg>`},FamilyTree.icon.mother=function(e,t,i,r,a){return FamilyTree.isNEU(r)&&(r=0),FamilyTree.isNEU(a)&&(a=0),`<svg width="${e}" height="${t}" x="${r}" y="${a}" viewBox="0 0 512.011 512.011" >\n                <path fill="${i}" d="M299.355,445.356c-1.621,1.536-2.56,3.755-2.56,5.973c0,2.304,0.939,4.437,2.56,6.059 c1.536,1.621,3.755,2.475,5.973,2.475c2.304,0,4.523-0.853,6.059-2.475c1.621-1.536,2.475-3.755,2.475-6.059 c0-2.219-0.853-4.437-2.475-5.973C308.23,442.113,302.512,442.199,299.355,445.356z"/>\n                <path fill="${i}" d="M276.23,458.668c-1.621,1.621-2.475,3.755-2.475,6.059c0,2.219,0.939,4.437,2.475,5.973 c1.621,1.621,3.84,2.56,6.059,2.56c2.219,0,4.437-0.939,5.973-2.56c1.621-1.536,2.56-3.755,2.56-5.973 c0-2.304-0.939-4.437-2.56-6.059C285.104,455.511,279.387,455.511,276.23,458.668z"/>\n                <path fill="${i}" d="M392.539,196.268c0-2.68-1.263-5.205-3.405-6.818c-8.55-6.443-30.729-26.957-30.729-44.382 c0-4.71-3.823-8.533-8.533-8.533s-8.533,3.823-8.533,8.533c0,24.678,24.354,47.249,34.014,55.228 c-1.835,33.476-24.917,95.223-33.118,111.625c-7.654,15.317-48.154,63.548-86.229,63.548s-78.575-48.23-86.229-63.548 c-8.542-17.084-33.237-83.379-33.237-115.652V170.54c33.835-0.802,157.321-6.929,218.453-52.779 c3.772-2.825,4.531-8.175,1.707-11.947c-2.825-3.763-8.166-4.531-11.947-1.707c-65.186,48.887-215.236,49.493-216.747,49.493 c-4.71,0-8.533,3.823-8.533,8.533v34.133c0,36.625,26.871,106.965,35.029,123.281c10.394,20.77,55.834,72.986,101.504,72.986 s91.11-52.215,101.504-72.986C365.668,303.233,392.539,232.893,392.539,196.268z"/>\n                <path fill="${i}" d="M249.947,463.276c-1.536,1.621-2.475,3.84-2.475,6.059c0,2.219,0.939,4.437,2.475,6.059 c1.621,1.536,3.84,2.475,6.059,2.475s4.437-0.939,6.059-2.475c1.536-1.621,2.475-3.84,2.475-6.059 c0-2.219-0.939-4.437-2.475-6.059C258.907,460.119,253.104,460.119,249.947,463.276z"/>\n                <path fill="${i}" d="M34.139,230.401c0,18.85,6.75,36.659,19.098,50.688c-1.348,5.76-2.031,11.648-2.031,17.579 c0,42.342,34.458,76.8,76.8,76.8c6.494,0,12.954-0.819,19.191-2.432c4.565-1.178,7.305-5.828,6.127-10.394 c-1.178-4.565-5.828-7.305-10.394-6.127c-4.847,1.254-9.865,1.886-14.925,1.886c-32.939,0-59.733-26.795-59.733-59.733 c0-5.922,0.879-11.793,2.603-17.459c0.922-3.021,0.102-6.298-2.133-8.525c-11.307-11.298-17.536-26.308-17.536-42.283 c0-19.251,9.421-37.453,25.199-48.674c3.78-2.688,4.719-7.893,2.116-11.742c-6.707-9.89-10.249-21.461-10.249-33.451 c0-28.843,20.591-53.53,48.947-58.701c2.432-0.452,4.557-1.929,5.811-4.053c18.987-32.137,40.892-56.713,133.888-56.713 c71.714,0,128.947,23.484,142.413,58.436c0.888,2.304,2.731,4.105,5.052,4.949c23.535,8.559,39.356,31.095,39.356,56.081 c0,11.989-3.541,23.561-10.249,33.451c-2.603,3.849-1.664,9.054,2.116,11.742c15.778,11.221,25.199,29.423,25.199,48.674 c0,15.974-6.229,30.984-17.536,42.283c-2.236,2.227-3.055,5.504-2.133,8.525c1.724,5.666,2.603,11.537,2.603,17.459 c0,32.939-26.795,59.733-59.733,59.733c-5.018,0-10.001-0.623-14.814-1.852c-4.574-1.186-9.207,1.579-10.377,6.144 c-1.169,4.574,1.587,9.216,6.153,10.385c6.195,1.587,12.595,2.389,19.038,2.389c42.342,0,76.8-34.458,76.8-76.8 c0-5.931-0.683-11.819-2.031-17.579c12.348-14.029,19.098-31.838,19.098-50.688c0-22.11-9.643-43.128-26.138-57.643 c5.956-11.102,9.071-23.475,9.071-36.224c0-30.865-18.748-58.82-47.044-70.733C395.475,25.704,334.598,0.001,256.919,0.001 c-90.172,0-121.984,21.7-146.62,61.85c-34.475,8.115-59.093,38.921-59.093,74.684c0,12.749,3.115,25.122,9.071,36.224 C43.782,187.274,34.139,208.291,34.139,230.401z"/>\n                <path fill="${i}" d="M316.507,424.876c-1.621,1.621-2.475,3.84-2.475,6.059c0,2.304,0.853,4.437,2.475,6.059 c1.621,1.536,3.755,2.475,5.973,2.475c2.304,0,4.437-0.939,6.059-2.475c1.621-1.621,2.475-3.755,2.475-6.059 c0-2.219-0.853-4.437-2.475-6.059C325.382,421.719,319.664,421.719,316.507,424.876z"/>\n                <path fill="${i}" d="M223.664,458.668c-1.536,1.621-2.475,3.755-2.475,6.059c0,2.219,0.939,4.437,2.475,6.059 c1.621,1.536,3.84,2.475,6.059,2.475c2.304,0,4.437-0.939,6.059-2.475c1.621-1.621,2.475-3.84,2.475-6.059 c0-2.219-0.853-4.437-2.475-6.059C232.624,455.511,226.907,455.511,223.664,458.668z"/>\n                <path fill="${i}" d="M337.67,411.905c1.621-1.621,2.475-3.755,2.475-6.059c0-2.219-0.853-4.437-2.475-6.059 c-3.157-3.157-8.875-3.072-12.032,0.085c-1.621,1.536-2.56,3.755-2.56,5.973c0,2.304,0.939,4.437,2.56,6.059 c1.536,1.621,3.755,2.475,5.973,2.475C333.915,414.38,336.048,413.527,337.67,411.905z"/>\n                <path fill="${i}" d="M213.339,238.935c4.71,0,8.533-3.823,8.533-8.533v-5.615c0.546,0.529,0.922,0.964,0.964,1.024 c1.519,2.918,4.497,4.591,7.578,4.591c1.323,0,2.671-0.307,3.934-0.964c4.181-2.176,5.803-7.33,3.627-11.511 c-2.534-4.873-10.581-13.124-24.636-13.124c-14.054,0-22.101,8.252-24.636,13.124c-2.125,4.087-0.555,8.969,3.456,11.23 c4.011,2.287,9.156,0.811,11.563-3.123c0.077-0.128,0.495-0.623,1.084-1.195v5.564 C204.806,235.112,208.629,238.935,213.339,238.935z"/>\n                <path fill="${i}" d="M256.006,332.801c20.028,0,30.507-9.907,31.633-11.034c3.294-3.294,3.285-8.567,0.043-11.913 c-3.234-3.345-8.61-3.439-12.015-0.247c-0.265,0.247-6.699,6.127-19.661,6.127c-12.774,0-19.208-5.709-19.652-6.118 c-3.336-3.251-8.678-3.217-11.981,0.085c-3.337,3.336-3.337,8.73,0,12.066C225.499,322.894,235.978,332.801,256.006,332.801z"/>\n                <path fill="${i}" d="M298.672,238.935c4.71,0,8.533-3.823,8.533-8.533v-5.615c0.546,0.529,0.922,0.964,0.964,1.024 c1.519,2.918,4.497,4.591,7.578,4.591c1.323,0,2.671-0.307,3.934-0.964c4.181-2.176,5.803-7.33,3.627-11.511 c-2.534-4.873-10.581-13.124-24.636-13.124s-22.101,8.252-24.636,13.124c-2.125,4.087-0.555,8.969,3.456,11.23 c4.011,2.287,9.165,0.811,11.563-3.123c0.077-0.128,0.495-0.623,1.084-1.195v5.564 C290.139,235.112,293.962,238.935,298.672,238.935z"/>\n                <path fill="${i}" d="M511.571,500.771l-8.533-25.6c-8.883-26.658-62.464-65.212-136.098-65.212c-3.482,0-6.613,2.116-7.919,5.333 c-0.316,0.802-33.015,79.642-103.014,79.642c-69.99,0-102.69-79.181-103.014-79.983c-1.306-3.226-4.437-5.35-7.919-5.35 c-106.001,0-130.97,50.185-136.098,65.57l-8.533,25.6c-1.493,4.471,0.93,9.301,5.402,10.795c4.48,1.502,9.301-0.93,10.795-5.402 l8.533-25.6c8.465-25.412,42.974-52.514,114.381-53.845c9.293,19.703,45.577,85.282,116.454,85.282 c70.827,0,107.102-65.229,116.437-84.898c64.051,1.835,108.339,35.294,114.398,53.461l8.533,25.6 c1.195,3.576,4.523,5.837,8.098,5.837c0.887,0,1.801-0.137,2.697-0.435C510.64,510.073,513.064,505.243,511.571,500.771z"/>\n                <path fill="${i}" d="M375.472,281.601v17.067c0,4.71,3.823,8.533,8.533,8.533c4.71,0,8.533-3.823,8.533-8.533v-17.067 c0-4.71-3.823-8.533-8.533-8.533C379.295,273.068,375.472,276.891,375.472,281.601z"/>\n                <path fill="${i}" d="M188.934,405.847c0-2.219-0.939-4.437-2.56-5.973c-3.157-3.243-8.875-3.243-12.032,0 c-1.621,1.536-2.475,3.755-2.475,5.973c0,2.304,0.853,4.437,2.475,6.059s3.755,2.475,6.059,2.475 c2.219,0,4.437-0.853,5.973-2.475C187.995,410.284,188.934,408.151,188.934,405.847z"/>\n                <path fill="${i}" d="M189.531,439.468c2.219,0,4.437-0.939,5.973-2.475c1.621-1.621,2.475-3.755,2.475-6.059c0-2.219-0.853-4.437-2.475-6.059 c-3.157-3.157-8.875-3.157-12.032,0c-1.621,1.621-2.475,3.84-2.475,6.059c0,2.304,0.853,4.437,2.475,6.059 C185.008,438.529,187.227,439.468,189.531,439.468z"/>\n                <path fill="${i}" d="M200.624,445.356c-1.621,1.621-2.56,3.755-2.56,6.059c0,2.219,0.939,4.437,2.56,5.973c1.621,1.621,3.755,2.56,6.059,2.56 c2.219,0,4.437-0.939,5.973-2.56c1.621-1.536,2.475-3.755,2.475-5.973c0-2.304-0.853-4.523-2.475-6.059 C209.499,442.199,203.782,442.199,200.624,445.356z"/>\n                <path fill="${i}" d="M119.472,281.601v17.067c0,4.71,3.823,8.533,8.533,8.533s8.533-3.823,8.533-8.533v-17.067 c0-4.71-3.823-8.533-8.533-8.533S119.472,276.891,119.472,281.601z"/>\n            </svg>`},FamilyTree.icon.teddy=function(e,t,i,r,a){return FamilyTree.isNEU(r)&&(r=0),FamilyTree.isNEU(a)&&(a=0),`<svg width="${e}" height="${t}" x="${r}" y="${a}" viewBox="0 0 512 512">\n                <path fill="${i}" d="M234.513,246.613c9.378-1.929,16.555-9.02,21.487-15.863c4.932,6.844,12.109,13.935,21.487,15.863 c1.459,0.299,3.089,0.486,4.873,0.486c6.118,0,13.978-2.304,22.34-10.667c3.337-3.337,3.337-8.73,0-12.066s-8.73-3.337-12.066,0 c-4.361,4.369-8.337,6.212-11.699,5.53c-6.912-1.408-13.611-12.203-16.401-18.364c9.523-3.866,17.067-13.577,17.067-23.799 c0-9.353-9.566-14.933-25.6-14.933c-16.026,0-25.6,5.581-25.6,14.933c0,10.223,7.535,19.934,17.067,23.799 c-2.807,6.178-9.498,16.956-16.401,18.364c-3.405,0.666-7.339-1.178-11.699-5.53c-3.336-3.337-8.73-3.337-12.066,0 s-3.337,8.73,0,12.066C218.104,247.236,228.062,247.91,234.513,246.613z M263.748,190.669c-1.502,2.944-4.873,5.598-7.748,5.598\ts-6.246-2.654-7.748-5.598C251.793,189.833,260.207,189.833,263.748,190.669z"/>\n                <path fill="${i}" d="M390.033,53.7c1.621,1.613,2.5,3.755,2.5,6.033s-0.879,4.42-2.5,6.025c-3.337,3.337-3.337,8.738,0,12.075 c1.664,1.664,3.849,2.5,6.033,2.5s4.369-0.836,6.033-2.492c4.838-4.838,7.501-11.273,7.501-18.108s-2.662-13.269-7.501-18.099 c-9.984-9.984-26.214-9.984-36.198,0c-3.337,3.328-3.337,8.73,0,12.066s8.73,3.337,12.066,0 C381.303,50.372,386.697,50.372,390.033,53.7z"/>\n                <path fill="${i}" d="M311.467,136.533c7.057,0,12.8-5.743,12.8-12.8c0-7.057-5.743-12.8-12.8-12.8s-12.8,5.743-12.8,12.8 C298.667,130.79,304.41,136.533,311.467,136.533z"/>\n                <path fill="${i}" d="M200.533,136.533c7.057,0,12.8-5.743,12.8-12.8c0-7.057-5.743-12.8-12.8-12.8s-12.8,5.743-12.8,12.8 C187.733,130.79,193.476,136.533,200.533,136.533z"/>\n                <path fill="${i}" d="M115.934,80.333c2.185,0,4.369-0.836,6.042-2.5c3.328-3.337,3.328-8.738-0.009-12.075c-1.613-1.604-2.5-3.746-2.5-6.025 s0.887-4.42,2.509-6.033c3.209-3.226,8.841-3.226,12.058,0c3.328,3.337,8.738,3.328,12.066,0 c3.337-3.328,3.337-8.738,0.009-12.066c-9.677-9.677-26.539-9.668-36.207-0.009c-4.838,4.838-7.501,11.273-7.501,18.108 s2.662,13.269,7.501,18.108C111.565,79.497,113.749,80.333,115.934,80.333z"/>\n                <path fill="${i}" d="M498.552,286.191c-28.262-23.945-91.742-14.2-98.884-13.005c-4.651,0.768-7.791,5.171-7.014,9.813 c0.777,4.651,5.171,7.799,9.813,7.014c17.246-2.867,66.133-6.827,85.052,9.199c5.06,4.284,7.415,9.54,7.415,16.521 c0,3.977-1.476,6.946-4.779,9.626c-24.098,19.567-114.33,5.982-147.063-0.913c-3.703-0.776-7.441,0.981-9.242,4.275 c-1.801,3.311-1.212,7.424,1.434,10.095c0.12,0.119,8.499,8.755,12.493,19.951c-2.125-0.222-4.267-0.367-6.443-0.367 c-37.641,0-68.267,34.458-68.267,76.8c0,7.629,1.024,14.993,2.884,21.956c-3.823,1.715-10.197,3.644-19.951,3.644 c-10.052,0-16.367-2.082-19.908-3.814c1.826-6.912,2.842-14.217,2.842-21.786c0-42.342-30.626-76.8-68.267-76.8 c-2.176,0-4.318,0.145-6.443,0.367c3.994-11.196,12.373-19.831,12.476-19.934c2.671-2.671,3.268-6.775,1.468-10.095 c-1.792-3.319-5.521-5.069-9.259-4.292c-32.725,6.895-122.974,20.48-147.063,0.913c-3.302-2.68-4.779-5.649-4.779-9.626 c0-6.98,2.355-12.228,7.407-16.512c18.867-15.991,67.806-12.066,85.06-9.208c4.651,0.794,9.045-2.364,9.813-7.014 c0.776-4.651-2.364-9.045-7.006-9.813c-7.151-1.195-70.613-10.957-98.884,13.005C4.651,293.649,0,303.863,0,315.733 c0,9.079,3.831,16.998,11.093,22.886c27.179,22.05,102.818,12.783,140.535,6.426c-2.825,5.47-5.188,11.896-6.11,18.825 c-25.216,11.29-43.119,38.98-43.119,71.33c0,42.342,30.626,76.8,68.267,76.8c25.446,0,47.642-15.778,59.383-39.057 c5.743,2.56,14.174,4.924,25.95,4.924c11.674,0,20.164-2.287,26.035-4.77C293.794,496.29,315.938,512,341.333,512 c37.641,0,68.267-34.458,68.267-76.8c0-32.35-17.903-60.041-43.119-71.33c-0.922-6.929-3.277-13.355-6.101-18.825 c37.717,6.357,113.365,15.633,140.527-6.426c7.262-5.888,11.093-13.807,11.093-22.886 C512,303.863,507.349,293.649,498.552,286.191z M170.667,494.933c-28.237,0-51.2-26.795-51.2-59.733s22.963-59.733,51.2-59.733 s51.2,26.795,51.2,59.733S198.904,494.933,170.667,494.933z M392.533,435.2c0,32.939-22.963,59.733-51.2,59.733 c-20.983,0-39.04-14.814-46.942-35.942c-0.145-0.614-0.324-1.186-0.606-1.766c-2.338-6.818-3.652-14.242-3.652-22.025 c0-32.939,22.963-59.733,51.2-59.733C369.57,375.467,392.533,402.261,392.533,435.2z"/>\n                <path fill="${i}" d="M307.2,443.733c0,18.825,15.309,34.133,34.133,34.133c18.825,0,34.133-15.309,34.133-34.133 c0-18.825-15.309-34.133-34.133-34.133C322.509,409.6,307.2,424.909,307.2,443.733z M358.4,443.733 c0,9.412-7.654,17.067-17.067,17.067c-9.404,0-17.067-7.654-17.067-17.067c0-9.412,7.663-17.067,17.067-17.067 C350.746,426.667,358.4,434.321,358.4,443.733z"/>\n                <path fill="${i}" d="M115.541,118.161c-8.619,21.709-13.141,45.525-13.141,69.572c0,67.849,52.762,136.533,153.6,136.533 s153.6-68.685,153.6-136.533c0-24.491-4.412-47.846-13.107-69.581c26.957-5.76,47.24-29.764,47.24-58.419 C443.733,26.795,416.93,0,384,0c-24.67,0-46.14,14.916-55.108,36.745C307.115,23.859,282.368,17.067,256,17.067 c-26.615,0-51.2,6.716-73.259,19.925C174.08,14.754,153.088,0,128,0C95.061,0,68.267,26.795,68.267,59.733 C68.267,88.397,88.559,112.41,115.541,118.161z M128,17.067c19.226,0,35.021,12.177,40.115,30.054 c-11.085,8.61-21.163,18.816-29.901,30.592c-2.807,3.789-2.014,9.131,1.775,11.938c3.789,2.816,9.139,2.022,11.938-1.766 c8.9-12.006,19.26-22.281,30.788-30.507C204.288,41.95,228.949,34.133,256,34.133c41.429,0,78.396,19.098,104.098,53.786 c1.681,2.253,4.25,3.447,6.869,3.447c1.766,0,3.55-0.546,5.077-1.681c3.78-2.799,4.574-8.149,1.775-11.938 c-8.969-12.092-19.157-22.485-30.345-31.104c5.427-17.374,21.632-29.577,40.525-29.577c23.526,0,42.667,19.14,42.667,42.667 S407.526,102.4,384,102.4c-2.935,0-5.658,1.502-7.228,3.985c-1.553,2.483-1.732,5.589-0.461,8.243 c10.761,22.443,16.222,47.044,16.222,73.105C392.533,247.1,345.634,307.2,256,307.2s-136.533-60.1-136.533-119.467 c0-25.617,5.615-50.901,16.23-73.122c1.263-2.637,1.084-5.751-0.478-8.226c-1.562-2.483-4.292-3.985-7.219-3.985 c-23.526,0-42.667-19.14-42.667-42.667S104.474,17.067,128,17.067z"/>\n                <path fill="${i}" d="M256,290.133c47.053,0,85.333-30.626,85.333-68.267c0-36.258-36.489-76.8-85.333-76.8s-85.333,40.542-85.333,76.8 C170.667,259.507,208.947,290.133,256,290.133z M256,162.133c38.451,0,68.267,32.111,68.267,59.733 c0,28.237-30.626,51.2-68.267,51.2c-37.641,0-68.267-22.963-68.267-51.2C187.733,194.244,217.557,162.133,256,162.133z"/>\n                <path fill="${i}" d="M170.667,409.6c-18.825,0-34.133,15.309-34.133,34.133c0,18.825,15.309,34.133,34.133,34.133 s34.133-15.309,34.133-34.133C204.8,424.909,189.491,409.6,170.667,409.6z M170.667,460.8c-9.412,0-17.067-7.654-17.067-17.067 c0-9.412,7.654-17.067,17.067-17.067c9.412,0,17.067,7.654,17.067,17.067C187.733,453.146,180.079,460.8,170.667,460.8z"/>\n            </svg>`},FamilyTree.prototype.exportPDFProfile=function(e,t){e=this._defaultExportProfileOptions(e,"pdf"),this._exportProfile(e,t)},FamilyTree.prototype.exportPNGProfile=function(e,t){e=this._defaultExportProfileOptions(e,"png"),this._exportProfile(e,t)},FamilyTree.prototype.shareProfile=function(e){var t;"object"==typeof e?e=(t=e).focusId:t=this.editUI.content(e,!0,!0,"100%",!0);var i=new URL(window.location.href);i.searchParams.append("nodeId",e);var r={title:t.title,text:t.shareText,url:i.href};try{navigator.share(r)}catch(e){console.error("error: "+e)}},FamilyTree.prototype.exportPDF=function(e,t){e=this._defaultExportOptions(e,"pdf"),this._export(e,t)},FamilyTree.prototype.exportPNG=function(e,t){e=this._defaultExportOptions(e,"png"),this._export(e,t)},FamilyTree.prototype.exportSVG=function(e,t){e=this._defaultExportOptions(e,"svg"),this._export(e,t)},FamilyTree.prototype._defaultExportOptions=function(e,t){return null==e&&(e={}),"svg"==t?(e.ext="svg",e.mime="image/svg+xml"):"pdf"==t?(e.mime="application/pdf",e.ext="pdf"):"png"==t&&(e.mime="image/png",e.ext="png"),null==e.margin&&(e.margin=[50,40,50,40]),null==e.padding&&(e.padding=0),null==e.landscape&&(e.landscape=!1),null==e.filename&&(e.filename="FamilyTree."+e.ext),null==e.scale&&(e.scale="fit"),null==e.format&&(e.format="fit"),null==e.header&&(e.header=""),null==e.footer&&(e.footer="Page {current-page} of {total-pages}"),null==e.openInNewTab&&(e.openInNewTab=!1),null==e.mode&&(e.mode=this.config.mode),e},FamilyTree.prototype._export=function(e,t){var i=this,r={id:e.nodeId,expandChildren:e.expandChildren};e.margin&&e.margin[0]<2&&(e.margin[0]=2),e.margin&&e.margin[1]<2&&(e.margin[1]=2),e.margin&&e.margin[2]<2&&(e.margin[2]=2),e.margin&&e.margin[3]<2&&(e.margin[3]=2),this._draw(!1,FamilyTree.action.exporting,r,(function(r){var a=document.createElement("div");if(a.innerHTML=r,e.padding>0){var o=a.querySelector("svg"),n=FamilyTree._getViewBox(o);n[0]-=e.padding,n[1]-=e.padding,n[2]+=2*e.padding,n[3]+=2*e.padding,o.setAttribute("viewBox",n.join()),o.setAttribute("width",n[2]),o.setAttribute("height",n[3])}if("svg"==e.ext)if(t)t(e,a.innerHTML);else{(o=a.querySelector("svg")).classList.add(i.config.mode);var l={content:a.innerHTML,options:e,styles:""},s=FamilyTree.events.publish("exportstart",[i,l]),d=i.element.querySelector("[data-ba-styles]");if(d&&(l.styles+=d.outerHTML),l.styles&&(a.childNodes[0].insertAdjacentHTML("afterbegin",l.styles),l.content=a.innerHTML),!1===s)return!1;if(!1===(s=FamilyTree.events.publish("exportend",[i,l])))return!1;FamilyTree._downloadFile(e.mime,l.content,l.options.filename,l.options.openInNewTab)}else i._pages(e,a.querySelector("svg"),(function(r){var o={content:a.innerHTML,options:e,pages:r,styles:""},n=FamilyTree.events.publish("exportstart",[i,o]),l=i.element.querySelector("[data-ba-styles]");if(l&&(o.styles+=l.outerHTML),!1===n)return!1;t||FamilyTree.loading.show(i),t?t(i,o,a.querySelector("svg")):(o=JSON.stringify(o),FamilyTree._ajax(i.config.exportUrl+"/v3","POST",o,"arraybuffer",(function(t){var r=FamilyTree.events.publish("exportend",[i,t]);if(FamilyTree.loading.hide(i),!1===r)return!1;FamilyTree._downloadFile(e.mime,t,e.filename,e.openInNewTab)})))}))}))},FamilyTree.prototype.exportCSV=function(e){e||(e="FamilyTree.csv");var t={ext:"csv",filename:e,nodes:JSON.parse(JSON.stringify(this.config.nodes))};if(!1===FamilyTree.events.publish("exportstart",[this,t]))return!1;var i=FamilyTree._json2csv(t.nodes),r={ext:t.ext,filename:t.filename,nodes:t.nodes,content:i};if(!1===FamilyTree.events.publish("exportend",[this,r]))return!1;FamilyTree._downloadFile("text/csv;charset=utf-8;","\ufeff"+r.content,r.filename,r.openInNewTab)},FamilyTree.prototype.exportXML=function(e){e||(e="FamilyTree.xml");var t={ext:"xml",filename:e,nodes:JSON.parse(JSON.stringify(this.config.nodes))};if(!1===FamilyTree.events.publish("exportstart",[this,t]))return!1;var i=FamilyTree._json2xml(t.nodes),r={ext:t.ext,filename:t.filename,nodes:t.nodes,content:i};if(!1===FamilyTree.events.publish("exportend",[this,r]))return!1;FamilyTree._downloadFile("application/xml",r.content,r.filename,r.openInNewTab)},FamilyTree.prototype._pages=function(e,t,i){"A5"==e.format&&"fit"!=e.scale||"A4"==e.format&&"fit"!=e.scale||"A3"==e.format&&"fit"!=e.scale||"A2"==e.format&&"fit"!=e.scale||"A1"==e.format&&"fit"!=e.scale||"Letter"==e.format&&"fit"!=e.scale||"Legal"==e.format&&"fit"!=e.scale?i(this._pagesA100(e,t,e.scale)):"A5"==e.format&&"fit"==e.scale||"A4"==e.format&&"fit"==e.scale||"A3"==e.format&&"fit"==e.scale||"A2"==e.format&&"fit"==e.scale||"A1"==e.format&&"fit"==e.scale||"Letter"==e.format&&"fit"==e.scale||"Legal"==e.format&&"fit"==e.scale?i(this._pagesAfit(e,t)):"fit"==e.format&&i(this._pagesFit(e,t))},FamilyTree.prototype._pagesFit=function(e,t){var i=t.getAttribute("width"),r=t.getAttribute("height"),a=FamilyTree._getViewBox(t),o={w:parseFloat(i),h:parseFloat(r)};return[{vb:a,size:{w:o.w+(e.margin[1]+e.margin[3]),h:o.h+(e.margin[0]+e.margin[2])},innerSize:o}]},FamilyTree.prototype._pagesAfit=function(e,t){var i=t.getAttribute("width"),r=0,a=0;switch(e.format){case"A5":r=FamilyTree.A5w,a=FamilyTree.A5h;break;case"A4":r=FamilyTree.A4w,a=FamilyTree.A4h;break;case"A3":r=FamilyTree.A3w,a=FamilyTree.A3h;break;case"A2":r=FamilyTree.A2w,a=FamilyTree.A2h;break;case"A1":r=FamilyTree.A1w,a=FamilyTree.A1h;break;case"Letter":r=FamilyTree.Letterw,a=FamilyTree.Letterh;break;case"Legal":r=FamilyTree.Legalw,a=FamilyTree.Legalh}var o=e.landscape?a-(e.margin[1]+e.margin[3]):r-(e.margin[1]+e.margin[3]),n=(e.landscape?(e.margin[0],e.margin[2]):(e.margin[0],e.margin[2]),o/i);return this._pagesA100(e,t,100*n)},FamilyTree.prototype._pagesA100=function(e,t,i){var r=FamilyTree._getViewBox(t),a=0,o=0;switch(e.format){case"A5":a=FamilyTree.A5w,o=FamilyTree.A5h;break;case"A4":a=FamilyTree.A4w,o=FamilyTree.A4h;break;case"A3":a=FamilyTree.A3w,o=FamilyTree.A3h;break;case"A2":a=FamilyTree.A2w,o=FamilyTree.A2h;break;case"A1":a=FamilyTree.A1w,o=FamilyTree.A1h;break;case"Letter":a=FamilyTree.Letterw,o=FamilyTree.Letterh;break;case"Legal":a=FamilyTree.Legalw,o=FamilyTree.Legalh}var n=r[0],l=r[1],s=r[2],d=r[3],c={w:e.landscape?o-(e.margin[1]+e.margin[3]):a-(e.margin[1]+e.margin[3]),h:e.landscape?a-(e.margin[0]+e.margin[2]):o-(e.margin[0]+e.margin[2])},m={w:e.landscape?o:a,h:e.landscape?a:o};t.setAttribute("preserveAspectRatio","xMinYMin slice"),t.setAttribute("width",c.w),t.setAttribute("height",c.h);for(var p=c.w*(100/i),h=c.h*(100/i),u=n,f=l,y=[];u<s+n;){for(;f<d+l;){var g=[u,f,p,h];g=g.join(),y.push({vb:g,innerSize:c,size:m}),f+=h}u+=p,f=l}return y},FamilyTree.prototype._defaultExportProfileOptions=function(e,t){return(FamilyTree.isNEU(e)||FamilyTree.isNEU(e.id))&&console.error("options.id is not defilned"),"svg"==t?(e.ext="svg",e.mime="image/svg+xml"):"pdf"==t?(e.mime="application/pdf",e.ext="pdf"):"png"==t&&(e.mime="image/png",e.ext="png"),null==e.margin&&(e.margin=[50,40,50,40]),null==e.padding&&(e.padding=0),null==e.landscape&&(e.landscape=!1),null==e.filename&&(e.filename="Profile."+e.ext),null==e.scale&&(e.scale="fit"),null==e.format&&(e.format="A4"),null==e.header&&(e.header=""),null==e.footer&&(e.footer=""),null==e.openInNewTab&&(e.openInNewTab=!1),null==e.mode&&(e.mode=this.config.mode),e},FamilyTree.prototype._exportProfile=function(e,t){var i=this,r=0,a=0;switch(e.format){case"A5":r=FamilyTree.A5w,a=FamilyTree.A5h;break;case"A4":r=FamilyTree.A4w,a=FamilyTree.A4h;break;case"A3":r=FamilyTree.A3w,a=FamilyTree.A3h;break;case"A2":r=FamilyTree.A2w,a=FamilyTree.A2h;break;case"A1":r=FamilyTree.A1w,a=FamilyTree.A1h;break;case"Letter":r=FamilyTree.Letterw,a=FamilyTree.Letterh;break;case"Legal":r=FamilyTree.Legalw,a=FamilyTree.Legalh}var o={w:e.landscape?a-(e.margin[1]+e.margin[3]):r-(e.margin[1]+e.margin[3]),h:e.landscape?r-(e.margin[0]+e.margin[2]):a-(e.margin[0]+e.margin[2])},n={w:e.landscape?a:r,h:e.landscape?r:a},l=this.editUI.content(e.id,!0,!0,"100%",!0).element;FamilyTree.input.init(l);var s={content:l.outerHTML,options:e,pages:[{vb:"",innerSize:o,size:n}],styles:""};if(!t){if(!1===FamilyTree.events.publish("exportstart",[i,s]))return!1;FamilyTree.loading.show(i)}var d=this.element.querySelector("[data-ba-styles]");d&&(s.styles+=d.outerHTML),s=JSON.stringify(s),FamilyTree._ajax(this.config.exportUrl+"/v3","POST",s,"arraybuffer",(function(r){if(t)t(i,r);else{var a=FamilyTree.events.publish("exportend",[i,r]);if(FamilyTree.loading.hide(i),!1===a)return!1;FamilyTree._downloadFile(e.mime,r,e.filename,e.openInNewTab)}}))},FamilyTree.prototype.importCSV=function(){var e=this,t=document.createElement("INPUT");t.setAttribute("type","file"),t.setAttribute("accept",".csv"),t.style.display="none",t.onchange=function(t){var i=t.target,r=new FileReader;r.onload=function(){var t=r.result,i=FamilyTree._csvToArray(t,","),a=[],o=i[0];FamilyTree._importSetColumnNames(o,(function(t){for(var r=1;r<i.length;r++){for(var o={},n=0;n<i[r].length;n++){var l=t[n],s=i[r][n];if("tags"==l&&""!=s)s=s.split(",");else if("tags"==l&&""==s)continue;o[l]=s}""!=o.id.trim()&&a.push(o)}var d={nodes:a,columnNames:i[0]};0!=FamilyTree.events.publish("import",[e,d])&&(e.config.nodes=d.nodes,e.draw())}))},r.readAsText(i.files[0])},t.click()},FamilyTree._importSetColumnNames=function(e,t){if(-1==e.indexOf("id")||-1==e.indexOf("pid")){var i=document.createElement("DIV"),r=document.createElement("P");r.style.padding="5px",r.style.color="rgb(122, 122, 122)",r.innerHTML=FamilyTree.IMPORT_MESSAGE,i.appendChild(r);var a=document.createElement("div"),o=document.createElement("div"),n=document.createElement("div"),l=document.createElement("span");a.setAttribute("id","sampleDialog"),a.style.height="260px",a.style.width="400px",a.style.background="white",a.style.border="0.5px solid grey",a.style.position="fixed",a.style.overflow="hidden",a.style.zIndex="99",o.setAttribute("id","title"),o.style.backgroundColor="#e5e5e5",o.style.fontWeight="bold",o.style.color="rgb(122, 122, 122)",o.style.height="20px",o.style.padding="3px 0 0 7px",l.setAttribute("id","close"),l.style.cursor="pointer",l.style.position="absolute",l.style.color="rgb(122, 122, 122)",l.style.fontWeight="bold",l.style.top="2px",l.style.zIndex=100,n.setAttribute("id","content"),n.style.padding="2px",o.innerHTML="Import Organizational Chart Data",l.innerHTML="&times;";var s=document.createElement("HR");s.style.height="0.1px",s.style.backgroundColor="#aeaeae",s.style.border="none",s.style.margin="0",a.appendChild(o),a.appendChild(s),n.appendChild(i),a.appendChild(n),a.appendChild(l),document.body.appendChild(a),FamilyTree._importCenter(a),l.style.left=a.offsetWidth-20+"px";var d=document.createElement("div");d.setAttribute("id","overlay"),d.style.width="100%",d.style.height="100%",d.style.left=0,d.style.top=0,d.style.position="fixed",d.style.background="grey",d.style.opacity="0.5",d.style.zIndex=98,document.body.appendChild(d),a._overlay=d;var c=document.createElement("LABEL"),m=document.createTextNode("Name:");c.setAttribute("for","id-select"),c.appendChild(m),c.style.fontSize="16px",c.style.color="rgb(122, 122, 122)",c.style.padding="5px",c.style.margin="5px",c.style.width="30%",c.style.textAlign="right",c.style.display="inline-block",i.appendChild(c);var p=document.createElement("SELECT");p.id="id-select",p.style.fontSize="16px",p.style.color="rgb(122, 122, 122)",p.style.padding="5px",p.style.margin="5px",p.style.width="60%",p.style.border="1px solid #aeaeae",i.appendChild(p);var h=document.createElement("BR");i.appendChild(h);for(var u=0;u<e.length;u++){(v=document.createElement("option")).setAttribute("value",e[u]);var f=document.createTextNode(e[u]);v.appendChild(f),p.appendChild(v)}var y=document.createElement("LABEL"),g=document.createTextNode("Reports to:");y.setAttribute("for","pid-select"),y.appendChild(g),y.style.fontSize="16px",y.style.color="rgb(122, 122, 122)",y.style.padding="5px",y.style.margin="5px",y.style.width="30%",y.style.textAlign="right",y.style.display="inline-block",i.appendChild(y);var b=document.createElement("SELECT");b.id="pid-select",b.style.fontSize="16px",b.style.color="rgb(122, 122, 122)",b.style.padding="5px",b.style.margin="5px",b.style.width="60%",b.style.border="1px solid #aeaeae",i.appendChild(b);for(u=0;u<e.length;u++){var v;(v=document.createElement("option")).setAttribute("value",e[u]);f=document.createTextNode(e[u]);v.appendChild(f),b.appendChild(v)}var x=document.createElement("BUTTON");x.innerHTML="Import",x.style.fontSize="16px",x.style.color="rgb(122, 122, 122)",x.style.padding="5px 20px",x.style.margin="20px auto",x.style.display="block",x.onclick=function(){a.style.display="none",a._overlay&&a._overlay.parentNode.removeChild(a._overlay);var i=p.options[p.selectedIndex].value,r=e.indexOf(i);e[r]="id";var o=b.options[b.selectedIndex].value,n=e.indexOf(o);e[n]="pid",t(e)};var T=document.createElement("DIV");return T.appendChild(x),i.appendChild(T),l.onclick=function(e){a._overlay&&a._overlay.parentNode.removeChild(a._overlay),a.parentNode.removeChild(a),e.stopPropagation()},o.onmousedown=function(e){e=e||window.event,a._dragging=!0,a._originalLeft=a.offsetLeft,a._originalTop=a.offsetTop,a._mouseLeft=e.clientX,a._mouseTop=e.clientY},document.onmousemove=function(e){e=e||window.event,a._dragging&&(a.style.left=a._originalLeft+e.clientX-a._mouseLeft+"px",a.style.top=a._originalTop+e.clientY-a._mouseTop+"px")},document.onmouseup=function(e){e=e||window.event,a._dragging&&(a.style.left=a._originalLeft+e.clientX-a._mouseLeft+"px",a.style.top=a._originalTop+e.clientY-a._mouseTop+"px",a._dragging=!1)},a}t(e)},FamilyTree._importCenter=function(e){e&&(e.style.left=(window.innerWidth-e.offsetWidth)/2+"px",e.style.top=(window.innerHeight-e.offsetHeight)/2+"px")},FamilyTree.prototype.importXML=function(){var e=this,t=document.createElement("INPUT");t.setAttribute("type","file"),t.setAttribute("accept",".xml"),t.style.display="none",t.onchange=function(t){var i=t.target,r=new FileReader;r.onload=function(){var t=r.result,i=FamilyTree._xml2json(t);0!=FamilyTree.events.publish("import",[e,i])&&(e.config.nodes=i,e.draw())},r.readAsText(i.files[0])},t.click()},"undefined"==typeof FamilyTree&&(FamilyTree={}),FamilyTree.events=function(){var e={};return{on:function(t,i,r){Array.isArray(e[t])||(e[t]=[]),e[t].push({listener:i,event_id:r})},removeAll:function(t){Array.isArray(e[t])||(e[t]=[]),e[t]=[]},removeForEventId:function(t){for(var i in e)if(Array.isArray(e[i]))for(var r=e[i].length-1;r>=0;r--)e[i][r].event_id==t&&e[i].splice(r,1)},publish:function(t,i){if(e[t]){for(var r=[],a=0;a<e[t].length;a++){var o=e[t][a];null!=o.event_id&&o.event_id!=i[0]._event_id||r.push(o.listener)}if(r.length>0){var n=!0;for(a=0;a<r.length;a++)1==i.length?n=r[a](i[0])&&n:2==i.length?n=r[a](i[0],i[1])&&n:3==i.length?n=r[a](i[0],i[1],i[2])&&n:4==i.length?n=r[a](i[0],i[1],i[2],i[3])&&n:5==i.length&&(n=r[a](i[0],i[1],i[2],i[3],i[4])&&n);return n}}}}}(),FamilyTree.prototype._upHandlerCreateArgs=function(e){var t=this.getNode(e),i=Object.assign([],this.config.roots),r=this.getRecentRootsByNodeId(e);return Array.isArray(i)||(i=[]),FamilyTree._changeRootOption(i,r,this.manager.rootList),{id:t.id,roots:i}},String.prototype.replaceAll||(String.prototype.replaceAll=function(e,t){return this.replace(new RegExp(e,"g"),t)}),String.prototype.splice=function(e,t,i){return this.slice(0,e)+i+this.slice(e+Math.abs(t))},String.prototype.insert=function(e,t){return e>0?this.substring(0,e)+t+this.substr(e):t+this},Array.prototype.unique||(Array.prototype.unique=function(){for(var e=this.concat(),t=0;t<e.length;++t)for(var i=t+1;i<e.length;++i)e[t]===e[i]&&e.splice(i--,1);return e}),Object.defineProperty(Array.prototype,"has",{value:function(e){for(var t=0;t<this.length;t++)if(this[t]==e)return!0;return!1},writable:!0,configurable:!0,enumerable:!1}),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){"use strict";if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(e),r=1;r<arguments.length;r++){var a=arguments[r];if(null!=a)for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(i[o]=a[o])}return i},writable:!0,configurable:!0}),"function"!=typeof String.prototype.endsWith&&(String.prototype.endsWith=function(e){return-1!==this.indexOf(e,this.length-e.length)}),FamilyTree.prototype._globalMouseDownHandler=function(e,t){var i={move:"mousemove",up:"mouseup",leave:"mouseleave"};if(-1!=t.type.indexOf("touch")&&(1==t.touches.length?this._touch={x:t.touches[0].clientX,y:t.touches[0].clientY}:this._touch=null,i={move:"touchmove",up:"touchend",touchstart:"touchstart"}),e==t.target)return t.stopPropagation(),t.preventDefault(),void this._mouseDownHandler(e,t,i);if(this.config.nodeMouseClick==FamilyTree.action.pan){for(var r=t.target;r!=e&&!r.hasAttribute(FamilyTree.attr.control_expcoll_id)&&!r.hasAttribute(FamilyTree.attr.control_up_id);)r=r.parentNode;if(!r.hasAttribute(FamilyTree.attr.control_expcoll_id)&&!r.hasAttribute(FamilyTree.attr.control_up_id))return t.stopPropagation(),t.preventDefault(),void this._mouseDownHandler(e,t,i)}for(var a=t.target;a!=e;){if(a.hasAttribute(FamilyTree.attr.node_id))return void this._nodeMouseDownHandler(a,t,i);if(a.hasAttribute(FamilyTree.attr.control_node_circle_menu_name))return t.stopPropagation(),t.preventDefault(),void this._nodeCircleNodeMenuItemMouseDownHandler(a,t,i);a=a.parentNode}},FamilyTree.prototype._globalClickHandler=function(e,t){if(-1!=t.type.indexOf("touch")&&this._touch&&1==t.changedTouches.length){if(t.changedTouches.length){var i={x:t.changedTouches[0].clientX,y:t.changedTouches[0].clientY},r=FamilyTree.t(this.config.template,!1,this.getScale()).size,a=this.getScale(),o=Math.abs(i.x-this._touch.x)/a,n=Math.abs(i.y-this._touch.y)/a;if(this._touch=null,o>r[0]/10)return;if(n>r[1]/10)return}}else if(-1!=t.type.indexOf("touch")&&null==this._touch)return;for(var l=t.target;l!=e;){if(l.hasAttribute(FamilyTree.attr.control_expcoll_id)){var s=l.getAttribute(FamilyTree.attr.control_expcoll_id),d=this.getNode(s);return void this._expCollHandler(d.id)}if(l.hasAttribute(FamilyTree.attr.node_id)){s=l.getAttribute(FamilyTree.attr.node_id),d=this.getNode(s);return void this._nodeClickHandler(d.id,t)}if(l.hasAttribute(FamilyTree.attr.control_node_menu_id)){t.stopPropagation(),t.preventDefault();s=l.getAttribute(FamilyTree.attr.control_node_menu_id),d=this.getNode(s);return void this._nodeMenuClickHandler(d.id,l,t)}if(l.hasAttribute(FamilyTree.attr.control_node_circle_menu_id)){t.stopPropagation(),t.preventDefault();s=l.getAttribute(FamilyTree.attr.control_node_circle_menu_id);return void this._nodeCircleMenuClickHandler(s)}if(l.hasAttribute(FamilyTree.attr.control_node_circle_menu_name))return t.stopPropagation(),t.preventDefault(),void this._nodeCircleMenuItemClickHandler(l,t);if(l.hasAttribute(FamilyTree.attr.control_add))return void this._lonelyButtonHandler();if(l.hasAttribute(FamilyTree.attr.control_up_id)){s=l.getAttribute(FamilyTree.attr.control_up_id);return t.stopPropagation(),t.preventDefault(),void this._upHandler(s)}if(l.hasAttribute(FamilyTree.attr.c_link_from))return void FamilyTree.events.publish("clink-click",[this,{from:l.getAttribute(FamilyTree.attr.c_link_from),to:l.getAttribute(FamilyTree.attr.c_link_to),event:t}]);if(l.hasAttribute(FamilyTree.attr.s_link_from))return void FamilyTree.events.publish("slink-click",[this,{from:l.getAttribute(FamilyTree.attr.s_link_from),to:l.getAttribute(FamilyTree.attr.s_link_to),event:t}]);l=l.parentNode}},FamilyTree.prototype._globalContextHandler=function(e,t){for(var i=t.target;i!=e;){if(i.hasAttribute(FamilyTree.attr.node_id)){var r=i.getAttribute(FamilyTree.attr.node_id),a=this.getNode(r);return void this._nodeContextHandler(a.id,t)}i=i.parentNode}},FamilyTree.prototype._nodeContextHandler=function(e,t){t.preventDefault(),this.searchUI.hide(),this.nodeMenuUI.hide(),this.nodeContextMenuUI.hide(),this.menuUI.hide(),this.nodeCircleMenuUI.hide();var i=this.get(e),r=null;if(null!=i&&Array.isArray(i.tags))for(var a=0;a<i.tags.length;a++){var o=i.tags[a];this.config.tags[o]&&this.config.tags[o].nodeContextMenu&&(r=this.config.tags[o].nodeContextMenu)}this.nodeContextMenuUI.show(t.pageX,t.pageY,e,null,r)},FamilyTree.prototype._globalDbClickHandler=function(e,t){for(var i=t.target;i!=e;){if(i.hasAttribute(FamilyTree.attr.node_id)){var r=i.getAttribute(FamilyTree.attr.node_id),a=this.getNode(r);return void this._nodeDbClickHandler(a.id,t)}i=i.parentNode}},FamilyTree.prototype._mouseScrollHandler=function(e,t){if(this.config.mouseScrool!=FamilyTree.action.ctrlZoom||t.ctrlKey){var i=this,r=!1,a=this.config.zoom.speed,o=this.config.zoom.smooth,n=0,l=this.getScale(),s=FamilyTree._centerPointInPercent(i.getSvg(),t.pageX,t.pageY),d=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){setTimeout(e,20)};t.preventDefault();var c=t.delta||t.wheelDelta;void 0===c&&(c=-t.detail),c=Math.max(-1,Math.min(1,c)),n+=-c*a,r||function e(){r=!0;var t=(n-l)/o;t>0?t++:t--,l+=t,i.zoom(1-t/12/50,s),parseInt(l)==parseInt(n)?r=!1:d(e)}()}},FamilyTree.prototype._nodeCircleNodeMenuItemMouseDownHandler=function(e,t,i){var r=e.parentNode.getAttribute(FamilyTree.attr.control_node_circle_menu_wrraper_id),a=e.getAttribute(FamilyTree.attr.control_node_circle_menu_name),o=this.nodeCircleMenuUI._menu[a];if(o.draggable){var n=this,l=FamilyTree._getClientXY(t),s=this.getNode(r);e._dragEventFired=!1;var d=n.getScale(),c=null,m=null;this._gragStartedId=r,document.body.style.mozUserSelect=document.body.style.webkitUserSelect=document.body.style.userSelect="none";var p=this.getSvg(),h={x:l.x,y:l.y},u=e.cloneNode(!0);p.insertBefore(u,p.firstChild);var f=FamilyTree._getTransform(u),y=f[4],g=f[5],b=function(e){for(;e&&!e.hasAttribute(FamilyTree.attr.control_node_circle_menu_wrraper_id);)e=e.parentNode;if(e){var t=FamilyTree._getTransform(e);return{x:t[4],y:t[5]}}console.error("cannot find parent"+FamilyTree.attr.control_node_circle_menu_wrraper_id)}(e);u.setAttribute("transform","matrix(1,0,0,1,"+(y+b.x)+","+(g+b.y)+")"),u.style.opacity=.7;var v=function(e,t){if(null!=e){t.classList.remove("drag-over");for(var i=FamilyTree.getStParentNodes(n.getNode(c)),r=0;r<i.length;r++){var a=n.getNodeElement(i[r].id);a&&(a.style.opacity=1)}}},x=function(t){if(h){var i=FamilyTree._getClientXY(t),r=t.target;i.x+=b.x*d,i.y+=b.y*d;var l=FamilyTree._getOffsetXY(n.element,t),s={left:n.width()-(l.x+n.config.padding)<0,right:l.x-n.config.padding<0,down:n.height()-(l.y+n.config.padding)<0,up:l.y-n.config.padding<0};if(s.left||s.right||s.up||s.down){p.classList&&(p.classList.remove("cursor-grab"),p.classList.add("cursor-move"),p.classList.remove("cursor-nodrop"),p.classList.remove("cursor-copy"));var x=f[4],F=f[5],_=h.x,w=h.y,k=i.x,A=i.y;n.startMove(s,(function(e){f[4]=x+e.x,f[5]=F+e.y,h.x=_-e.xWithoutScale,h.y=w-e.yWithoutScale,i.x=k-e.xWithoutScale,i.y=A-e.yWithoutScale,u.setAttribute("transform","matrix("+f.toString()+")")}))}else{for(n.stopMove(),p.classList&&(p.classList.add("cursor-grab"),p.classList.remove("cursor-move"),p.classList.remove("cursor-nodrop"),p.classList.remove("cursor-copy")),v(c,m),c=null,m=null;null!=r&&r!=p;){if(r.hasAttribute&&r.hasAttribute(FamilyTree.attr.node_id)){var C=r.getAttribute(FamilyTree.attr.node_id);c=C,m=r;break}r=r.parentNode}if(null!=c){m.classList.add("drag-over");for(var S=n.getNode(c),N=FamilyTree.getStParentNodes(S),I=0;I<N.length;I++){var M=n.getNodeElement(N[I].id);M&&(M.style.opacity=.1)}p.classList.remove("cursor-grab"),p.classList.remove("cursor-move"),p.classList.add("cursor-copy"),p.classList.remove("cursor-nodrop")}var L=(i.x-h.x)/d,E=(i.y-h.y)/d;if(f[4]=y+L,f[5]=g+E,!e._dragEventFired&&(Math.abs(i.x-h.x)>FamilyTree.FIRE_DRAG_NOT_CLICK_IF_MOVE||Math.abs(i.y-h.y)>FamilyTree.FIRE_DRAG_NOT_CLICK_IF_MOVE))!1===FamilyTree.events.publish("drag",[n.nodeCircleMenuUI,{from:C,menuItem:o,menuItemName:a}])&&T(),e._dragEventFired=!0;u.setAttribute("transform","matrix("+f.toString()+")")}}},T=function(t){if(n.stopMove(),p.classList&&(p.classList.remove("cursor-grab"),p.classList.remove("cursor-move"),p.classList.remove("cursor-nodrop"),p.classList.remove("cursor-copy")),p.removeEventListener(i.move,x),p.removeEventListener(i.up,T),i.leave&&p.removeEventListener(i.leave,T),s.id==c||null==c)return p.removeChild(u),n._gragStartedId=null,void(e._dragEventFired&&FamilyTree.events.publish("drop",[n.nodeCircleMenuUI,{from:s.id,menuItemName:a,menuItem:o}]));var r=n.getNode(c);FamilyTree.events.publish("drop",[n.nodeCircleMenuUI,{from:s.id,to:r.id,menuItem:o,menuItemName:a}]),v(c,m),p.removeChild(u),n._gragStartedId=null};p.addEventListener(i.move,x),p.addEventListener(i.up,T),i.leave&&p.addEventListener(i.leave,T)}},FamilyTree.prototype._nodeMouseDownHandler=function(e,t,i){if(this.config.enableDragDrop){var r=FamilyTree._getClientXY(t),a=e.getAttribute(FamilyTree.attr.node_id),o=this.getNode(a);e._dragEventFired=!1;var n=null,l=null;this._gragStartedId=a,document.body.style.mozUserSelect=document.body.style.webkitUserSelect=document.body.style.userSelect="none";var s=this,d=this.getSvg(),c={x:r.x,y:r.y},m=FamilyTree._getTransform(e),p=m[4],h=m[5],u=s.getScale(),f=e.cloneNode(!0);d.insertBefore(f,d.firstChild),f.style.opacity=.7;var y=function(e,t){if(null!=e){t.classList.remove("drag-over");for(var i=s.getNode(n),r=FamilyTree.getStParentNodes(i),a=0;a<r.length;a++){var o=s.getNodeElement(r[a].id);o&&(o.style.opacity=1)}}},g=function(t){if(c){var i=FamilyTree._getClientXY(t),r=t.target,a=FamilyTree._getOffsetXY(s.element,t),g={left:s.width()-(a.x+s.config.padding)<0,right:a.x-s.config.padding<0,down:s.height()-(a.y+s.config.padding)<0,up:a.y-s.config.padding<0};if(g.left||g.right||g.up||g.down){d.classList&&(d.classList.remove("cursor-grab"),d.classList.add("cursor-move"),d.classList.remove("cursor-nodrop"),d.classList.remove("cursor-copy"));var v=m[4],x=m[5],T=c.x,F=c.y,_=i.x,w=i.y;s.startMove(g,(function(e){m[4]=v+e.x,m[5]=x+e.y,c.x=T-e.xWithoutScale,c.y=F-e.yWithoutScale,i.x=_-e.xWithoutScale,i.y=w-e.yWithoutScale,f.setAttribute("transform","matrix("+m.toString()+")")}))}else{if(s.stopMove(),d.classList&&(d.classList.add("cursor-grab"),d.classList.remove("cursor-move"),d.classList.remove("cursor-nodrop"),d.classList.remove("cursor-copy")),y(n,l),n=null,l=null,s.config.enableDragDrop)for(;null!=r&&r!=d;){if(r.hasAttribute&&r.hasAttribute(FamilyTree.attr.node_id)){var k=r.getAttribute(FamilyTree.attr.node_id);if(s._gragStartedId&&k!=s._gragStartedId){n=k,l=r;break}}r=r.parentNode}if(null!=n){l.classList.add("drag-over");for(var A=s.getNode(n),C=FamilyTree.getStParentNodes(A),S=0;S<C.length;S++){var N=s.getNodeElement(C[S].id);N&&(N.style.opacity=.1)}!s._canUpdateLink(o.id,n)&&d.classList?(d.classList.remove("cursor-grab"),d.classList.remove("cursor-move"),d.classList.remove("cursor-copy"),d.classList.add("cursor-nodrop")):d.classList&&(d.classList.remove("cursor-grab"),d.classList.remove("cursor-move"),d.classList.add("cursor-copy"),d.classList.remove("cursor-nodrop"))}var I=(i.x-c.x)/u,M=(i.y-c.y)/u;if(m[4]=p+I,m[5]=h+M,!e._dragEventFired&&(Math.abs(i.x-c.x)>FamilyTree.FIRE_DRAG_NOT_CLICK_IF_MOVE||Math.abs(i.y-c.y)>FamilyTree.FIRE_DRAG_NOT_CLICK_IF_MOVE))!1===FamilyTree.events.publish("drag",[s,k])&&b(),e._dragEventFired=!0;f.setAttribute("transform","matrix("+m.toString()+")")}}},b=function(t){if(s.stopMove(),d.classList&&(d.classList.remove("cursor-grab"),d.classList.remove("cursor-move"),d.classList.remove("cursor-nodrop"),d.classList.remove("cursor-copy")),d.removeEventListener(i.move,g),d.removeEventListener(i.up,b),i.leave&&d.removeEventListener(i.leave,b),o.id!=n&&null!=n){var r=s.getNode(n);if(!1===FamilyTree.events.publish("drop",[s,o.id,r.id]))return y(n,l),d.removeChild(f),void(s._gragStartedId=null);if(s._canUpdateLink(o.id,n)){var a=s.get(o.id);a.pid=n,a.stpid=null,s.updateNode(a,null,!0)}else d.removeChild(f),y(n,l);s._gragStartedId=null}else{d.removeChild(f),s._gragStartedId=null;FamilyTree._getClientXY(t);e._dragEventFired&&FamilyTree.events.publish("drop",[s,o.id])}};d.addEventListener(i.move,g),d.addEventListener(i.up,b),i.leave&&d.addEventListener(i.leave,b)}},FamilyTree.prototype._resizeHandler=function(e,t){var i=this.getViewBox(),r=this.getSvg(),a=r.getAttribute("width"),o=r.getAttribute("height"),n=a/i[2],l=o/i[3],s=n>l?l:n;r.setAttribute("width",this.width()),r.setAttribute("height",this.height()),i[2]=this.width()/s,i[3]=this.height()/s,this.setViewBox(i),this.xScrollUI.create(this.width()),this.yScrollUI.create(this.height()),this._draw(!1,FamilyTree.action.resize)},FamilyTree.prototype._nodeDbClickHandler=function(e,t){if(!1===FamilyTree.events.publish("dbclick",[this,this.get(e)]))return!1;this._commonClickHandler(e,t,this.config.nodeMouseDbClick)},FamilyTree.prototype._nodeClickHandler=function(e,t){var i=this.getNodeElement(e);if(i&&i._dragEventFired)i._dragEventFired=!1;else{if(!1===FamilyTree.events.publish("click",[this,{node:this.getNode(e),event:t}]))return!1;this._commonClickHandler(e,t,this.config.nodeMouseClick)}},FamilyTree.prototype._nodeCircleMenuItemClickHandler=function(e,t){var i=e.parentNode.getAttribute(FamilyTree.attr.control_node_circle_menu_wrraper_id),r=e.getAttribute(FamilyTree.attr.control_node_circle_menu_name),a=this.nodeCircleMenuUI._menu[r];FamilyTree.events.publish("click",[this.nodeCircleMenuUI,{nodeId:i,menuItemName:r,menuItem:a,event:t}])},FamilyTree.prototype._nodeCircleMenuClickHandler=function(e){this.searchUI.hide(),this.nodeMenuUI.hide(),this.nodeContextMenuUI.hide(),this.menuUI.hide();var t=this.getNode(e),i=null;if(Array.isArray(t.tags))for(var r=0;r<t.tags.length;r++){var a=t.tags[r];this.config.tags[a]&&this.config.tags[a].nodeCircleMenu&&(i=this.config.tags[a].nodeCircleMenu)}this.nodeCircleMenuUI.show(e,i)},FamilyTree.prototype._commonClickHandler=function(e,t,i){if(this.searchUI.hide(),this.nodeMenuUI.hide(),this.nodeContextMenuUI.hide(),this.menuUI.hide(),this.nodeCircleMenuUI.hide(),i==FamilyTree.action.expandCollapse&&this.toggleExpandCollapse(e,t),i==FamilyTree.action.edit){var r=this.getNode(e);this.editUI.show(r.id),this.ripple(r.id,t.clientX,t.clientY)}if(i==FamilyTree.action.details){r=this.getNode(e);this.editUI.show(r.id,!0),this.ripple(r.id,t.clientX,t.clientY)}},FamilyTree.prototype._menuHandlerMouseDownHandler=function(e,t){t.stopPropagation(),t.preventDefault()},FamilyTree.prototype._nodeMenuClickHandler=function(e,t,i){this.searchUI.hide(),this.nodeMenuUI.hide(),this.nodeContextMenuUI.hide(),this.menuUI.hide(),this.nodeCircleMenuUI.hide();var r=this.getNode(e),a=null;if(Array.isArray(r.tags))for(var o=0;o<r.tags.length;o++){var n=r.tags[o];this.config.tags[n]&&this.config.tags[n].nodeMenu&&(a=this.config.tags[n].nodeMenu)}this.nodeMenuUI.showStickIn(t,e,null,a)},FamilyTree.prototype._menuClickHandler=function(e,t){t.stopPropagation(),t.preventDefault(),this.nodeMenuUI.hide(),this.nodeContextMenuUI.hide(),this.menuUI.show(e.offsetLeft,e.offsetTop)},FamilyTree.prototype._lonelyButtonHandler=function(){var e={id:this.generateId()};!1!==this.addNode(e,null,!0)&&this.center(e.id)},FamilyTree.prototype.toggleExpandCollapse=function(e,t){var i=this.getNode(e),r=this.getCollapsedIds(i);if(r.length){if(!1===FamilyTree.events.publish("expcollclick",[this,!1,e,r]))return!1;this.expand(e,r,!1)}else{if(!1===FamilyTree.events.publish("expcollclick",[this,!0,e,i.childrenIds]))return!1;this.collapse(e,i.childrenIds,!1)}t&&this.ripple(i.id,t.clientX,t.clientY)},FamilyTree.prototype._move=function(e,t,i){i[0]=t,i[1]=e,this.setViewBox(i),this.xScrollUI.setPosition(),this.yScrollUI.setPosition()},FamilyTree.prototype.startMove=function(e,t){if(e){if(this._movePosition=e,!this._moveInterval){var i=this,r=this.getViewBox().slice(0),a=this.getScale(),o=0,n=0;this._moveInterval=setInterval((function(){var e={x:0,y:0,xWithoutScale:0,yWithoutScale:0};i._movePosition.left&&(o++,e.x=o*FamilyTree.MOVE_STEP/a,e.xWithoutScale=o*FamilyTree.MOVE_STEP),i._movePosition.right&&(o++,e.x=-o*FamilyTree.MOVE_STEP/a,e.xWithoutScale=-o*FamilyTree.MOVE_STEP),i._movePosition.up&&(n++,e.y=-n*FamilyTree.MOVE_STEP/a,e.yWithoutScale=-n*FamilyTree.MOVE_STEP),i._movePosition.down&&(n++,e.y=n*FamilyTree.MOVE_STEP/a,e.yWithoutScale=n*FamilyTree.MOVE_STEP),i.setViewBox([r[0]+e.x,r[1]+e.y,r[2],r[3]]),i.xScrollUI.setPosition(),i.yScrollUI.setPosition(),t&&t(e)}),FamilyTree.MOVE_INTERVAL)}}else console.error("movePosition parameter not defined")},FamilyTree.prototype.stopMove=function(){this._moveInterval&&(clearInterval(this._moveInterval),this._moveInterval=null,this._movePosition=null)},"undefined"==typeof FamilyTree&&(FamilyTree={}),FamilyTree.node=function(e,t,i,r){this.templateName=r,this.id=e,this.pid=t,this.children=[],this.childrenIds=[],this.parent=null,this.stpid=null,this.stParent=null,this.stChildren=[],this.stChildrenIds=[],this.tags=i,this.tags||(this.tags=[])},FamilyTree.prototype._mouseDownHandler=function(e,t,i){var r=this;this.editUI.hide(),this.searchUI.hide(),this.nodeMenuUI.hide(),this.nodeContextMenuUI.hide(),this.menuUI.hide(),this.nodeCircleMenuUI.hide();var a=this.getViewBox(),o=this.getScale(),n=FamilyTree._getClientTouchesXY(t,0),l=FamilyTree._getClientTouchesXY(t,1),s={diffX:0,diffY:0,x0:n.x,y0:n.y,type:"pan",viewBoxLeft:a[0],viewBoxTop:a[1]};t.touches&&t.touches.length>1&&(s.type="pinch",s.dist=Math.sqrt((n.x-l.x)*(n.x-l.x)+(n.y-l.y)*(n.y-l.y)));var d=this.getPointerElement();if("pan"==s.type){this._hideBeforeAnimation();var c=FamilyTree._getOffsetXY(this.element,t),m=c.x/o+a[0]-16/o,p=c.y/o+a[1]-16/o;d.style.display="inherit",d.setAttribute("transform","matrix(0,0,0,0,"+m+","+p+")"),FamilyTree.anim(d,{transform:[0,0,0,0,m,p],opacity:0},{transform:[1/o,0,0,1/o,m,p],opacity:1},300,FamilyTree.anim.outBack)}var h=function(e){var t=FamilyTree._getClientTouchesXY(e,0);if(s&&"pan"==s.type){r._hideBeforeAnimation(),s.diffX=t.x-s.x0,s.diffY=t.y-s.y0;var i=-s.diffY/o+s.viewBoxTop,n=-s.diffX/o+s.viewBoxLeft;r._move(i,n,a)}else if(s&&"pinch"==s.type){var l=FamilyTree._getClientTouchesXY(e,1),d=Math.sqrt((t.x-l.x)*(t.x-l.x)+(t.y-l.y)*(t.y-l.y)),c=1+(d-s.dist)/(s.dist/100)/100;s.dist=d;var m=FamilyTree._pinchMiddlePointInPercent(r.element,r.width(),r.height(),e);r.zoom(c,m)}},u=function(){"pan"==s.type&&r.config.sticky?setTimeout((function(){FamilyTree._moveToBoundaryArea(e,r.getViewBox(),r.response.boundary,(function(){r._draw(!0,FamilyTree.action.pan)}))}),0):"pan"!=s.type||r.config.sticky||r._draw(!0,FamilyTree.action.pan),s=null,d.style.display="none",e.removeEventListener(i.move,h),e.removeEventListener(i.up,u),i.leave&&e.removeEventListener(i.leave,u),i.touchstart&&e.removeEventListener(i.touchstart,u)};e.addEventListener(i.move,h),e.addEventListener(i.up,u),i.leave&&e.addEventListener(i.leave,u),i.touchstart&&e.addEventListener(i.touchstart,u)},"undefined"==typeof FamilyTree&&(FamilyTree={}),void 0===FamilyTree.remote&&(FamilyTree.remote={}),FamilyTree.LIMIT_NODES=!0,FamilyTree.remote._fromResDTO=function(e,t,i,r,a){var o=t[e.id];e.x=o.p[0],e.y=o.p[1],e.w=o.p[2],e.h=o.p[3],null!=o.ln&&(e.leftNeighbor=a[o.ln]),null!=o.rn&&(e.rightNeighbor=a[o.rn]);for(var n=0;n<e.stChildren.length;n++)FamilyTree.remote._fromResDTO(e.stChildren[n],t,i,r,a);for(n=0;n<e.children.length;n++)FamilyTree.remote._fromResDTO(e.children[n],t,i,r,a)},FamilyTree.remote._toReqDTO=function(e,t){var i={p:[e.id,null!=e.parent?e.parent.id:null,null!=e.stParent?e.stParent.id:null,e.w,e.h]};e.children.length>0&&(i.c=FamilyTree.remote._convertToIdArray(e.children)),e.stChildren.length>0&&(i.v=FamilyTree.remote._convertToIdArray(e.stChildren)),null!=e.layout&&0!=e.layout&&(i.l=e.layout),e.isAssistant&&(i.a=1),e.isSplit&&(i.s=e.isSplit),e.padding&&(i.q=e.padding),e.lcn&&(i.k=e.lcn),e.stContainerNodes&&(i.b=FamilyTree.remote._convertToIdArray(e.stContainerNodes)),e._m&&(i.m=e._m.id),e.isPartner&&(i.i=e.isPartner),e.hasPartners&&(i.g=e.hasPartners),e.partnerSeparation&&(i.e=e.partnerSeparation),t.push(i);for(var r=0;r<e.stChildren.length;r++)FamilyTree.remote._toReqDTO(e.stChildren[r],t);for(r=0;r<e.children.length;r++)FamilyTree.remote._toReqDTO(e.children[r],t)},FamilyTree.remote._toReqLayoutConfigsDTO=function(e){var t={};for(var i in e){var r=e[i];t[i]||(t[i]=[]),t[i][0]=r.orientation,t[i][1]=r.levelSeparation,t[i][2]=r.mixedHierarchyNodesSeparation,t[i][3]=r.subtreeSeparation,t[i][4]=r.siblingSeparation,t[i][5]=r.layout,t[i][6]=r.columns,t[i][7]=r.collapse,t[i][8]=r.assistantSeparation,t[i][9]=r.partnerNodeSeparation}return t},FamilyTree.remote._convertToIdArray=function(e){for(var t=[],i=0;i<e.length;i++)t.push(e[i].id);return t},FamilyTree.remote._setPositions=function(e,t,i,r){for(var a=[],o=[],n=FamilyTree.remote._toReqLayoutConfigsDTO(t),l=0;l<e.length;l++)o.push(e[l].id),FamilyTree.remote._toReqDTO(e[l],a);var s={n:a,c:n,r:o,v:"7.13.15"};if(FamilyTree.LIMIT_NODES||(s.l=!0),null!=FamilyTree.remote._fromReqDTO)FamilyTree.remote._fromReqDTO(s.n,s.r,s.c,(function(t){for(var a=0;a<e.length;a++)FamilyTree.remote._fromResDTO(e[a],t,0,e,r);i()}));else{s=JSON.stringify(s);var d=FamilyTree.localStorage.getItem(s);d?FamilyTree.remote._proceed(e,JSON.parse(d),r,i):FamilyTree.remote._findRegion((function(t){FamilyTree._ajax(t,"post",s,"json",(function(t){t.error?i(2):(FamilyTree.remote._proceed(e,t,r,i),FamilyTree.localStorage.setItem(s,JSON.stringify(t)))}))}))}},FamilyTree.remote._proceed=function(e,t,i,r){if("string"==typeof t&&(t=JSON.parse(t)),t.limit&&1==t.limit)r(t.limit);else{for(var a=0;a<e.length;a++)FamilyTree.remote._fromResDTO(e[a],t,0,e,i);r()}},FamilyTree.remote._findRegion=function(e){var t=FamilyTree.localStorage.getItem("funcUrl");if(t)e(t);else{for(var i=["au-e","au-se","brs","ca","ca-e","easia","eus-2","eus","fr","ind","jp-e","jp-w","kr","n-eu","se-asia","s-ind","uk-s","uk-w","us","us-n-c","us-s-c","w-c-us","w-eu","w-ind","w-us-2","wus"],r=[],a=0;a<i.length;a++)r.push(new XMLHttpRequest);for(a=0;a<i.length;a++)!function(){var t="https://"+i[a]+"-balkangraph.azurewebsites.net/api/OrgChartJS",o=r[a];o.onreadystatechange=function(){if(4==this.readyState&&200==this.status){FamilyTree.localStorage.setItem("funcUrl",t),e(t);for(var i=0;i<r.length;i++)r[i].abort()}},o.open("GET",t,!0),o.send()}()}},"undefined"==typeof FamilyTree&&(FamilyTree={}),FamilyTree.idb={version:1,dbName:"BALKAN",tableName:"familytree-js",keyPath:"id"},FamilyTree.idb.db=null,FamilyTree.idb._open=function(e){if(FamilyTree._browser().msie)e&&e(!1);else if((navigator.userAgent.toLowerCase().indexOf("safari")>0||navigator.userAgent.toLowerCase().indexOf("firefox")>0)&&window.location!==window.parent.location)e&&e(!1);else{if(!window.indexedDB)return console.error("Your browser doesn't support a stable version of IndexedDB."),void(e&&e(!1));if(null==FamilyTree.idb.db){var t=indexedDB.open(FamilyTree.idb.dbName,FamilyTree.idb.version);t.onerror=function(t){console.error("Cannot open database!"),e&&e(!1)},t.onsuccess=function(t){FamilyTree.idb.db=t.target.result,e&&e(!0)},t.onupgradeneeded=function(e){var t=e.target.result;t.objectStoreNames.contains(FamilyTree.idb.tableName)&&t.deleteObjectStore(FamilyTree.idb.tableName);t.createObjectStore(FamilyTree.idb.tableName,{keyPath:FamilyTree.idb.keyPath})}}else e&&e(!0)}},FamilyTree.idb.read=function(e,t){FamilyTree.idb._open((function(i){if(i){var r=FamilyTree.idb.db.transaction([FamilyTree.idb.tableName]).objectStore(FamilyTree.idb.tableName).get(e);r.onerror=function(e){console.error("Unable to retrieve data from database!"),t&&t(!1)},r.onsuccess=function(e){r.result?t&&t(!0,r.result):t&&t(null)}}else t&&t(!1)}))},FamilyTree.idb.write=function(e,t){FamilyTree.idb.read(e.id,(function(i){if(null==i){var r=FamilyTree.idb.db.transaction([FamilyTree.idb.tableName],"readwrite").objectStore(FamilyTree.idb.tableName).add(e);r.onerror=function(e){console.error("Unable to add data to database!"),t&&t(!1)},r.onsuccess=function(e){t&&t(!0)}}else t&&t(i)}))},FamilyTree.idb.put=function(e,t){FamilyTree.idb._open((function(i){if(i){var r=FamilyTree.idb.db.transaction([FamilyTree.idb.tableName],"readwrite").objectStore(FamilyTree.idb.tableName).put(e);r.onerror=function(e){console.error("Unable to put data to database!"),t&&t(!1)},r.onsuccess=function(e){t&&t(!0)}}else t&&t(!1)}))},FamilyTree.idb.delete=function(e,t){FamilyTree.idb._open((function(i){if(i){var r=FamilyTree.idb.db.transaction([FamilyTree.idb.tableName],"readwrite").objectStore(FamilyTree.idb.tableName).delete(e);r.onerror=function(e){console.error("Unable to retrieve data from database!"),t&&t(!1)},r.onsuccess=function(e){r.error?t&&t(!1):t&&t(!0)}}else t&&t(!1)}))},FamilyTree.searchUI=function(){},FamilyTree.searchUI.prototype.init=function(e){this.obj=e;var t=this,i=document.createElement("div");i.classList.add("search"),i.style.right=this.obj.config.padding-10+"px",i.style.top=this.obj.config.padding-10+"px";var r=FamilyTree.elements.textbox({},{label:FamilyTree.SEARCH_PLACEHOLDER},"320px");i.innerHTML+=r.html,this.searchTableWrapper=document.createElement("div"),i.appendChild(this.searchTableWrapper),this.obj.element.appendChild(i),FamilyTree.input.init(i),this.input=document.getElementById(r.id),this.input.addEventListener("keypress",(function(e){"Enter"==e.key&&e.preventDefault()})),this.input.addEventListener("keyup",(function(e){"ArrowDown"==e.key?(e.preventDefault(),a()):"ArrowUp"==e.key?(e.preventDefault(),e.stopPropagation(),o()):"Enter"==e.key?(e.preventDefault(),n()):"Escape"==e.key?(e.preventDefault(),t.hide()):t._serverSearch(this.value)}));var a=function(){var e=t.obj.element.querySelectorAll("[data-search-item-id]"),i=t.obj.element.querySelector('[data-selected="yes"]');null==i&&e.length>0?e[0].setAttribute("data-selected","yes"):e.length>0&&i.nextSibling&&i.nextSibling.setAttribute&&(i.removeAttribute("data-selected"),i.nextSibling.setAttribute("data-selected","yes"))},o=function(){var e=t.obj.element.querySelectorAll("[data-search-item-id]"),i=t.obj.element.querySelector('[data-selected="yes"]');null==i&&e.length>0?e[e.length-1].setAttribute("data-selected","yes"):e.length>0&&i.previousSibling&&i.previousSibling.setAttribute&&(i.removeAttribute("data-selected"),i.previousSibling.setAttribute("data-selected","yes"))},n=function(){var e=t.obj.element.querySelector('[data-selected="yes"]');if(e){var i=e.getAttribute("data-search-item-id");0!=FamilyTree.events.publish("searchclick",[t.obj,i])&&t.obj.center(i)}}},FamilyTree.searchUI.prototype.hide=function(){this.searchTableWrapper&&(this.searchTableWrapper.innerHTML=""),this.input&&(this.input.value="",this.input.focus(),this.input.blur())},FamilyTree.searchUI.prototype.find=function(e){this.input&&(this.input.value=e,this._serverSearch(e),this.input.focus())},FamilyTree.searchUI.prototype._serverSearch=function(e){var t=this,i=FamilyTree._search.search(this.obj.config.nodes,e,this.obj.config.searchFields,this.obj.config.searchFields,this.obj.config.searchDisplayField,this.obj.config.searchFieldsWeight),r=FamilyTree._getFistImgField(this.obj.config),a=`<table border="0" cellspacing="0" cellpadding="0">\n                    <tbody>\n                        ${function(){for(var e="",a=0;a<i.length&&!(a>=FamilyTree.SEARCH_RESULT_LIMIT);a++){var o=i[a],n="";if(r){var l=t.obj._get(o.id);"function"==typeof r?n=r(t.obj,t.obj.getNode(o.id),l):l[r]&&(n=l[r])}var s="",d="";t.obj.config.searchDisplayField==o.__searchField?s=o.__searchMarks:t.obj.config.searchDisplayField?(s=o[t.obj.config.searchDisplayField],FamilyTree.isNullOrEmpty(s)&&(s=""),d=o.__searchMarks):s=o.__searchMarks,e+=FamilyTree.searchUI.createItem(n,o.id,s,d)}return e}()}  \n                    </tbody>\n                </table>`;this.searchTableWrapper.innerHTML=a;for(var o=this.obj.element.querySelectorAll("[data-search-item-id]"),n=0;n<o.length;n++)o[n].addEventListener("click",(function(){if(!1!==FamilyTree.events.publish("searchclick",[t.obj,this.getAttribute("data-search-item-id")])){t.obj.center(this.getAttribute("data-search-item-id"));var e=t.obj.element.querySelector('[data-selected="yes"]');e&&e.removeAttribute("data-selected"),this.setAttribute("data-selected","yes"),t.input.focus()}}))},FamilyTree.searchUI.createItem=function(e,t,i,r){return i&&(i="<b>"+i+"</b>"),`<tr data-search-item-id="${t}">\n                <td class="search-image-td">\n                    ${e=e?`<div class="search-photo" style="background-image: url(${e})"></div>`:`<div class="search-photo">${FamilyTree.icon.user(32,32,"#aeaeae")}</div>`}\n                </td>\n                <td class="search-text-td">${i} <br/>${r}</td>\n            </tr>`},"undefined"==typeof FamilyTree&&(FamilyTree={}),FamilyTree.manager=function(e,t){this.config=e,this.layoutConfigs=t,this.visibleNodeIds=[],this.viewBox=null,this.action=null,this.actionParams=null,this.nodes={},this.oldNodes={},this.maxX=null,this.maxY=null,this.minX=null,this.minY=null,this.bordersByRootIdAndLevel=null,this.roots=null,this.state=null,this.vbIsInitializedFromState=!1,this.rootList=[]},FamilyTree.manager.prototype.read=function(e,t,i,r,a,o,n,l){var s=this;FamilyTree.state._get(this.config.state,t,i,(function(d){s.state=d,s.action=a,s.actionParams=o,a!=FamilyTree.action.init||!s.state||o&&o.method&&"fit"==o.method?(s.viewBox=r,s.vbIsInitializedFromState=!1):(s.viewBox=s.state.vb,s.vbIsInitializedFromState=!0);var c=s.maxX,m=s.maxY,p=s.minX,h=s.minY,u=s.bordersByRootIdAndLevel,f=s.roots,y=s.nodes;if(e){var g=FamilyTree.manager._getResponse(t,i,s.visibleNodeIds,s.config,c,m,p,h,s.viewBox,f,s.action,s.actionParams,y,s.oldNodes,s.vbIsInitializedFromState);a!=FamilyTree.action.exporting&&(s.maxX=c,s.maxY=m,s.minX=p,s.minY=h,s.roots=f,s.nodes=y,s.visibleNodeIds=g.visibleNodeIds),g.bordersByRootIdAndLevel=u,g.roots=f,g.adjustify={x:0,y:0},s.state&&(g.adjustify=s.state.adjustify),n(g)}else s.oldNodes=y||null,s._read((function(e){c=e.maxX,m=e.maxY,p=e.minX,h=e.minY,u=e.bordersByRootIdAndLevel,f=e.roots,y=e.nodes;var r=FamilyTree.manager._getResponse(t,i,s.visibleNodeIds,s.config,c,m,p,h,s.viewBox,f,s.action,s.actionParams,y,s.oldNodes,s.vbIsInitializedFromState);r.notif=e.limit,r.roots=f,r.bordersByRootIdAndLevel=u,r.adjustify=e.adjustify,a!=FamilyTree.action.exporting&&(s.maxX=c,s.maxY=m,s.minX=p,s.minY=h,s.roots=f,s.nodes=y,s.visibleNodeIds=r.visibleNodeIds,s.bordersByRootIdAndLevel=u,s.rootList=e.rootList),n(r)}),l)}))},FamilyTree.manager.prototype._read=function(e,t){var i=this,r=FamilyTree.manager._createNodes(i.config,i.layoutConfigs,i.action,i.actionParams,i.oldNodes,i.state);t(r);var a=r.nodes,o=r.roots,n=FamilyTree.remote;null==n&&(n=FamilyTree.local),n._setPositions(o,i.layoutConfigs,(function(t){var n=FamilyTree.manager._doNotChangePositionOfClickedNodeIfAny(o,a,i.action,i.actionParams,i.oldNodes,i.config.orientation);i.state&&i.action==FamilyTree.action.init&&(n=i.state.adjustify);for(var l={minX:null,minY:null,maxX:null,maxY:null},s={},d=0;d<o.length;d++)FamilyTree.manager._setMinMaxXYAdjustifyIterate(o[d],o[d],l,0,s,n,i.config.orientation);e({minX:l.minX,minY:l.minY,maxX:l.maxX,maxY:l.maxY,bordersByRootIdAndLevel:s,nodes:a,roots:o,rootList:r.rootList,limit:t,adjustify:n})}),a)},FamilyTree.manager.__createNodes=function(e,t,i,r,a,o,n){for(var l=i.nodes,s=[],d=[],c={},m={},p=0;p<l.length;p++){var h,u=l[p];h=FamilyTree.STRING_TAGS?u.tags?u.tags.split(","):[]:Array.isArray(u.tags)?u.tags.slice(0):[],u.gender&&h.push(u.gender);var f=FamilyTree._getTemplate(h,i.tags,i.template);u.templateName&&(f=u.templateName);var y=new FamilyTree.node(u.id,u.pid,h,f);y.ftChildrenIds=[],y.rids=[],FamilyTree.isNEU(u.ppid)||(y.ppid=u.ppid),FamilyTree.isNEU(u.stpid)||(y.stpid=u.stpid),FamilyTree.isNEU(u.mid)||(y.mid=u.mid),FamilyTree.isNEU(u.fid)||(y.fid=u.fid),FamilyTree.isNEU(u.gender)||(y.gender=u.gender),Array.isArray(u.pids)?y.pids=u.pids:y.pids=[],null!=i.orderBy&&(y.order=FamilyTree.manager._getOrderFieldValue(u,i.orderBy)),e[u.id]=y,s.push(u.id),FamilyTree.isNEU(y.stpid)?(FamilyTree.isNEU(y.mid)||(c[y.mid]||(c[y.mid]=[]),c[y.mid].push(y.id)),FamilyTree.isNEU(y.fid)||(c[y.fid]||(c[y.fid]=[]),c[y.fid].push(y.id)),FamilyTree.isNEU(y.mid)&&FamilyTree.isNEU(y.fid)&&FamilyTree.isNEU(y.stpid)&&(d.has(y.id)||d.push(y.id))):(m[y.stpid]||(m[y.stpid]=[]),m[y.stpid].push(y.id))}null!=i.orderBy&&s.sort((function(t,r){var a=e[t].order,o=e[r].order;return"number"==typeof a||"number"==typeof o?(null==a&&(a=-1),null==o&&(o=-1),i.orderBy.desc?o-a:a-o):"string"==typeof a||"string"==typeof o?(null==a&&(a=""),null==o&&(o=""),i.orderBy.desc?o.localeCompare(a):a.localeCompare(o)):void 0}));for(p=0;p<d.length;p++){var g=e[d[p]];if(g){var b=[];FamilyTree.manager._iterateSetRootIds(g.id,g.id,m,c,e,b),n.push(b)}}for(p=0;p<n.length;p++)for(var v=0;v<n.length;v++)if(v!=p){for(var x=n[p],T=n[v],F=!1,_=0;_<x.length;_++)if(T.has(x[_])){F=!0;break}F&&(n[p]=x.concat(T).unique(),n[v]=[])}for(p=n.length-1;p>=0;p--)n[p].length||n.splice(p,1);if(!i.roots||!i.roots.length){i.roots=[];for(p=n.length-1;p>=0;p--)i.roots.push(n[p][0])}for(p=0;p<i.roots.length;p++)FamilyTree.manager._iterateFT(i.roots[p],m,c,e,o,t,r,a,i)},FamilyTree.manager._iterateSetRootIds=function(e,t,i,r,a,o){var n=a[e];if(n){n.rids.has(t)||n.rids.push(t);for(var l=0;l<n.rids.length;l++)o.has(n.rids[l])||o.push(n.rids[l]);for(l=0;l<n.pids.length;l++){var s=a[n.pids[l]];if(s)for(var d=0;d<s.rids.length;d++)o.has(s.rids[d])||o.push(s.rids[d])}if(i[n.id])for(l=0;l<i[n.id].length;l++)FamilyTree.manager._iterateSetRootIds(i[n.id][l],t,i,r,a,o);if(r[n.id])for(l=0;l<r[n.id].length;l++)FamilyTree.manager._iterateSetRootIds(r[n.id][l],t,i,r,a,o)}},FamilyTree.manager._iterateFT=function(e,t,i,r,a,o,n,l,s){var d,c=r[e],m=a?a[e]:null,p=r[c.stpid],h=r[c.mid],u=r[c.fid];if(p||(c.stpid=null),h?u&&(h.tags.has("partner")||h.tags.has("left-partner")||h.tags.has("right-partner"))?(c.pid=u.id,d=u,c.ppid=h.id):(c.pid=h.id,d=h,u&&(c.ppid=u.id)):u?h&&(u.tags.has("partner")||u.tags.has("left-partner")||u.tags.has("right-partner"))?(c.pid=h.id,d=h,c.ppid=u.id):(c.pid=u.id,d=u,h&&(c.ppid=h.id)):c.pid,p){var f=a?a[p.id]:null;f&&(p.min=f.min),p.stChildrenIds.push(c.id)}else h||u?(m&&(c.collapsed=m.collapsed,c.min=m.min),d&&!d.childrenIds.has(c.id)&&d.childrenIds.push(c.id),h&&!h.ftChildrenIds.has(c.id)&&h.ftChildrenIds.push(c.id),u&&!u.ftChildrenIds.has(c.id)&&u.ftChildrenIds.push(c.id)):(m&&(c.collapsed=m.collapsed,c.min=m.min),o.push(c));n==FamilyTree.action.init&&(c.min=FamilyTree._getMin(c,s));for(var y=0;y<c.pids.length;y++){var g=r[c.pids[y]];if(g){g.pid=c.id;var b=a?a[g.id]:null;b&&(g.collapsed=b.collapsed,g.min=b.min),n==FamilyTree.action.init&&(g.min=FamilyTree._getMin(g,s)),l&&m&&b&&l.id==c.id?b.hasPartners&&1==m.isPartner?g.tags.push("left-partner"):b.hasPartners&&2==m.isPartner||1==m.isPartner?g.tags.push("right-partner"):2==m.isPartner?g.tags.push("left-partner"):g.tags.push("partner"):b&&2==b.isPartner?g.tags.push("left-partner"):b&&1==b.isPartner?g.tags.push("right-partner"):g.tags.push("partner"),c.childrenIds.push(g.id),g.ftChildrenIds=c.ftChildrenIds}}if(t[e])for(var v=0;v<t[e].length;v++)FamilyTree.manager._iterateFT(t[e][v],t,i,r,a,o,n,l,s);if(i[e])for(v=0;v<i[e].length;v++)FamilyTree.manager._iterateFT(i[e][v],t,i,r,a,o,n,l,s)},FamilyTree.manager.getAllFields=function(e){var t=[FamilyTree.TAGS];for(var i in e.nodeBinding)t.push(e.nodeBinding[i]);for(i=0;i<e.nodes.length;i++)for(var r in e.nodes[i])r!==FamilyTree.ID&&r!==FamilyTree.TAGS&&r!==FamilyTree.NODES&&r!==FamilyTree.PID&&r!==FamilyTree.STPID&&"mid"!==r&&"fid"!==r&&"pids"!==r&&(e.nodeBinding[r]||t.has(r)||t.push(r));return t},FamilyTree.ui._base_nodeBtns=FamilyTree.ui.nodeBtns,FamilyTree.ui.nodeBtns=function(e,t,i,r,a){var o="";if(a._tree_menu_temp)!t.isSplit&&i!==FamilyTree.action.exporting&&r.nodeTreeMenuCloseButton&&a._tree_menu_temp.id==t.id&&(o+=r.nodeTreeMenuCloseButton);else{o=FamilyTree.ui._base_nodeBtns(e,t,i,r,a);null!=e.nodeTreeMenu&&!t.isSplit&&i!==FamilyTree.action.exporting&&r.nodeTreeMenuButton&&(o+=r.nodeTreeMenuButton.replace("{id}",t.id))}return o},FamilyTree.ui._base_expandCollapseBtn=FamilyTree.ui.expandCollapseBtn,FamilyTree.ui.expandCollapseBtn=function(e,t,i,r,a){return e._tree_menu_temp?"":FamilyTree.ui._base_expandCollapseBtn(e,t,i,r,a)},FamilyTree.ui.svg=function(e,t,i,r,a,o){return FamilyTree.t(r.template,!1,o).svg.replace("{w}",e).replace("{h}",t).replace("{viewBox}",i).replace("{mode}",r.mode).replace("{template}",r.template).replace("{content}",(function(){return a}))},FamilyTree._changeRootOption=function(e,t,i){for(var r=[],a=0;a<t.length;a++)for(var o=0;o<i.length;o++)if(i[o].has(t[a])){r=i[o];break}for(a=0;a<r.length;a++){var n=e.indexOf(r[a]);-1!=n&&e.splice(n,1)}t.length&&e.push(t[0])},FamilyTree.xScrollUI=function(e,t,i,r,a){this.element=e,this.requestParams=i,this.config=t,this.onSetViewBoxCallback=r,this.onDrawCallback=a,this.pos=0},FamilyTree.xScrollUI.prototype.addListener=function(e){var t=this;if((this.config.mouseScrool==FamilyTree.action.xScroll||this.config.mouseScrool==FamilyTree.action.scroll)&&this.bar){var i=FamilyTree._getScrollSensitivity();!function(e,i,r){var a=!1;function o(){a=!0;var e=(t.pos-t.bar.scrollLeft)/r;if(e>0)e++;else{if(0==e)return void(a=!1);e--}Math.ceil(t.bar.scrollLeft)==Math.ceil(t.pos)?a=!1:(t.bar.scrollLeft+=e,n(o))}e.addEventListener("wheel",(function(e){var r=0;if(t.config.mouseScrool==FamilyTree.action.xScroll)(r=e.deltaX||e.wheelDeltaX)||(r=e.deltaY||e.wheelDeltaY);else if(t.config.mouseScrool==FamilyTree.action.scroll&&!(r=e.shiftKey?e.deltaY||e.wheelDeltaY:e.deltaX||e.wheelDeltaX))return;r=-r,r=Math.max(-1,Math.min(1,r)),t.pos+=-r*i;var n=parseFloat(t.innerBar.clientWidth)-parseFloat(t.bar.clientWidth);t.pos<0&&(t.pos=0);t.pos>n&&(t.pos=n);a||o()}),{passive:!0});var n=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){setTimeout(e,20)}}(e,i.speed,i.smooth)}},FamilyTree.xScrollUI.prototype.create=function(e){if(this.config.showXScroll===FamilyTree.scroll.visible||this.config.mouseScrool===FamilyTree.action.scroll||this.config.mouseScrool===FamilyTree.action.xScroll){var t=this;this.bar&&this.bar.parentNode.removeChild(this.bar),this.bar=document.createElement("div"),this.config.showXScroll!==FamilyTree.scroll.visible&&(this.bar.style.visibility="hidden"),this.innerBar=document.createElement("div");this.requestParams();this.innerBar.innerHTML="&nbsp",Object.assign(this.bar.style,{position:"absolute",left:0,bottom:0,width:e+"px","overflow-x":"scroll",height:"20px"}),this.element.appendChild(this.bar),this.bar.appendChild(this.innerBar),this.bar.addEventListener("scroll",(function(){if(this.ignore)this.ignore=!1;else{var e=t.requestParams(),i=(parseFloat(t.innerBar.clientWidth)-parseFloat(t.bar.clientWidth))/100,r=this.scrollLeft/i,a=(e.boundary.right-e.boundary.left)/100;e.viewBox[0]=r*a+e.boundary.left,t.onSetViewBoxCallback(e.viewBox),clearTimeout(this._timeout),this._timeout=setTimeout((function(){t.onDrawCallback()}),500)}}))}},FamilyTree.xScrollUI.prototype.setPosition=function(){if(this.bar){var e=this.requestParams(),t=Math.abs(e.boundary.maxX-e.boundary.minX)*e.scale;switch(this.config.orientation){case FamilyTree.orientation.bottom:case FamilyTree.orientation.bottom_left:innerHeight=Math.abs(e.boundary.minY*e.scale);break;case FamilyTree.orientation.right:case FamilyTree.orientation.right_top:t=Math.abs(e.boundary.minX*e.scale)}this.innerBar.style.width=t+"px";var i=(e.boundary.right-e.boundary.left)/100,r=(e.viewBox[0]-e.boundary.left)/i;r<0?r=0:r>100&&(r=100);var a=(parseFloat(this.innerBar.clientWidth)-parseFloat(this.bar.clientWidth))/100,o=r*a;this.bar.ignore=!0,this.bar.scrollLeft=o,this.pos=this.bar.scrollLeft,this.bar.style.visibility=a<=0?"hidden":""}},FamilyTree.yScrollUI=function(e,t,i,r,a){this.element=e,this.requestParams=i,this.config=t,this.onSetViewBoxCallback=r,this.onDrawCallback=a,this.pos=0},FamilyTree.yScrollUI.prototype.addListener=function(e){var t=this;if(this.config.mouseScrool==FamilyTree.action.yScroll||this.config.mouseScrool==FamilyTree.action.scroll){var i=FamilyTree._getScrollSensitivity();!function(e,i,r){var a=!1;function o(){a=!0;var e=(t.pos-t.bar.scrollTop)/r;if(e>0)e++;else{if(0==e)return void(a=!1);e--}Math.ceil(t.bar.scrollTop)==Math.ceil(t.pos)?a=!1:(t.bar.scrollTop+=e,n(o))}e.addEventListener("wheel",(function(e){var r=0;if(t.config.mouseScrool==FamilyTree.action.yScroll)(r=e.deltaY||e.wheelDeltaY)||(r=e.deltaX||e.wheelDeltaX);else if(t.config.mouseScrool==FamilyTree.action.scroll&&!(r=e.shiftKey?e.deltaX||e.wheelDeltaX:e.deltaY||e.wheelDeltaY))return;r=-r,r=Math.max(-1,Math.min(1,r)),t.pos+=-r*i;var n=parseFloat(t.innerBar.clientHeight)-parseFloat(t.bar.clientHeight);t.pos<0&&(t.pos=0);t.pos>n&&(t.pos=n);a||o()}),{passive:!0});var n=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){setTimeout(e,20)}}(e,i.speed,i.smooth)}},FamilyTree.yScrollUI.prototype.create=function(e){if(this.config.showYScroll===FamilyTree.scroll.visible||this.config.mouseScrool===FamilyTree.action.scroll||this.config.mouseScrool===FamilyTree.action.yScroll){var t=this;this.bar&&this.bar.parentNode.removeChild(this.bar),this.bar=document.createElement("div"),this.config.showYScroll!==FamilyTree.scroll.visible&&(this.bar.style.visibility="hidden"),this.innerBar=document.createElement("div"),this.innerBar.innerHTML="&nbsp",Object.assign(this.bar.style,{position:"absolute",right:0,bottom:0,height:e+"px","overflow-y":"scroll",width:"20px"}),this.element.appendChild(this.bar),this.bar.appendChild(this.innerBar),this.bar.addEventListener("scroll",(function(){if(this.ignore)this.ignore=!1;else{var e=t.requestParams(),i=(parseFloat(t.innerBar.clientHeight)-parseFloat(t.bar.clientHeight))/100,r=this.scrollTop/i,a=(e.boundary.bottom-e.boundary.top)/100;e.viewBox[1]=r*a+e.boundary.top,t.onSetViewBoxCallback(e.viewBox),clearTimeout(this._timeout),this._timeout=setTimeout((function(){t.onDrawCallback()}),500)}}))}},FamilyTree.yScrollUI.prototype.setPosition=function(){if(this.bar){var e=this.requestParams(),t=e.boundary.maxY*e.scale;switch(this.config.orientation){case FamilyTree.orientation.bottom:case FamilyTree.orientation.bottom_left:t=Math.abs(e.boundary.minY*e.scale);break;case FamilyTree.orientation.right:case FamilyTree.orientation.right_top:innerWidth=Math.abs(e.boundary.minX*e.scale)}this.innerBar.style.height=t+"px";var i=(e.boundary.bottom-e.boundary.top)/100,r=(e.viewBox[1]-e.boundary.top)/Math.abs(i);r<0?r=0:r>100&&(r=100);var a=(parseFloat(this.innerBar.clientHeight)-parseFloat(this.bar.clientHeight))/100,o=r*a;this.bar.ignore=!0,this.bar.scrollTop=o,this.pos=this.bar.scrollTop,this.bar.style.visibility=a<=0?"hidden":""}},FamilyTree.prototype.zoom=function(e,t,i,r){var a=this.getViewBox().slice(0),o=a,n=a[2],l=a[3];!0===e?(a[2]=a[2]/FamilyTree.SCALE_FACTOR,a[3]=a[3]/FamilyTree.SCALE_FACTOR):!1===e?(a[2]=a[2]*FamilyTree.SCALE_FACTOR,a[3]=a[3]*FamilyTree.SCALE_FACTOR):(a[2]=a[2]/e,a[3]=a[3]/e),t||(t=[50,50]),a[0]=o[0]-(a[2]-n)/(100/t[0]),a[1]=o[1]-(a[3]-l)/(100/t[1]);var s=this.getScale(a);if(a[2]=this.width()/s,a[3]=this.height()/s,!0===e&&s<this.config.scaleMax||!1===e&&s>this.config.scaleMin||0!=e&&1!=e&&s<this.config.scaleMax&&s>this.config.scaleMin){this._hideBeforeAnimation();var d=this;i?(clearTimeout(d._timeout),FamilyTree.anim(this.getSvg(),{viewbox:this.getViewBox()},{viewbox:a},this.config.anim.duration,this.config.anim.func,(function(){clearTimeout(d._timeout),d._timeout=setTimeout((function(){d._draw(!0,FamilyTree.action.zoom,null,r)}),500)}))):(this.setViewBox(a),clearTimeout(d._timeout),d._timeout=setTimeout((function(){d._draw(!0,FamilyTree.action.zoom,null,r)}),500))}},FamilyTree.pdfPrevUI={},FamilyTree.loc||(FamilyTree.loc={}),FamilyTree.loc.ppdfCmdTitle="PDF Preview",FamilyTree.loc.ppdfSave="Save",FamilyTree.loc.ppdfCancel="Cancel",FamilyTree.loc.ppdfFormat="Format",FamilyTree.loc.ppdfFitToDrwaing="Fit",FamilyTree.loc.ppdfA4="A4",FamilyTree.loc.ppdfA3="A3",FamilyTree.loc.ppdfA2="A2",FamilyTree.loc.ppdfA1="A1",FamilyTree.loc.ppdfLetter="Letter",FamilyTree.loc.ppdfLegal="Legal",FamilyTree.loc.ppdfLayout="Layout",FamilyTree.loc.ppdfPortrait="Portrait",FamilyTree.loc.ppdfLandscape="Landscape",FamilyTree.loc.ppdfFittopagewidth="Fit to page width",FamilyTree.loc.ppdfMargin="Margin",FamilyTree.loc.ppdfHeader="Header",FamilyTree.loc.ppdfFooter="Footer",FamilyTree.loc.ppdfScale="Scale",FamilyTree.pdfPrevUI.show=function(e,t){t=e._defaultExportOptions(t,"pdf");var i=document.createElement("div");i.classList.add(e.config.mode),i.id="bg-ppdf-btns",Object.assign(i.style,{position:"absolute",top:0,left:0,"background-color":"#fff","z-index":5,margin:"0 0 0 -265px","box-shadow":"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)",width:"265px",height:"100%","font-family":"Roboto,Helvetica",color:"#757575","text-align":"right",padding:"10px"}),e.element.appendChild(i),i.innerHTML="<h1>"+FamilyTree.loc.ppdfCmdTitle+'</h1><div><button type="button" id="bg-prev-save" style="font-size: 14px; width: 90px;">'+FamilyTree.loc.ppdfSave+'</button>&nbsp;<button type="button" id="bg-prev-cancel" style="width: 90px;font-size: 14px;">'+FamilyTree.loc.ppdfCancel+'</button></div><div style="margin-top:30px; height:10px;border-bottom:1px solid #eeeeee;"></div><div style="padding-top:30px;"><label for="bg-size">'+FamilyTree.loc.ppdfFormat+': </label><select id="bg-ppdf-size" style="color: #757575; width: 150px; font-size: 14px;" id="bg-size"><option value="fit">'+FamilyTree.loc.ppdfFitToDrwaing+'</option><option value="A4">'+FamilyTree.loc.ppdfA4+'</option><option value="A3">'+FamilyTree.loc.ppdfA3+'</option><option value="A2">'+FamilyTree.loc.ppdfA2+'</option><option value="A1">'+FamilyTree.loc.ppdfA1+'</option><option value="Letter">'+FamilyTree.loc.ppdfLetter+'</option><option value="Legal">'+FamilyTree.loc.ppdfLegal+'</option></select></div><div style="padding-top:10px;"><label for="bg-ppdf-layout">'+FamilyTree.loc.ppdfLayout+': </label><select id="bg-ppdf-layout" style="color: #757575; width: 150px;font-size: 14px;" ><option value="false">'+FamilyTree.loc.ppdfPortrait+'</option><option value="true">'+FamilyTree.loc.ppdfLandscape+'</option></select></div><div style="padding-top:10px;"><label for="bg-scale">'+FamilyTree.loc.ppdfScale+': </label><select id="bg-ppdf-scale" style="color: #757575; width: 150px;font-size: 14px;" id="bg-scale"><option value="fit">'+FamilyTree.loc.ppdfFittopagewidth+'</option><option value="10">10%</option><option value="20">20%</option><option value="30">30%</option><option value="40">40%</option><option value="50">50%</option><option value="60">60%</option><option value="70">70%</option><option value="80">80%</option><option value="90">90%</option><option value="100">100%</option><option value="110">110%</option><option value="120">120%</option><option value="130">130%</option><option value="140">140%</option><option value="150">150%</option><option value="160">160%</option><option value="170">170%</option><option value="180">180%</option><option value="190">190%</option><option value="200">200%</option></select></div><div style="margin-top:10px;margin-bottom:10px; height:10px;border-bottom:1px solid #eeeeee;"></div><div style="padding-top:10px;"><label for="bg-ppdf-header">'+FamilyTree.loc.ppdfHeader+': </label><input id="bg-ppdf-header" type="text" style="color: #757575; width: 100px;font-size: 14px;" ></div><div style="padding-top:10px;"><label for="bg-ppdf-footer">'+FamilyTree.loc.ppdfFooter+': </label><input id="bg-ppdf-footer" type="text" style="color: #757575; width: 100px;font-size: 14px;" ></div><div style="padding-top:10px;"><label for="bg-ppdf-margin">'+FamilyTree.loc.ppdfMargin+': </label><input id="bg-ppdf-margin" type="text" style="color: #757575; width: 100px;font-size: 14px;" ></div>';var r=document.createElement("div");r.id="bg-ppdf-wrapper",Object.assign(r.style,{"overflow-y":"scroll","z-index":11,position:"absolute",top:0,left:"285px","background-color":"#eee",width:e.width()-270+"px",height:"100%"}),e.element.appendChild(r),r.innerHTML='<div id="bg-ppdf-content" style="width: 100%;margin-top:10px;margin-bottom:10px;opacity:0;"></div>';var a,o,n,l=e.element.querySelector("#bg-ppdf-size"),s=e.element.querySelector("#bg-ppdf-layout"),d=e.element.querySelector("#bg-ppdf-scale"),c=e.element.querySelector("#bg-ppdf-margin"),m=e.element.querySelector("#bg-ppdf-header"),p=e.element.querySelector("#bg-ppdf-footer");l.value=t.format,s.value=t.landscape,d.value=t.scale,c.value=t.margin,m.value=t.header,p.value=t.footer,FamilyTree.anim(e.element.querySelector("#bg-ppdf-btns"),{margin:[0,0,0,-250]},{margin:[0,0,0,0]},300,FamilyTree.anim.outSin,(function(){e.exportPDF(t,FamilyTree.pdfPrevUI._handler)})),e.element.querySelector("#bg-prev-cancel").addEventListener("click",(function(){FamilyTree.pdfPrevUI.hide(e)})),e.element.querySelector("#bg-prev-save").addEventListener("click",(function(){e.exportPDF(t),FamilyTree.pdfPrevUI.hide(e)})),FamilyTree.pdfPrevUI._showHide(l,s,d),l.addEventListener("change",(function(){FamilyTree.anim(e.element.querySelector("#bg-ppdf-content"),{opacity:1},{opacity:0},300,FamilyTree.anim.inSin,(function(){e.element.querySelector("#bg-ppdf-content").innerHTML="",t.format=l.value,e.exportPDF(t,FamilyTree.pdfPrevUI._handler),FamilyTree.pdfPrevUI._showHide(l,s,d)}))})),s.addEventListener("change",(function(){FamilyTree.anim(e.element.querySelector("#bg-ppdf-content"),{opacity:1},{opacity:0},300,FamilyTree.anim.inSin,(function(){e.element.querySelector("#bg-ppdf-content").innerHTML="",t.landscape="true"==s.value,e.exportPDF(t,FamilyTree.pdfPrevUI._handler),FamilyTree.pdfPrevUI._showHide(l,s,d)}))})),d.addEventListener("change",(function(){FamilyTree.anim(e.element.querySelector("#bg-ppdf-content"),{opacity:1},{opacity:0},300,FamilyTree.anim.inSin,(function(){e.element.querySelector("#bg-ppdf-content").innerHTML="",t.scale=d.value,e.exportPDF(t,FamilyTree.pdfPrevUI._handler),FamilyTree.pdfPrevUI._showHide(l,s,d)}))})),c.addEventListener("keyup",(function(){clearTimeout(a),a=setTimeout((function(){FamilyTree.anim(e.element.querySelector("#bg-ppdf-content"),{opacity:1},{opacity:0},300,FamilyTree.anim.inSin,(function(){e.element.querySelector("#bg-ppdf-content").innerHTML="";var i=c.value.split(",");if(4==i.length){for(var r=0;r<i.length;r++)i[r]=parseInt(i[r]);t.margin=i,e.exportPDF(t,FamilyTree.pdfPrevUI._handler)}}))}),1e3)})),m.addEventListener("keyup",(function(){clearTimeout(o),o=setTimeout((function(){FamilyTree.anim(e.element.querySelector("#bg-ppdf-content"),{opacity:1},{opacity:0},300,FamilyTree.anim.inSin,(function(){e.element.querySelector("#bg-ppdf-content").innerHTML="",t.header=m.value,e.exportPDF(t,FamilyTree.pdfPrevUI._handler)}))}),1e3)})),p.addEventListener("keyup",(function(){clearTimeout(n),n=setTimeout((function(){FamilyTree.anim(e.element.querySelector("#bg-ppdf-content"),{opacity:1},{opacity:0},300,FamilyTree.anim.inSin,(function(){e.element.querySelector("#bg-ppdf-content").innerHTML="",t.footer=p.value,e.exportPDF(t,FamilyTree.pdfPrevUI._handler)}))}),1e3)}))},FamilyTree.pdfPrevUI._showHide=function(e,t,i){"A4"==e.value||"A3"==e.value||"A2"==e.value||"A1"==e.value||"Letter"==e.value||"Legal"==e.value?(t.parentNode.style.display="block",i.parentNode.style.display="block"):(t.parentNode.style.display="none",i.parentNode.style.display="none")},FamilyTree.pdfPrevUI._handler=function(e,t,i){var r=t.options,a=t.pages,o=r.margin[0],n=r.margin[2],l=document.createElement("div");l.classList.add(e.config.mode),l.innerHTML=i.outerHTML,FamilyTree._browser().msie&&(l.innerHTML=(new XMLSerializer).serializeToString(i));for(var s=l.querySelector("svg"),d=e.element.querySelector("#bg-ppdf-content"),c=0;c<a.length;c++){var m=document.createElement("iframe");Object.assign(m.style,{display:"block",margin:"10px auto",border:"1px solid #eeeeee","box-shadow":"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)"}),d.appendChild(m),s&&s.style.backgroundColor?m.style.backgroundColor=s.style.backgroundColor:m.style.backgroundColor="#fff";var p=m.contentWindow.document;p.open(),m.style.width=a[c].size.w+"px",m.style.height=a[c].size.h+"px",m.style.margin="10 auto",a[c].backgroundColor&&(m.style.backgroundColor=a[c].backgroundColor);var h=r.header;a[c].header&&(h=a[c].header),h&&(h=h.replace("{current-page}",c+1).replace("{total-pages}",a.length));var u=r.footer;a[c].footer&&(u=a[c].footer),u&&(u=u.replace("{current-page}",c+1).replace("{total-pages}",a.length)),a[c].html?p.write(FamilyTree._exportHtml(a[c].html,t.styles,r,a[c].innerSize.w,a[c].innerSize.h,h,u,e.config.mode)):(s.setAttribute("viewBox",a[c].vb),p.write(FamilyTree._exportHtml(l.innerHTML,t.styles,r,a[c].innerSize.w,a[c].innerSize.h,h,u,e.config.mode)));var f=p.getElementById("bg-header"),y=p.getElementById("bg-footer");if(f){var g=o-f.offsetHeight-7;f.style.top=g+"px"}if(y){var b=n-y.offsetHeight-7;y.style.bottom=b+"px"}p.close()}var v=e.element.querySelector("#bg-ppdf-content");FamilyTree.anim(v,{opacity:0},{opacity:1},300,FamilyTree.anim.outSin)},FamilyTree.pdfPrevUI._getViewBox=function(e){var t=null;return e?(t=(t="["+(t=e.getAttribute("viewBox"))+"]").replace(/\ /g,","),t=JSON.parse(t)):null},FamilyTree._exportHtml=function(e,t,i,r,a,o,n,l){for(var s="",d=0;d<i.margin.length;d++)s+=i.margin[d]+"px ";var c='<!DOCTYPE html><html style="margin:0;padding:0;"><head></head>'+t+'<body class="'+l+'" style="margin:0; padding:0;"><div style="margin: '+s+";overflow:hidden;width:"+r+"px;height:"+a+'px">';return o&&(c+='<div id="bg-header" style="width:'+r+"px;color:#757575;position:absolute;left:"+i.margin[3]+'px;top:0;">'+o+"</div>"),c+=e,n&&(c+='<div id="bg-footer" style="width:'+r+"px;color:#757575;position:absolute;left:"+i.margin[3]+'px;bottom:0;">'+n+"</div>"),c+="</div>",c+="</body></html>"},FamilyTree.pdfPrevUI.hide=function(e){var t=e.element.querySelector("#bg-ppdf-wrapper");t&&FamilyTree.anim(t,{opacity:1},{opacity:0},300,FamilyTree.anim.inSin,(function(){t.parentNode.removeChild(t);var i=e.element.querySelector("#bg-ppdf-btns");FamilyTree.anim(i,{margin:[0,0,0,0]},{margin:[0,0,0,-280]},300,FamilyTree.anim.inSin,(function(){i.parentNode.removeChild(i)}))}))},FamilyTree.loading={},FamilyTree.loading.show=function(e){var t=document.createElement("div");t.id="bg-loading",t.innerHTML='<style>@-webkit-keyframes dot-keyframes {0% { opacity: .4; -webkit-transform: scale(1, 1);transform: scale(1, 1);}50% {opacity: 1;-webkit-transform: scale(1.2, 1.2);transform: scale(1.2, 1.2);}100% {opacity: .4;-webkit-transform: scale(1, 1);transform: scale(1, 1);}}@keyframes dot-keyframes {0% {opacity: .4;-webkit-transform: scale(1, 1);transform: scale(1, 1);}50% {opacity: 1;-webkit-transform: scale(1.2, 1.2);transform: scale(1.2, 1.2);}100% {opacity: .4;-webkit-transform: scale(1, 1);transform: scale(1, 1);}}.bg-loading-dots div {margin: 10px;}      .bg-dot-1 {background-color: #039BE5;}.bg-dot-2 {background-color: #F57C00;}.bg-dot-3 {background-color: #FFCA28;}      .bg-loading-dots {text-align: center;width: 100%; position: absolute; top: 0;}.bg-loading-dots--dot {-webkit-animation: dot-keyframes 1.5s infinite ease-in-out;animation: dot-keyframes 1.5s infinite ease-in-out;        border-radius: 10px;display: inline-block;height: 10px;width: 10px;}.bg-loading-dots--dot:nth-child(2) {-webkit-animation-delay: .5s;animation-delay: .5s;}.bg-loading-dots--dot:nth-child(3) {-webkit-animation-delay: 1s;animation-delay: 1s;}</style><div class="bg-loading-dots"><div class="bg-loading-dots--dot bg-dot-1"></div><div class="bg-loading-dots--dot bg-dot-2"></div><div class="bg-loading-dots--dot bg-dot-3"></div></div>',e.element.appendChild(t)},FamilyTree.loading.hide=function(e){var t=e.element.querySelector("#bg-loading");t&&t.parentNode.removeChild(t)},"undefined"==typeof FamilyTree&&(FamilyTree={}),FamilyTree.events.on("renderdefs",(function(e,t){for(var i=0;i<e.config.clinks.length;i++){var r=e.config.clinks[i].template;r||(r="orange");var a=FamilyTree.clinkTemplates[r];t.defs+=a.defs}})),FamilyTree.events.on("render",(function(e,t){e._clink(e,t)})),FamilyTree.prototype._clink=function(e,t){for(var i,r,a,o,n,l="",s=0;s<this.config.clinks.length;s++){var d=this.config.clinks[s],c=e.getNode(d.from),m=e.getNode(d.to);if(c&&-1!=t.res.visibleNodeIds.indexOf(c.id)&&(m&&-1!=t.res.visibleNodeIds.indexOf(m.id))){var p=c.x,h=c.y,u=m.x,f=m.y,y={},g={},b=p+c.w/2,v=u+m.w/2,x=h+c.h/2,T=f+m.h/2,F=1;switch(this.config.orientation){case FamilyTree.orientation.top:case FamilyTree.orientation.top_left:b<=v?(F=1,y.x=b+c.w/10,g.x=v-m.w/10):(F=-1,y.x=b-c.w/10,g.x=v+m.w/10),h==f?(F=1,y.y=h,g.y=f):h>f?(y.y=h,g.y=f+m.h):(y.y=h+c.h,g.y=f);break;case FamilyTree.orientation.bottom:case FamilyTree.orientation.bottom_left:b<=v?(F=-1,y.x=b+c.w/10,g.x=v+m.w/10):(F=1,y.x=b-c.w/10,g.x=v+m.w/10),h==f?(F=-1,y.y=h+c.h,g.y=f+m.h):h>f?(y.y=h,g.y=f+m.h):(y.y=h+c.h,g.y=f);break;case FamilyTree.orientation.left:case FamilyTree.orientation.left_top:x<=T?(F=-1,y.y=x+c.h/5,g.y=T+m.h/5):(F=1,y.y=x-c.h/5,g.y=T+m.h/5),p==u?(F=-1,y.x=p,g.x=u):p>u?(y.x=p,g.x=u+m.w):(y.x=p+c.w,g.x=u);break;case FamilyTree.orientation.right:case FamilyTree.orientation.right_top:x<=T?(F=1,y.y=x+c.h/5,g.y=T+m.h/5):(F=-1,y.y=x-c.h/5,g.y=T+m.h/5),p==u?(F=1,y.x=p+c.w,g.x=u+m.w):p>u?(y.x=p,g.x=u+m.w):(y.x=p+c.w,g.x=u)}var _=S(y,g,F),w=d.template;w||(w="orange");var k=FamilyTree.clinkTemplates[w],A=(i=y,a=_,o=void 0,n=void 0,o=((r=g).x-i.x)/2+i.x,n=(r.y-i.y)/2+i.y,{x:(o-a.x)/2+a.x,y:(n-a.y)/2+a.y});d.label&&(l+=k.label.replace("{x}",A.x).replace("{y}",A.y).replace("{val}",d.label));var C="M"+y.x+","+y.y+"C"+y.x+","+y.y+" "+_.x+","+_.y+" "+g.x+","+g.y;l+=("<g "+FamilyTree.attr.c_link_from+'="{from}" '+FamilyTree.attr.c_link_to+'="{to}">').replace("{from}",c.id).replace("{to}",m.id)+k.link.replaceAll("{d}",C)+'<path stroke="transparent" stroke-width="15" fill="none" d="'+C+'" />',l+=FamilyTree.grCloseTag}function S(e,t,i){null==i&&(i=1);var r=t.x-e.x,a=t.y-e.y,o=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))/3;return o=o/(Math.sqrt(r*r+a*a)*i)*FamilyTree.CLINK_CURVE,{x:e.x+r/2-a*o,y:e.y+a/2+r*o}}}t.content+=l},FamilyTree.prototype.addClink=function(e,t,i,r){return this.removeClink(e,t),this.config.clinks.push({from:e,to:t,label:i,template:r}),this},FamilyTree.prototype.removeClink=function(e,t){for(var i=this.config.clinks.length-1;i>=0;i--){var r=this.config.clinks[i];r.from==e&&r.to==t&&this.config.clinks.splice(i,1)}return this},FamilyTree.clinkTemplates={},FamilyTree.clinkTemplates.orange={defs:'<marker id="arrowOrange" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse"><path fill="#F57C00" d="M 0 0 L 10 5 L 0 10 z" /></marker><marker id="dotOrange" viewBox="0 0 10 10" refX="5" refY="5" markerWidth="5" markerHeight="5"> <circle cx="5" cy="5" r="5" fill="#F57C00" /></marker>',link:'<path marker-start="url(#dotOrange)" marker-end="url(#arrowOrange)" stroke="#F57C00" stroke-width="2" fill="none" d="{d}" />',label:'<text fill="#F57C00" text-anchor="middle" x="{x}" y="{y}">{val}</text>'},FamilyTree.clinkTemplates.blue={defs:'<marker id="arrowBlue" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse"><path fill="#039BE5" d="M 0 0 L 10 5 L 0 10 z" /></marker><marker id="dotBlue" viewBox="0 0 10 10" refX="5" refY="5" markerWidth="5" markerHeight="5"> <circle cx="5" cy="5" r="5" fill="#039BE5" /></marker>',link:'<path marker-start="url(#dotBlue)" marker-end="url(#arrowBlue)" stroke="#039BE5" stroke-width="2" fill="none" d="{d}" />',label:'<text fill="#039BE5"  text-anchor="middle" x="{x}" y="{y}">{val}</text>'},FamilyTree.clinkTemplates.yellow={defs:'<marker id="arrowYellow" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse"><path fill="#FFCA28" d="M 0 0 L 10 5 L 0 10 z" /></marker><marker id="dotYellow" viewBox="0 0 10 10" refX="5" refY="5" markerWidth="5" markerHeight="5"> <circle cx="5" cy="5" r="5" fill="#FFCA28" /></marker>',link:'<path marker-start="url(#dotYellow)" marker-end="url(#arrowYellow)" stroke="#FFCA28" stroke-width="2" fill="none" d="{d}" />',label:'<text fill="#FFCA28"  text-anchor="middle" x="{x}" y="{y}">{val}</text>'},"undefined"==typeof FamilyTree&&(FamilyTree={}),FamilyTree.events.on("renderdefs",(function(e,t){for(var i=0;i<e.config.slinks.length;i++){var r=e.config.slinks[i].template;r||(r="orange");var a=FamilyTree.slinkTemplates[r];t.defs+=a.defs}})),FamilyTree.events.on("render",(function(e,t){e._slinks(e,t)})),FamilyTree.prototype._slinks=function(e,t){var i="",r=this.getScale(),a=t.res.boundary;function o(t,o,n){var s=[],d=null,c="left",m=t.lcn?t.lcn:"base",p=e._layoutConfigs[m];switch(p.orientation){case FamilyTree.orientation.top:case FamilyTree.orientation.top_left:case FamilyTree.orientation.bottom:case FamilyTree.orientation.bottom_left:o.x>t.x&&(c="right");break;case FamilyTree.orientation.left:case FamilyTree.orientation.left_top:case FamilyTree.orientation.right:case FamilyTree.orientation.right_top:c="top",o.y>t.y&&(c="bottom")}var h=FamilyTree.t(t.templateName,t.min,r),u=p.levelSeparation;(t.parent&&t.parent.layout==FamilyTree.mixed||t.parent&&t.parent.layout==FamilyTree.tree)&&(u=p.mixedHierarchyNodesSeparation);var f={p:t.x+t.w/2+h.expandCollapseSize,q:t.y,r:t.x+t.w/2+h.expandCollapseSize,s:a.minY+u};if(t.level==o.level)switch(d=o,p.orientation){case FamilyTree.orientation.top:case FamilyTree.orientation.top_left:s.push([f.p,f.q]),s.push([f.p,f.q-u/3]),h=FamilyTree.t(d.templateName,d.min,r),s.push([d.x+d.w/2+h.expandCollapseSize,s[s.length-1][1]]),s.push([s[s.length-1][0],d.y]);break;case FamilyTree.orientation.bottom:case FamilyTree.orientation.bottom_left:f.q=t.y+t.h,f.s=a.maxY-u,s.push([f.p,f.q]),s.push([f.r,t.y+t.h+u/3]),h=FamilyTree.t(d.templateName,d.min,r),s.push([d.x+d.w/2+h.expandCollapseSize,s[s.length-1][1]]),s.push([s[s.length-1][0],d.y+d.h]);break;case FamilyTree.orientation.left:case FamilyTree.orientation.left_top:f.p=t.x,f.q=t.y+t.h/2+h.expandCollapseSize,f.r=a.minX-u,f.s=t.y+t.h/2+h.expandCollapseSize,s.push([f.p,f.q]),s.push([t.x-u/3,f.q]),h=FamilyTree.t(d.templateName,d.min,r),s.push([s[s.length-1][0],d.y+d.h/2+h.expandCollapseSize]),s.push([d.x,s[s.length-1][1]]);break;case FamilyTree.orientation.right:case FamilyTree.orientation.right_top:f.p=t.x+t.w,f.q=t.y+t.h/2+h.expandCollapseSize,f.r=a.maxX+u,f.s=t.y+t.h/2+h.expandCollapseSize,s.push([f.p,f.q]),s.push([t.x+t.w+u/3,f.q]),h=FamilyTree.t(d.templateName,d.min,r),s.push([s[s.length-1][0],d.y+d.h/2+h.expandCollapseSize]),s.push([d.x+d.w,s[s.length-1][1]])}else{switch(p.orientation){case FamilyTree.orientation.top:case FamilyTree.orientation.top_left:s.push([f.p,f.q]),s.push([f.r,t.y-u/3]);break;case FamilyTree.orientation.bottom:case FamilyTree.orientation.bottom_left:f.q=t.y+t.h,f.s=a.maxY-u,s.push([f.p,f.q]),s.push([f.r,t.y+t.h+u/3]);break;case FamilyTree.orientation.left:case FamilyTree.orientation.left_top:f.p=t.x,f.q=t.y+t.h/2+h.expandCollapseSize,f.r=a.minX-u,f.s=t.y+t.h/2+h.expandCollapseSize,s.push([f.p,f.q]),s.push([t.x-u/3,f.q]);break;case FamilyTree.orientation.right:case FamilyTree.orientation.right_top:f.p=t.x+t.w,f.q=t.y+t.h/2+h.expandCollapseSize,f.r=a.maxX+u,f.s=t.y+t.h/2+h.expandCollapseSize,s.push([f.p,f.q]),s.push([t.x+t.w+u/3,f.q])}for(var y=t;null==d;){var g=!1,b=y.parent,v=b.leftNeighbor,x=b.rightNeighbor;if(b.id==o.id?d=b:FamilyTree._intersects(b,f,e.config)&&(f=FamilyTree._addPoint(b,s,e.config,f,c),g=!0),b.id!=o.id){for(;v;){if(v.id==o.id){d=v;break}FamilyTree._intersects(v,f,e.config)&&(f=FamilyTree._addPoint(v,s,e.config,f,c),g=!0),v=v.leftNeighbor}for(;x;){if(x.id==o.id){d=x;break}FamilyTree._intersects(x,f,e.config)&&(f=FamilyTree._addPoint(x,s,e.config,f,c),g=!0),x=x.rightNeighbor}}if(!g){var T=s[s.length-1][0],F=0;if(b.parent)switch(u=p.levelSeparation,b.parent.layout!=FamilyTree.mixed&&b.parent.layout!=FamilyTree.tree||(u=p.mixedHierarchyNodesSeparation),p.orientation){case FamilyTree.orientation.top:case FamilyTree.orientation.top_left:F=b.parent.y+b.parent.h+u*(2/3);break;case FamilyTree.orientation.bottom:case FamilyTree.orientation.bottom_left:F=b.parent.y-u*(2/3);break;case FamilyTree.orientation.left:case FamilyTree.orientation.left_top:T=b.parent.x+b.parent.w+u*(2/3),F=s[s.length-1][1];break;case FamilyTree.orientation.right:case FamilyTree.orientation.right_top:T=b.parent.x-u*(2/3),F=s[s.length-1][1]}s.push([T,F])}y=b}switch(h=FamilyTree.t(d.templateName,d.min,r),s.splice(s.length-1,1),p.orientation){case FamilyTree.orientation.top:case FamilyTree.orientation.top_left:s.push([d.x+d.w/2+h.expandCollapseSize,s[s.length-1][1]]),s.push([s[s.length-1][0],d.y+d.h]);break;case FamilyTree.orientation.bottom:case FamilyTree.orientation.bottom_left:s.push([d.x+d.w/2+h.expandCollapseSize,s[s.length-1][1]]),s.push([s[s.length-1][0],d.y]);break;case FamilyTree.orientation.left:case FamilyTree.orientation.left_top:s.push([s[s.length-1][0],d.y+d.h/2+h.expandCollapseSize]),s.push([d.x+d.w,s[s.length-1][1]]);break;case FamilyTree.orientation.right:case FamilyTree.orientation.right_top:s.push([s[s.length-1][0],d.y+d.h/2+h.expandCollapseSize]),s.push([d.x,s[s.length-1][1]])}}var _=l.template;_||(_="orange");var w,k,A=null;switch((h=FamilyTree.slinkTemplates[_]).labelPosition){case"start":A={x:s[1][0],y:s[1][1]};break;case"middle":var C=Math.ceil(s.length/2);w=s[C],k=s[C-1],A={x:(w[0]+k[0])/2,y:(w[1]+k[1])/2};break;case"end":A={x:s[s.length-2][0],y:s[s.length-2][1]}}n&&(s=s.reverse()),s[0]="M"+s[0].join(",");for(var S=1;S<s.length;S++)s[S]="L"+s[S].join(",");var N=s.join(" ");if(l.label){var I=h.label.replace("{x}",A.x).replace("{y}",A.y).replace("{val}",l.label),M=FamilyTree._getLabelSize(I),L=-M.height/2;switch(p.orientation){case FamilyTree.orientation.bottom:case FamilyTree.orientation.bottom_left:L=M.height}i+=h.label.replace("{x}",A.x).replace("{y}",A.y+L).replace("{val}",l.label)}i+=("<g "+FamilyTree.attr.s_link_from+'="{from}" '+FamilyTree.attr.s_link_to+'="{to}">').replace("{from}",t.id).replace("{to}",o.id)+h.link.replaceAll("{d}",N)+'<path stroke="transparent" stroke-width="15" fill="none" d="'+N+'" />',i+=FamilyTree.grCloseTag}for(var n=0;n<this.config.slinks.length;n++){var l=this.config.slinks[n],s=e.getNode(l.from),d=e.getNode(l.to);s&&d&&-1!=t.res.visibleNodeIds.indexOf(d.id)&&-1!=t.res.visibleNodeIds.indexOf(s.id)&&(s.level>=d.level?o(s,d,!1):o(d,s,!0))}t.content+=i},FamilyTree.prototype.addSlink=function(e,t,i,r){return this.removeClink(e,t),this.config.slinks.push({from:e,to:t,label:i,template:r}),this},FamilyTree.prototype.removeSlink=function(e,t){for(var i=this.config.slinks.length-1;i>=0;i--){var r=this.config.slinks[i];r.from==e&&r.to==t&&this.config.slinks.splice(i,1)}return this},FamilyTree.slinkTemplates={},FamilyTree.slinkTemplates.orange={defs:'<marker id="arrowSlinkOrange" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse"><path fill="#F57C00" d="M 0 0 L 10 5 L 0 10 z" /></marker><marker id="dotSlinkOrange" viewBox="0 0 10 10" refX="5" refY="5" markerWidth="5" markerHeight="5"> <circle cx="5" cy="5" r="5" fill="#F57C00" /></marker>',link:'<path stroke-dasharray="4, 2" marker-start="url(#dotSlinkOrange)" marker-end="url(#arrowSlinkOrange)" stroke-linejoin="round" stroke="#F57C00" stroke-width="2" fill="none" d="{d}" />',label:'<text dominant-baseline="middle" fill="#F57C00" alignment-baseline="middle" text-anchor="middle" x="{x}" y="{y}">{val}</text>',labelPosition:"middle"},FamilyTree.slinkTemplates.blue={defs:'<marker id="arrowSlinkBlue" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse"><path fill="#039BE5" d="M 0 0 L 10 5 L 0 10 z" /></marker><marker id="dotSlinkBlue" viewBox="0 0 10 10" refX="5" refY="5" markerWidth="5" markerHeight="5"> <circle cx="5" cy="5" r="5" fill="#039BE5" /></marker>',link:'<path stroke-dasharray="4, 2" marker-start="url(#dotSlinkBlue)" marker-end="url(#arrowSlinkBlue)" stroke-linejoin="round" stroke="#039BE5" stroke-width="2" fill="none" d="{d}" />',label:'<text fill="#039BE5" text-anchor="middle" x="{x}" y="{y}">{val}</text>',labelPosition:"middle"},FamilyTree.slinkTemplates.yellow={defs:'<marker id="arrowSlinkYellow" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse"><path fill="#FFCA28" d="M 0 0 L 10 5 L 0 10 z" /></marker><marker id="dotSlinkYellow" viewBox="0 0 10 10" refX="5" refY="5" markerWidth="5" markerHeight="5"> <circle cx="5" cy="5" r="5" fill="#FFCA28" /></marker>',link:'<path stroke-dasharray="4, 2" marker-start="url(#dotSlinkYellow)" marker-end="url(#arrowSlinkYellow)" stroke-linejoin="round" stroke="#FFCA28" stroke-width="2" fill="none" d="{d}" />',label:'<text  fill="#FFCA28" text-anchor="middle" x="{x}" y="{y}">{val}</text>',labelPosition:"middle"},FamilyTree.events.on("redraw",(function(e,t){if(e.config.miniMap){var i=FamilyTree.miniMap._getCanvas(e),r=i.getContext("2d");i.width=i.width,i.height=i.height;var a=e.response.boundary.maxX-e.response.boundary.minX,o=e.response.boundary.maxY-e.response.boundary.minY,n=Math.min(i.width/a,i.height/o),l=(i.width-a*n)/2,s=(i.height-o*n)/2;r.clearRect(0,0,i.width,i.height),r.translate(-e.response.boundary.minX*n+l,-e.response.boundary.minY*n+s),r.scale(n,n);var d=0,c=[];!function e(t,i){if(Array.isArray(i))for(var a=0;a<i.length;a++)e(t,i[a]);else{r.fillStyle=FamilyTree.miniMap.colors[3],r.beginPath(),r.lineWidth="0.5",r.fillRect(i.x,i.y,i.w,i.h),r.strokeRect(i.x,i.y,i.w,i.h);for(a=0;a<i.stChildrenIds.length;a++)d++,c.includes(i.id)||(1==d?r.fillStyle=FamilyTree.miniMap.colors[0]:2==d?r.fillStyle=FamilyTree.miniMap.colors[1]:3==d&&(r.fillStyle=FamilyTree.miniMap.colors[2]),r.beginPath(),r.fillRect(i.x,i.y,i.w,i.h),r.strokeRect(i.x,i.y,i.w,i.h),c.push(i.id)),e(t,t.getNode(i.stChildrenIds[a])),d--;for(a=0;a<i.childrenIds.length;a++)e(t,t.getNode(i.childrenIds[a]))}}(e,e.roots);var m=e.getViewBox()[0],p=e.getViewBox()[1],h=e.getViewBox()[2],u=e.getViewBox()[3];r.lineWidth=.5/n,r.strokeStyle="#f57c00",r.strokeRect(m,p,h,u),r.globalAlpha=.4,r.fillStyle=FamilyTree.miniMap.selectorBackgroundColor,r.fillRect(m,p,h,u)}})),FamilyTree.miniMap={},FamilyTree.miniMap._getCanvas=function(e){if(!(t=e.element.querySelector("["+FamilyTree.attr.id+'="mini-map"]'))){var t;(t=document.createElement("canvas")).width=250,t.height=140,t.setAttribute(FamilyTree.attr.id,"mini-map"),t.style.display="inline-block",t.style.backgroundColor=FamilyTree.miniMap.backgroundColor;var i=document.createElement("div");i.classList.add("mini-map"),i.style.position="absolute",i.style.bottom="10px",i.style.left="10px",i.style.border="1px solid #aeaeae",i.style.padding="5px",i.style.margin=e.config.padding+"px",i.style.backgroundColor=FamilyTree.miniMap.backgroundColor,i.appendChild(t),e.element.appendChild(i)}return t},FamilyTree.miniMap.colors=["#E0E0E0","#BDBDBD","#9E9E9E","#757575"],FamilyTree.miniMap.selectorBackgroundColor="white",FamilyTree.miniMap.backgroundColor="white",FamilyTree.events.on("redraw",(function(e,t){if(e.config.state){var i=[],r=[];!function e(t){if(Array.isArray(t))for(var a=0;a<t.length;a++)e(t[a]);else{("string"!=typeof t.id||"string"==typeof t.id&&-1==t.id.indexOf("split")&&-1==t.id.indexOf("mirror"))&&(i.push(t.id),1==t.min&&r.push(t.id));for(a=0;a<t.stChildren.length;a++)e(t.stChildren[a]);for(a=0;a<t.children.length;a++)e(t.children[a])}}(e.roots),FamilyTree.state._put(e.width(),e.height(),e.response.viewBox,i,r,e.response.adjustify,e.config.state)}})),FamilyTree.state={},FamilyTree.state._buildStateNames=function(e){return{paramScale:e+"-scale",paramX:e+"-x",paramY:e+"-y",paramExp:e+"-exp",paramMin:e+"-min",paramAdjustify:e+"-adjustify"}},FamilyTree.state._put=function(e,t,i,r,a,o,n){if(n){var l=FamilyTree.state._buildStateNames(n.name),s={scale:Math.min(e/i[2],t/i[3]),x:i[0],y:i[1],exp:r,min:a,adjustify:o};if(n.writeToUrlParams){var d=new URLSearchParams(window.location.search);d.has(l.paramScale)?d.set(l.paramScale,s.scale):d.append(l.paramScale,s.scale),d.has(l.paramX)?d.set(l.paramX,s.x):d.append(l.paramX,s.x),d.has(l.paramY)?d.set(l.paramY,s.y):d.append(l.paramY,s.y),d.has(l.paramExp)?d.set(l.paramExp,s.exp.join("*")):d.append(l.paramExp,s.exp.join("*")),d.has(l.paramMin)?d.set(l.paramMin,s.min.join("*")):d.append(l.paramMin,s.min.join("*")),d.has(l.paramAdjustify)?d.set(l.paramAdjustify,s.adjustify.x+"*"+s.adjustify.y):d.append(l.paramAdjustify,s.adjustify.x+"*"+s.adjustify.y),window.history.replaceState(null,null,"?"+d)}n.writeToIndexedDB&&(s.id=n.name,FamilyTree.idb.put(s,(function(e){0==e&&console.error("Cannot write row - "+n.name)}))),n.writeToLocalStorage&&FamilyTree.localStorage.setItem(n.name,JSON.stringify(s))}},FamilyTree.state._get=function(e,t,i,r){if(e){var a=FamilyTree.state._buildStateNames(e.name);if(e.readFromUrlParams){var o=new URLSearchParams(window.location.search);if(o.has(a.paramScale)&&o.has(a.paramX)&&o.has(a.paramY)&&o.has(a.paramExp)&&o.has(a.paramMin)&&o.has(a.paramAdjustify)){var n={},l=parseFloat(o.get(a.paramScale)),s=parseFloat(o.get(a.paramX)),d=parseFloat(o.get(a.paramY));(m=[])[0]=s,m[1]=d,m[2]=t/l,m[3]=i/l,n.vb=m,n.scale=l,n.x=s,n.y=d,n.exp=o.get(a.paramExp).split("*"),n.min=o.get(a.paramMin).split("*");var c=o.get(a.paramAdjustify).split("*");return n.adjustify={x:parseFloat(c[0]),y:parseFloat(c[1])},void r(n)}if(!e.readFromIndexedDB&&!e.readFromLocalStorage)return void r(null)}if(e.readFromLocalStorage){var m;if(null!=(n=FamilyTree.localStorage.getItem(e.name)))return n=JSON.parse(n),(m=[])[0]=n.x,m[1]=n.y,m[2]=t/n.scale,m[3]=i/n.scale,n.vb=m,void r(n);if(!e.readFromIndexedDB)return void r(null)}e.readFromIndexedDB&&FamilyTree.idb.read(e.name,(function(a,o){if(0==a)console.error("Cannot read from - "+e.name),r(null);else if(null==a)r(null);else{var n=[];n[0]=o.x,n[1]=o.y,n[2]=t/o.scale,n[3]=i/o.scale,o.vb=n,r(o)}}))}else r(null)},FamilyTree.state.clear=function(e){if(!e)return!1;var t=FamilyTree.state._buildStateNames(e),i=new URLSearchParams(window.location.search);i.has(t.paramScale)&&i.delete(t.paramScale),i.has(t.paramX)&&i.delete(t.paramX),i.has(t.paramY)&&i.delete(t.paramY),i.has(t.paramExp)&&i.delete(t.paramExp),i.has(t.paramMin)&&i.delete(t.paramMin),i.has(t.paramAdjustify)&&i.delete(t.paramAdjustify),window.history.replaceState(null,null,"?"+i),FamilyTree.idb.delete(e,(function(t){0==t&&console.error("Cannot delete row - "+e)}))},FamilyTree.ui.css=function(){return'<style data-ba-styles>.ba-button{background-color:#039be5;cursor:pointer;width:calc(100%);height:50px;color:#fff;padding-top:5px;padding-left:7px;padding-right:7px;text-align:center;text-transform:uppercase;border:1px solid #3fc0ff;display:inline-block;border-radius:5px}.ba-button.orange{background-color:#f57c00;border:1px solid #ffa03e}.ba-button.yellow{background-color:#ffca28;border:1px solid #ffdf7c}.ba-button.lower{text-transform:unset}.ba-button.transparent{background-color:transparent}.ba-button:hover{background-color:#35afea}.ba-button.orange:hover{background-color:#f79632}.ba-button.yellow:hover{background-color:#ffd452}.ba-button:active{transform:matrix(.98,0,0,.98,0,0)}.ba-button-icon{text-align:initial;cursor:pointer;margin-bottom:15px;color:#039be5}.dark .ba-button-icon:hover{background-color:#2d2d2d}.light .ba-button-icon:hover{background-color:#ececec}.ba-button-icon>img{height:24px;width:24px;vertical-align:middle;padding:7px}.ba-button:focus{outline:0}.ba-button-icon>img{filter:invert(46%) sepia(66%) saturate(2530%) hue-rotate(171deg) brightness(95%) contrast(98%)}.light .ba-button.transparent{color:#039be5}.light .ba-button.transparent:hover{color:#fff}.ba-button-loading{background-color:transparent;cursor:pointer;width:calc(100% - 2px);height:50px;color:#fff;text-align:center;text-transform:uppercase;border:1px solid #027cb7;display:inline-block;display:flex;justify-content:center;align-items:center;display:none}.ba-button-loading .ba-loading-dots div{margin:0 10px}.ba-link-ba-button{position:absolute;right:10px;top:-1px}[data-ba-input-disabled] .ba-link-ba-button{display:none}[dir=rtl] .ba-link-ba-button{left:10px;right:unset}.ba-img-button{width:48px;height:48px;cursor:pointer;border-radius:50%;background-color:#039be5;background-repeat:no-repeat;background-size:24px 24px;background-position:center center;margin:3px;display:inline-block}.ba-img-button:hover{background-color:#f57c00}.ba-checkbox{display:block;position:relative;padding-left:35px;margin-bottom:12px;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;white-space:nowrap}.ba-checkbox input{position:absolute;opacity:0;cursor:pointer;height:0;width:0}.ba-checkbox-checkmark{position:absolute;top:0;left:0;height:25px;width:25px;border-radius:5px}.dark [data-ba-input-disabled] .ba-checkbox-checkmark,.dark [data-ba-input-disabled].ba-checkbox input:checked~.ba-checkbox-checkmark,.light [data-ba-input-disabled] .ba-checkbox-checkmark,.light [data-ba-input-disabled].ba-checkbox input:checked~.ba-checkbox-checkmark{background-color:#aeaeae!important}[data-ba-input-disabled].ba-checkbox{cursor:default}[dir=rtl] .ba-checkbox-checkmark{right:0}[dir=rtl] .ba-checkbox{padding-left:unset;padding-right:35px}.dark .ba-checkbox-checkmark{background-color:#333;border:1px solid #5b5b5b}.light .ba-checkbox-checkmark{background-color:#fff;border:1px solid #c7c7c7}.dark .ba-checkbox:hover input~.ba-checkbox-checkmark{background-color:#3c3c3c}.light .ba-checkbox:hover input~.ba-checkbox-checkmark{background-color:#f8f9f9}.dark .ba-checkbox input:checked~.ba-checkbox-checkmark{background-color:#039be5}.light .ba-checkbox input:checked~.ba-checkbox-checkmark{background-color:#039be5}.ba-checkbox-checkmark:after{content:"";position:absolute;display:none}.ba-checkbox input:checked~.ba-checkbox-checkmark:after{display:block}.ba-checkbox .ba-checkbox-checkmark:after{left:9px;top:5px;width:5px;height:10px;border:solid #fff;border-width:0 3px 3px 0;-webkit-transform:rotate(45deg);-ms-transform:rotate(45deg);transform:rotate(45deg)}.ba-form-perspective{transform-style:preserve-3d;perspective:500px;position:absolute;top:32px;z-index:1900}.ba-form{box-shadow:rgba(0,0,0,.2) 0 6px 6px 0,rgba(0,0,0,.19) 0 13px 20px 0;padding:14px;transform-origin:top center;user-select:none;display:none;position:relative;max-height:calc(100vh - 100px);overflow-y:auto;border-bottom-left-radius:5px;border-bottom-right-radius:5px}.ba-form-bottom{border-bottom-left-radius:unset;border-bottom-right-radius:unset;border-top-left-radius:5px;border-top-right-radius:5px}.ba-form .separator{margin:0 10px}@media screen and (max-width:1000px){.ba-form-perspective{min-width:100%;max-height:calc(100% - 32px);left:unset!important;right:unset!important;transform:none!important}.ba-form .set{max-height:calc(100vh - 74px)}.ba-form-fieldset{max-width:unset!important}}.light .ba-form .separator{border-bottom:1px solid #c7c7c7}.dark .ba-form .separator{border-bottom:1px solid #5b5b5b}.light .ba-form{background-color:#fff}.dark .ba-form{background-color:#252526}.item{padding:6px 12px 6px 12px;display:flex;flex-direction:row}.light .ba-form .item.selected,.light .ba-form .item:hover{background-color:#0074e8;color:#fff}.dark .ba-form .item.selected,.dark .ba-form .item:hover{background-color:#094771;color:#fff}.item.selected img,.item:hover img{filter:invert(100%)}.item.selected img{visibility:visible!important}.ba-form-fieldset{display:flex;flex-wrap:wrap;margin:0!important}.ba-form-field{flex:1 0 21%;margin:3px;min-width:200px}.ba-form-field-100{flex:1 0 96%;margin:3px;min-width:200px}.ba-input{position:relative}.ba-input>input,.ba-input>select{height:50px;padding:18px 10px 2px 9px;width:100%;box-sizing:border-box;border-style:solid;border-width:1px}.ba-input select{height:50px;padding:20px 5px 4px 5px}[data-ba-input-disabled].ba-input>input,[data-ba-input-disabled].ba-input>select{border-color:transparent!important}.light [data-ba-input-disabled]>input,.light [data-ba-input-disabled]>select{background-color:#fff!important}.dark [data-ba-input-disabled]>input,.dark [data-ba-input-disabled]>select{background-color:#252526!important}[data-ba-input-disabled]>select{appearance:none;padding-left:8px}.ba-input>label{display:inline-block;position:absolute;padding-left:10px;padding-right:10px;color:#acacac;cursor:text;-webkit-transition:all .1s ease-out;-moz-transition:all .1s ease-out;-ms-transition:all .1s ease-out;-o-transition:all .1s ease-out;transition:all .1 ease-out;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:initial;text-align:initial;white-space:nowrap}.ba-input>label{top:12px;overflow:hidden;text-overflow:ellipsis;max-width:calc(100% - 14px)}.ba-input>label.focused,.ba-input>label.hasval{top:-1px}.ba-input>input,.ba-input>select{outline:0;border-radius:5px}.dark .ba-input>label.focused,.light .ba-input>label.focused{color:#039be5}.dark .ba-input>input,.dark .ba-input>select{color:#ccc;background-color:#333;border-color:#5b5b5b}.light .ba-input>input,.light .ba-input>select{color:#757575;background-color:#fff;border-color:#c7c7c7}.light .ba-input>input:focus,.light .ba-input>select:focus{border-color:#039be5;background-color:#f8f9f9}.dark .ba-input>input:focus,.dark .ba-input>select:focus{border-color:#039be5;background-color:#3c3c3c}.dark .ba-input>input.validation-error,.dark .ba-input>select.validation-error,.light .ba-input>input.validation-error,.light .ba-input>select.validation-error{border-color:#ca2a2a}.dark .validation-error-message,.light .validation-error-message{color:#ca2a2a}.ba-link{color:#039be5;cursor:pointer;text-decoration:underline}.ba-link:hover{color:#f57c00}::-webkit-scrollbar{width:15px}.dark ::-webkit-scrollbar-track{background:#1e1e1e;border-left:1px solid #333}.dark ::-webkit-scrollbar-thumb{background:#424242}.dark ::-webkit-scrollbar-thumb:hover{background:#4f4f4f}.dark ::-webkit-scrollbar-thumb:active{background:#5e5e5e}.light ::-webkit-scrollbar-track{background:#fff;border-left:1px solid #ddd}.light ::-webkit-scrollbar-thumb{background:#c1c1c1}.light ::-webkit-scrollbar-thumb:hover{background:#929292}.light ::-webkit-scrollbar-thumb:active{background:#666}.edit-form{position:fixed;top:0;right:0;height:100%;width:100%;box-shadow:rgba(0,0,0,.2) 0 6px 6px 0,rgba(0,0,0,.19) 0 13px 20px 0;display:flex;flex-direction:column;height:100%;width:400px;z-index:1000}@media screen and (max-width:1000px){.edit-form{width:100%}}.dark .edit-form{background-color:#252526}.light .edit-form{background-color:#fff}.edit-form-header{height:200px;text-align:center;border-radius:10px}.export-service .edit-form-header{border-radius:unset}.edit-form-title{color:#fff;margin:0;padding:14px 17px 7px 17px}.edit-form-avatar{border-radius:50%;width:150px;height:150px;position:absolute;top:75px;border:5px solid #fff;left:50%;transform:translateX(-50%);background-color:#cacaca;box-shadow:rgba(0,0,0,.2) 0 6px 6px 0,rgba(0,0,0,.19) 0 13px 20px 0}.edit-form-close{position:absolute;right:14px;top:14px;width:34px;height:34px;cursor:pointer}.edit-form-fields{flex-grow:1;overflow-y:auto;overflow-x:hidden}.edit-form-fields-inner{margin:0 7px 20px 7px}.chart-menu{opacity:0;display:inline-block;z-index:1000;position:absolute;text-align:left;user-select:none;min-width:270px;box-shadow:rgba(0,0,0,.2) 0 4px 8px 0,rgba(0,0,0,.19) 0 6px 20px 0;font:13px/28px Helvetica,"Segoe UI",Arial,sans-serif;border-radius:10px}.chart-menu>div:hover img{filter:invert(100%)}.chart-menu [data-item]{text-align:start;padding:7px 10px}.dark .chart-menu [data-item]{background-color:#252526;color:#acacac;border-bottom:1px solid #333}.dark .chart-menu [data-item]:hover{background-color:#094771!important;color:#fff!important}.dark .chart-menu [data-item]:hover svg{filter:brightness(0) invert(1)}.light .chart-menu [data-item]{background-color:#fff;color:#333;border-bottom:1px solid #c7c7c7}.light .chart-menu [data-item]:hover{background-color:#0074e8!important;color:#fff!important}.light .chart-menu [data-item]:hover svg{filter:brightness(0) invert(1)}.chart-menu [data-item] svg{vertical-align:middle}.chart-menu [data-item]:first-child{border-top-left-radius:7px;border-top-right-radius:7px}.chart-menu [data-item]:last-child{border-bottom-width:0;border-bottom-style:none;border-bottom-left-radius:7px;border-bottom-right-radius:7px}.search{position:absolute}@media screen and (max-width:1000px){.search{width:calc(100% - 30px)}}.search .ba-input{margin-bottom:0}.search-input{color:#7a7a7a;width:100%;border:none;outline:0;padding-top:10px;padding-right:47px}.search label{padding-right:47px}.search-image-td{width:43px}.search-text-td{padding-inline-end:7px;line-height:15px;text-align:start}.search table{box-shadow:rgba(0,0,0,.2) 0 4px 8px 0,rgba(0,0,0,.19) 0 6px 20px 0;margin:0 3.5px 0 3.5px;width:calc(100% - 7px);border-radius:7px}.search table tr:first-child td:first-child{border-top-left-radius:7px}.search table tr:first-child td:last-child{border-top-right-radius:7px}[dir=rtl] .search table tr:first-child td:first-child{border-top-left-radius:unset;border-top-right-radius:7px}[dir=rtl] .search table tr:first-child td:last-child{border-top-right-radius:unset;border-top-left-radius:7px}.search table tr:last-child td:first-child{border-bottom-left-radius:7px}.search table tr:last-child td:last-child{border-bottom-right-radius:7px}[dir=rtl] .search table tr:last-child td:first-child{border-bottom-left-radius:unset;border-bottom-right-radius:7px}[dir=rtl] .search table tr:last-child td:last-child{border-bottom-right-radius:unset;border-bottom-left-radius:7px}.dark .search table{background-color:#252526;color:#acacac}.search [data-search-item-id]{cursor:pointer}.search-photo{margin:7px 7px 0 7px;width:32px;height:32px;background-size:cover;background-position:top center;border-radius:50%;display:inline-block;border:1px solid #8c8c8c}.dark .search [data-search-item-id] td{border-top:1px solid #333}.dark .search [data-search-item-id]:hover,.dark .search [data-selected=yes]{background-color:#094771;color:#fff}.light .search table{background-color:#fff;color:#333}.light .search [data-search-item-id] td{border-top:1px solid #c7c7c7}.light .search [data-search-item-id]:hover,.light .search [data-selected=yes]{background-color:#0074e8;color:#fff}.search [data-search-item-id]:first-child td{border-top:unset}.bg-ripple-container{position:absolute;top:0;right:0;bottom:0;left:0}.drag-over rect{opacity:.5}.bg-ripple-container span{transform:scale(0);border-radius:100%;position:absolute;opacity:.75;background-color:#fff;animation:bg-ripple 1s}@-moz-keyframes bg-ripple{to{opacity:0;transform:scale(2)}}@-webkit-keyframes bg-ripple{to{opacity:0;transform:scale(2)}}@-o-keyframes bg-ripple{to{opacity:0;transform:scale(2)}}@keyframes bg-ripple{to{opacity:0;transform:scale(2)}}.bg-slider{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:#ccc;-webkit-transition:.4s;transition:.4s}.bg-slider:before{position:absolute;content:"";height:16px;width:16px;left:4px;bottom:4px;background-color:#fff;-webkit-transition:.4s;transition:.4s}.bg-slider.round{border-radius:24px}.bg-slider.round:before{border-radius:50%}svg text:hover{cursor:default}svg.cursor-grab,svg.cursor-grab text:hover{cursor:grab}svg.cursor-nodrop,svg.cursor-nodrop text:hover{cursor:no-drop}svg.cursor-copy,svg.cursor-copy text:hover{cursor:copy}svg.cursor-move,svg.cursor-move text:hover{cursor:move}#close-btn:focus,#close-btn:hover{color:#000;text-decoration:none;cursor:pointer}#id-select:focus,#pid-select:focus{outline:.5px solid #aeaeae}#sampleDialog #title:hover{cursor:default;background:gray}.light{background-color:#fff;font:13px/28px Helvetica,"Segoe UI",Arial,sans-serif}.dark{background-color:#1e1e1e;font:13px/28px Helvetica,"Segoe UI",Arial,sans-serif}.light .ba-fill{fill:#fff}.dark .ba-fill{fill:#1e1e1e}.dark input,.dark select,.light input,.light select{font:16px Helvetica,"Segoe UI",Arial,sans-serif}.dark h1,.light h1{font-size:30px;line-height:1}.edit-form{position:absolute;border-radius:10px}.export-service .edit-form{border-radius:unset}.dark .edit-form{color:#acacac}.light .edit-form{color:#333}.edit-form .ba-img-button:hover{background-color:#f57c00!important}.dark ::-webkit-calendar-picker-indicator{filter:invert(70%)}.light ::-webkit-calendar-picker-indicator{filter:invert(50%)}.edit-form-instruments{margin:42px 10px 0 10px;text-align:center;min-height:70px}.ba-img-button svg{position:relative;top:12px}.light .bg-toolbar-container svg circle,.light .bg-toolbar-container svg line,.light .bg-toolbar-container svg path{stroke:#8c8c8c!important;fill:#8c8c8c!important}.dark .bg-toolbar-container svg circle,.dark .bg-toolbar-container svg line,.dark .bg-toolbar-container svg path{stroke:#8c8c8c!important;fill:#8c8c8c!important}.dark .bg-toolbar-container svg rect{fill:#252526!important}.dark .bg-toolbar-container [data-tlbr=minus] svg{border-left:1px solid #5b5b5b!important;border-right:1px solid #5b5b5b!important;border-bottom:1px solid #5b5b5b!important}.dark .bg-toolbar-container [data-tlbr=plus] svg{border-left:1px solid #5b5b5b!important;border-right:1px solid #5b5b5b!important;border-top:1px solid #5b5b5b!important}.dark .bg-toolbar-container [data-tlbr]>svg{border:1px solid #5b5b5b!important;background-color:#252526!important}</style>'},FamilyTree.input={},FamilyTree.input._timeout=null,FamilyTree.input.initWithTimeout=function(){FamilyTree.input._timeout&&(clearTimeout(FamilyTree.input._timeout),FamilyTree.input._timeout=null),FamilyTree.input._timeout=setTimeout(FamilyTree.input.init,200)},FamilyTree.input.init=function(e){var t;t=e?e.querySelectorAll("[data-ba-input]"):document.querySelectorAll("[data-ba-input]");for(var i=0;i<t.length;i++){var r=t[i],a=null;r.type&&"hidden"==r.type.toLowerCase()&&(a=r),a||(a=r.querySelector("input")),a||(a=r.querySelector("select"));var o=r.querySelector("label");o&&(a.value||"select-one"==a.type&&a.selectedOptions&&a.selectedOptions.length&&""==a.selectedOptions[0].value&&a.selectedOptions[0].innerHTML)&&o.classList.add("hasval"),"checkbox"!=a.type.toLowerCase()&&a.addEventListener("focus",(function(){this.classList.remove("validation-error");var e=this.parentNode.querySelector("label");e.classList.add("focused");var t=e.querySelector(".validation-error-message");t&&t.parentNode.removeChild(t)})),"checkbox"!=a.type.toLowerCase()&&a.addEventListener("blur",(function(){var e=this.parentNode.querySelector("label");e.classList.remove("focused"),this.value||"date"==this.type?e.classList.add("hasval"):e.classList.remove("hasval")}))}},FamilyTree.input.validate=function(e){var t=null;e.type&&"hidden"==e.type.toLowerCase()&&(t=e),t||(t=e.querySelector("input")),t||(t=e.querySelector("select"));var i=e.querySelector("label");if(t.classList.remove("validation-error"),i){var r=i.querySelector(".validation-error-message");r&&r.parentNode.removeChild(r)}t.value&&(t.value=t.value.trim());var a=e.getAttribute("data-v-required"),o=e.getAttribute("data-v-password"),n=e.getAttribute("data-v-email"),l=e.getAttribute("data-v-emails");return a&&""==t.value?(i.innerHTML+='<span class="validation-error-message">&nbsp;'+a+"</span>",t.classList.add("validation-error"),!1):o&&!FamilyTree.input.validatePassword(t.value)?(i.innerHTML+='<span class="validation-error-message">&nbsp;'+o+"</span>",t.classList.add("validation-error"),!1):n&&!FamilyTree.input.isValidEmail(t.value)?(i.innerHTML+='<span class="validation-error-message">&nbsp;'+n+"</span>",t.classList.add("validation-error"),!1):!(l&&!FamilyTree.input.isValidEmails(t.value))||(i.innerHTML+='<span class="validation-error-message">&nbsp;'+l+"</span>",t.classList.add("validation-error"),!1)},FamilyTree.input.validateAndGetData=function(e){for(var t=e.querySelectorAll("[data-ba-input]"),i=!0,r=0;r<t.length;r++){var a=t[r];FamilyTree.input.validate(a)||(i=!1)}if(!i)return!1;var o=e.querySelectorAll("[data-binding]"),n={};for(r=0;r<o.length;r++){var l=o[r],s=l.getAttribute("data-binding");"checkbox"==l.type.toLowerCase()?n[s]=l.checked:n[s]=l.value}return n},FamilyTree.input.validatePassword=function(e){return e&&(e=e.trim()),!(e.length<5)&&(!(e.length>18)&&-1==e.indexOf(" "))},FamilyTree.input.isValidEmails=function(e){if(e)for(var t=e.split(","),i=0;i<t.length;i++){var r=t[i].trim();if(!FamilyTree.input.isValidEmail(r))return!1}return!0},FamilyTree.input.isValidEmail=function(e){e&&(e=e.trim());return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e).toLowerCase())},FamilyTree.elements={},FamilyTree.elements.textbox=function(e,t,i,r){var a=FamilyTree.elements._vidrf(e,t,r);if(a.doNotRender)return{html:""};var o="";return t.btn&&(o=`<a href="#" ba-input-btn="" class="ba-link ba-link-ba-button">${t.btn}</a>`),{html:`<div class="ba-form-field" style="min-width: ${i};">\n                    <div class="ba-input" data-ba-input="" ${a.disabledAttribute} ${a.vlidators}>\n                        <label for="${a.id}">${a.label}</label>\n                        <input ${a.readOnlyAttribute} data-binding="${a.binding}" maxlength="256" id="${a.id}" name="${a.id}" type="text" value="${a.value}" autocomplete="off">\n                        ${o}\n                    </div>\n                </div>`,id:a.id,value:a.value}},FamilyTree.elements.checkbox=function(e,t,i,r){var a=FamilyTree.elements._vidrf(e,t,r);if(a.doNotRender)return{html:""};var o=a.value?"checked":"",n=r?'onclick="return false;"':"";return{html:`<div class="ba-form-field"  style="min-width: ${i};" >\n                        <label class="ba-checkbox" data-ba-input="" ${a.disabledAttribute}>\n                            <input ${o} ${n} data-binding="${a.binding}" type="checkbox"><span class="ba-checkbox-checkmark" type="checkbox"></span>${a.label}\n                        </label>\n                    </div>`,id:a.id,value:o}},FamilyTree.elements.select=function(e,t,i,r){if(r)return FamilyTree.elements.textbox(e,t,i,r);var a=FamilyTree.elements._vidrf(e,t,r);return a.doNotRender?{html:""}:{html:`<div class="ba-form-field" style="min-width: ${i};">\n                    <div class="ba-input" data-ba-input="" ${a.disabledAttribute} ${a.vlidators}>\n                        <label for="${a.id}">${a.label}</label>\n                        <select data-binding="${a.binding}" ${a.readOnlyAttribute} id="${a.id}" name="${a.id}">\n                            ${function(){for(var e="",t=0;t<a.options.length;t++){var i=a.options[t];e+=`<option ${i.value==a.value?"selected":""} value="${i.value}">${i.text}</option>`}return e}()}                           \n                        </select>\n                    </div>\n                </div>`,id:a.id,value:a.value}},FamilyTree.elements.date=function(e,t,i,r){var a=FamilyTree.elements._vidrf(e,t,r);return a.doNotRender?{html:""}:{html:`<div class="ba-form-field" style="min-width: ${i};">\n                    <div class="ba-input" data-ba-input="" ${a.disabledAttribute} ${a.vlidators}>\n                        <label for="${a.id}" class="hasval">${a.label}</label>\n                        <input data-binding="${a.binding}" ${a.readOnlyAttribute} maxlength="256" id="${a.id}" name="${a.id}" type="date" value="${a.value}" autocomplete="off">\n                    </div>\n                </div>`,id:a.id,value:a.value}},FamilyTree.elements._vidrf=function(e,t,i){var r={};if(t.binding||(t.binding=""),t.label||(t.label=""),"select"!=t.type||Array.isArray(t.options)?r.options=t.options:r.options=[],r.value=e&&!FamilyTree.isNEU(e[t.binding])?e[t.binding]:"",i&&r.options)for(var a=0;a<r.options.length;a++)if(r.options[a].value==r.value){r.value=r.options[a].text;break}if(r.id=FamilyTree.elements.generateId(),r.disabledAttribute=i?"data-ba-input-disabled":"",r.readOnlyAttribute=i?"readonly":"",r.id=r.id,i&&FamilyTree.isNEU(r.value)&&(r.doNotRender=!0),i&&"photo"==t.binding&&(r.id=null,r.doNotRender=!0),r.binding=t.binding,r.label=t.label,r.vlidators="",t.vlidators)for(var o in t.vlidators)r.vlidators+=`data-v-${o}="${t.vlidators[o]}" `;return r},FamilyTree.elements.ids=[],FamilyTree.elements.generateId=function(){for(;;){var e="_"+("0000"+(Math.random()*Math.pow(36,4)|0).toString(36)).slice(-4);if(!FamilyTree.elements.ids.has(e))return FamilyTree.elements.ids.push(e),e}},"undefined"==typeof FamilyTree&&(FamilyTree={}),FamilyTree.events.on("init",(function(e,t){e.config.enableKeyNavigation&&(e._addEvent(window,"keydown",e._windowKeyDownHandler),FamilyTree.isNEU(e._keyNavigationActiveNodeId)&&e.roots&&e.roots.length&&(e._keyNavigationActiveNodeId=e.roots[0].id,e.center(e._keyNavigationActiveNodeId)))})),FamilyTree.prototype._windowKeyDownHandler=function(e,t){for(var i=t.target,r=null;i&&i!=this.element;){if(i.hasAttribute&&i.hasAttribute(FamilyTree.attr.node_id)){r=i.getAttribute(FamilyTree.attr.node_id);break}i=i.parentNode}if(i){var a=r?this.getNode(r):null,o={node:a,data:r?this.get(r):null,event:t};if(!1!==FamilyTree.events.publish("key-down",[this,o])&&a)if("KeyF"==t.code)this.searchUI.find("");else if("ArrowRight"==t.code||a.isAssistant&&"ArrowDown"==t.code||a.isPartner&&"ArrowDown"==t.code){if(s=this.getNode(a.pid)){var n=s.childrenIds.indexOf(a.id);if(++n<s.childrenIds.length){var l=s.childrenIds[n];this._keyNavigationActiveNodeId=l,this.center(l)}}}else if("ArrowLeft"==t.code){if(s=this.getNode(a.pid)){n=s.childrenIds.indexOf(a.id);if(--n>=0){l=s.childrenIds[n];this._keyNavigationActiveNodeId=l,this.center(l)}}}else if("ArrowUp"==t.code){var s;if(s=this.getNode(a.pid)){l=s.id;if(a.isAssistant||s.hasAssistants||a.isPartner||s.hasPartners){n=s.childrenIds.indexOf(a.id);--n>=0&&(l=s.childrenIds[n])}this._keyNavigationActiveNodeId=l,this.center(l)}}else if("ArrowDown"==t.code)a.childrenIds.length&&(this._keyNavigationActiveNodeId=a.childrenIds[0],this.center(a.childrenIds[0]));else if("Space"==t.code){var d=i.getAttribute(FamilyTree.attr.node_id);return void this.toggleExpandCollapse(d,t)}}},FamilyTree.events.on("redraw",(function(e,t){e.config.enableKeyNavigation&&FamilyTree._keyNavigation(e)})),FamilyTree.events.on("click",(function(e,t){e.config&&e.config.enableKeyNavigation&&(e._keyNavigationActiveNodeId=t.node.id,e.center(t.node.id))})),FamilyTree._keyNavigation=function(e){var t=e.element.querySelector(":focus");if(t&&t.parentElement&&t.parentElement.hasAttribute(FamilyTree.attr.node_id)){var i=t.parentElement;(a=(r=t).querySelector("title"))&&a.parentNode.removeChild(a),r.removeAttribute("tabindex")}if(!FamilyTree.isNEU(e._keyNavigationActiveNodeId)&&((i=e.getNodeElement(e._keyNavigationActiveNodeId))&&i.children.length)){var r;(r=i.children[0]).setAttribute("tabindex",2);var a,o={text:"",id:e._keyNavigationActiveNodeId};if(FamilyTree.events.publish("screen-reader-text",[e,o]),!FamilyTree.isNEU(o.text))(a=document.createElementNS("http://www.w3.org/2000/svg","title")).innerHTML=o.text,r.appendChild(a);e.searchUI.hide(),r.focus()}},FamilyTree._search={},FamilyTree._search.search=function(e,t,i,r,a,o){var n=[],l=t.toLowerCase().split(" ");l=l.filter((function(e,t,i){return i.indexOf(e)===t}));for(var s={},d=0;d<e.length;d++)for(var c=e[d],m=0;m<i.length;m++){var p=i[m];if(!FamilyTree.isNEU(c[p])){var h=c[p];if(null!=(t=FamilyTree._search.searchAndComputeScore(l,h,p,o))){var u=c.id;if(s[u]){if(s[u]&&s[u]<t.__score){s[u]=t.__score;for(var f=n.length-1;f>=0;f--)n[f].id==u&&n.splice(f,1);FamilyTree._search.addNodeToResult(n,r,c,t,p,a)}}else s[u]=t.__score,FamilyTree._search.addNodeToResult(n,r,c,t,p,a)}}}return n.sort((function(e,t){return e.__score<t.__score?1:e.__score>t.__score?-1:0})),n},FamilyTree._search.addNodeToResult=function(e,t,i,r,a,o){var n={};n.id=i.id,FamilyTree.isNEU(i[o])||(n[o]=i[o]);for(var l=0;l<t.length;l++){var s=t[l];FamilyTree.isNEU(i[s])||FamilyTree.isNEU(n[s])&&(n[s]=i[s])}null!=r&&(FamilyTree.isNEU(n.__score)&&(n.__score=r.__score),FamilyTree.isNEU(n.__searchField)&&(n.__searchField=a),FamilyTree.isNEU(n.__searchMarks)&&(n.__searchMarks=r.__searchMarks)),e.push(n)},FamilyTree._search.searchAndComputeScore=function(e,t,i,r){if(FamilyTree.isNEU(t))return null;if(FamilyTree.isNEU(e))return null;if(!e.length)return null;"string"!=typeof t&&(t=t.toString());var a=t.toLowerCase(),o=FamilyTree._search.searchIndexesOf(a,e);if(!o.length)return null;var n=a.length/100,l=0,s=0,d=l>0?100:0;if(o.length){s=o[0].start;for(var c=0;c<o.length;c++)if(l+=o[c].length,o[c].start<s&&(s=o[c].start),c>=1&&o[c-1].start>o[c].start){d=0;break}}var m=0;0!=l&&(m=l/n);var p=l>0?100:0;0!=s&&(p=100-s/n);var h=0;r&&r[i]&&(h=r[i]),m>0&&(m=m/100*20),p>0&&(p=p/100*20),d>0&&(d=d/100*20),h>0&&(h=h/100*40);var u=parseInt(m+p+d+h);u>100&&(u=100),o.sort((function(e,t){return e.start<t.start?-1:e.start>t.start?1:0}));var f=t;for(c=o.length-1;c>=0;c--)f=(f=f.insert(o[c].start+o[c].length,"</mark>")).insert(o[c].start,"<mark>");return{__searchMarks:f,__score:u}},FamilyTree._search.searchIndexesOf=function(e,t){var i=[];if(!FamilyTree.isNEU(e))for(var r=0;r<t.length;r++){var a=t[r];if(!FamilyTree.isNEU(a))for(var o=0;(o=e.indexOf(a,o))>-1;)i.push({length:a.length,start:o}),o+=a.length}return i.sort((function(e,t){return e.length<t.length?1:e.length>t.length||e.start<t.start?-1:e.start>t.start?1:0})),i=i.filter((function(e){for(var t=!1,r=0;r<i.length;r++){var a=i[r].start,o=i[r].start+i[r].length-1,n=e.start,l=e.start+e.length-1;if(a==n&&o==l){t=!1;break}if(a>=n&&o<=l){t=!0;break}if(a<=n&&o>=l){t=!0;break}}return!t}))},FamilyTree.prototype.hideTreeMenu=function(e,t){if(this._tree_menu_temp){var i=this._tree_menu_temp;if(this.manager.oldNodes=this.nodes,this.nodes=i.nodes,this.manager.maxX=i.maxX,this.manager.maxY=i.maxY,this.manager.minX=i.minX,this.manager.minY=i.minY,this.manager.roots=i.roots,this.manager.nodes=i.nodes,this.manager.rootList=i.rootList,this.manager.visibleNodeIds=i.visibleNodeIds,this.manager.bordersByRootIdAndLevel=i.bordersByRootIdAndLevel,this.config.roots=i.config.roots,this.config.nodes=i.config.nodes,this._tree_menu_temp=null,e){var r={id:i.id,animFromClickedNode:!1};this._draw(!0,FamilyTree.action.update,r,(function(){t&&t()}))}}},FamilyTree.prototype.showTreeMenu=function(e){null==e&&console.error("Call addNode without id");var t=this.getNode(e);t||console.error("Cannot get node id: "+e);var i=this.getNode(t.fid),r=this.getNode(t.mid),a=null,o=null,n=[],l=[];i&&(a=this.get(i.id)),r&&(o=this.get(r.id));for(var s=0;s<t.pids.length;s++){var d=this.get(t.pids[s]);d&&n.push(d)}for(s=0;s<t.ftChildrenIds.length;s++)l.push(this.get(t.ftChildrenIds[s]));var c=this.get(e);if(this._tree_menu_temp={maxX:this.manager.maxX,maxY:this.manager.maxY,minX:this.manager.minX,minY:this.manager.minY,roots:this.manager.roots,nodes:this.manager.nodes,rootList:this.manager.rootList,visibleNodeIds:this.manager.visibleNodeIds,bordersByRootIdAndLevel:this.manager.bordersByRootIdAndLevel,id:e,config:{roots:this.config.roots,nodes:this.config.nodes}},this.config.nodes=[],o)this.add(o);else{var m={id:"_ft_mother",templateName:"mother",_ft_method:"addParentNode",_ft_childId:e,_ft_type:"mid",_ft_data:{gender:"female"}};c.mid=m.id,a?(a.pids=[m.id],m.pids=[a.id],m._ft_data.pids=[a.id]):m.pids=["_ft_father"],this.add(m)}if(a)this.add(a);else{var p={id:"_ft_father",templateName:"father",_ft_method:"addParentNode",_ft_childId:e,_ft_type:"fid",_ft_data:{gender:"male"}};c.fid=p.id,o?(o.pids=[p.id],p.pids=[o.id],p._ft_data.pids=[o.id]):p.pids=["_ft_mother"],this.add(p)}for(s=0;s<n.length;s++)this.add(n[s]);c.pids||(c.pids=[]);var h={id:"_ft_partner",pids:[e],templateName:"partner",_ft_method:"addPartnerNode",_ft_data:{pids:[e]}};if("male"==c.gender?(h.templateName="wife",h._ft_data.gender="female"):"female"==c.gender&&(h.templateName="husband",h._ft_data.gender="male"),c.pids.push(h.id),this.add(h),c.pids)for(s=0;s<c.pids.length;s++){if(this.add({id:"_ft_child_group_"+s,mid:e,fid:c.pids[s],tags:["children-group"]}),"_ft_partner"==c.pids[s]){var u={id:"_ft_son_"+s,stpid:"_ft_child_group_"+s,templateName:"son",_ft_method:"addChildAndPartnerNodes",_ft_childData:{mid:t.id,fid:h.id,gender:"male"},_ft_parentData:{pids:[e]},_ft_id:e},f={id:"_ft_daughter_"+s,stpid:"_ft_child_group_"+s,templateName:"daughter",_ft_method:"addChildAndPartnerNodes",_ft_childData:{mid:t.id,fid:h.id,gender:"female"},_ft_parentData:{pids:[e]},_ft_id:e};"male"==c.gender&&"female"==h._ft_data.gender?(u._ft_childData.mid=h.id,u._ft_childData.fid=c.id,u._ft_parentData.gender=h._ft_data.gender,f._ft_childData.mid=h.id,f._ft_childData.fid=c.id,f._ft_parentData.gender=h._ft_data.gender):"female"==c.gender&&"male"==h._ft_data.gender&&(u._ft_childData.mid=c.id,u._ft_childData.fid=h.id,u._ft_parentData.gender=h._ft_data.gender,f._ft_childData.mid=c.id,f._ft_childData.fid=h.id,f._ft_parentData.gender=h._ft_data.gender),this.add(u),this.add(f)}else this.add({id:"_ft_son_"+s,stpid:"_ft_child_group_"+s,templateName:"son",_ft_method:"addChildNode",_ft_data:{mid:e,fid:c.pids[s],gender:"male"}}),this.add({id:"_ft_daughter_"+s,stpid:"_ft_child_group_"+s,templateName:"daughter",_ft_method:"addChildNode",_ft_data:{mid:e,fid:c.pids[s],gender:"female"}});for(var y=0;y<l.length;y++)l[y].mid!=c.pids[s]&&l[y].fid!=c.pids[s]||(l[y].mid=void 0,l[y].fid=void 0,l[y].stpid="_ft_child_group_"+s,this.add(l[y]))}this.add(c);var g=this;FamilyTree.isNEU(c.mid)?FamilyTree.isNEU(c.fid)||(this.config.roots=[c.fid]):this.config.roots=[c.mid];var b={id:e,treeMenuMode:!0};this._draw(!1,FamilyTree.action.update,b,(function(){FamilyTree._moveToBoundaryArea(g.getSvg(),g.getViewBox(),g.response.boundary)}))},FamilyTree.templates={},FamilyTree.templates.base={defs:`<g transform="matrix(1,0,0,1,0,0)" id="dot"><circle class="ba-fill" cx="0" cy="0" r="5" stroke="#aeaeae" stroke-width="1"></circle></g>\n            <g id="base_node_menu" style="cursor:pointer;"><rect x="0" y="0" fill="transparent" width="22" height="22"></rect><circle cx="4" cy="11" r="2" fill="#ffffff"></circle><circle cx="11" cy="11" r="2" fill="#ffffff"></circle><circle cx="18" cy="11" r="2" fill="#ffffff"></circle></g>\n            <g style="cursor: pointer;" id="base_tree_menu">\n                <rect x="0" y="0" width="25" height="25" fill="transparent"></rect>\n                ${FamilyTree.icon.addUser(25,25,"#fff",0,0)}\n            </g>\n            <g style="cursor: pointer;" id="base_tree_menu_close">\n                <circle cx="12.5" cy="12.5" r="12" fill="#F57C00"></circle>\n                ${FamilyTree.icon.close(25,25,"#fff",0,0)}\n            </g>            \n            <g id="base_up">\n                <circle cx="15" cy="15" r="15" fill="#fff" stroke="#aeaeae" stroke-width="1"></circle>\n                ${FamilyTree.icon.ft(20,20,"#aeaeae",5,5)}\n            </g>\n            <clipPath id="base_img_0"><rect id="base_img_0_stroke" stroke-width="3" stroke="#fff" x="170" y="-5" rx="25" ry="25" width="70" height="70"></rect></clipPath>`,size:[250,120],linkAdjuster:{fromX:0,fromY:0,toX:0,toY:0},ripple:{radius:0,color:"#e6e6e6",rect:null},expandCollapseSize:0,svg:'<svg class="{template} {mode}" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"  style="display:block;" width="{w}" height="{h}" viewBox="{viewBox}">{content}</svg>',link:'<path stroke-linejoin="round" stroke="#aeaeae" stroke-width="1px" fill="none" d="{rounded}" />',assistanseLink:'<path stroke-linejoin="round" stroke="#aeaeae" stroke-width="2px" fill="none" d="M{xa},{ya} {xb},{yb} {xc},{yc} {xd},{yd} L{xe},{ye}"/>',pointer:'<g data-pointer="pointer" transform="matrix(0,0,0,0,100,100)"><radialGradient id="pointerGradient"><stop stop-color="#ffffff" offset="0" /><stop stop-color="#C1C1C1" offset="1" /></radialGradient><circle cx="16" cy="16" r="16" stroke-width="1" stroke="#acacac" fill="url(#pointerGradient)"></circle></g>',node:'<rect x="0" y="0" height="{h}" width="{w}" stroke-width="1" stroke="#aeaeae" rx="7" ry="7"></rect>',menuButton:'<div style="position:absolute;right:{p}px;top:{p}px; width:40px;height:50px;cursor:pointer;" '+FamilyTree.attr.control_export_menu+'=""><hr style="background-color: #7A7A7A; height: 3px; border: none;"><hr style="background-color: #7A7A7A; height: 3px; border: none;"><hr style="background-color: #7A7A7A; height: 3px; border: none;"></div>',padding:[50,20,35,20],nodeMenuButton:`<use ${FamilyTree.attr.control_node_menu_id}="{id}" x="220" y="95" xlink:href="#base_node_menu"/>`,nodeTreeMenuButton:'<use data-ctrl-n-t-menu-id="{id}" x="10" y="10" xlink:href="#base_tree_menu"/>',nodeTreeMenuCloseButton:'<use data-ctrl-n-t-menu-c="" x="10" y="10" xlink:href="#base_tree_menu_close"/>',up:'<use x="110" y="-10" xlink:href="#base_up"/>',img_0:'<use xlink:href="#base_img_0_stroke" /><image preserveAspectRatio="xMidYMid slice" clip-path="url(#base_img_0)" xlink:href="{val}"  x="170" y="-5"  width="70" height="70"></image>',link_field_0:'<text text-anchor="middle" fill="#aeaeae" '+FamilyTree.attr.width+'="290" x="0" y="0" style="font-size:10px;">{val}</text>'},FamilyTree.templates.tommy=Object.assign({},FamilyTree.templates.base),FamilyTree.templates.tommy.defs="<style>\n                                        .tommy .node>rect{\n                                            fill: #aeaeae;\n                                        }\n                                        .tommy .node.male>rect{\n                                            fill: #039BE5;\n                                        }        \n                                        .tommy .node.female>rect{\n                                            fill: #F57C00;\n                                        }\n                                        .tommy .edit-form-header, .tommy .ba-img-button{\n                                            background-color: #aeaeae;\n                                        }\n                                        .tommy.male .edit-form-header, .tommy.male .ba-img-button{\n                                            background-color: #039BE5;\n                                        }\n                                        .tommy.female .edit-form-header, .tommy.female .ba-img-button{\n                                            background-color: #F57C00;\n                                        }        \n                                        .tommy.female .ba-img-button:hover{\n                                            background-color: #039BE5 !important;\n                                        }\n                                    </style>",FamilyTree.templates.tommy.field_0="<text "+FamilyTree.attr.width+'="230" style="font-size: 18px;font-weight:bold;" fill="#ffffff" x="10" y="90" text-anchor="start">{val}</text>',FamilyTree.templates.tommy.field_1="<text "+FamilyTree.attr.width+'="150" style="font-size: 14px;" fill="#ffffff" x="10" y="65" text-anchor="start">{val}</text>',FamilyTree.templates.hugo=Object.assign({},FamilyTree.templates.base),FamilyTree.templates.hugo.defs=`<clipPath id="hugo_img_0"><rect id="hugo_img_0_stroke" stroke-width="2" stroke="#fff" x="90" y="-5" rx="25" ry="25" width="70" height="70"></rect></clipPath>\n                                    <linearGradient id="hugo_grad_female" x1="0%" y1="0%" x2="100%" y2="0%">\n                                        <stop offset="0%" style="stop-color:#FF8024;stop-opacity:1" />\n                                        <stop offset="100%" style="stop-color:#FF46A3;stop-opacity:1" />\n                                    </linearGradient>\n                                    <linearGradient id="hugo_grad_male" x1="0%" y1="0%" x2="100%" y2="0%">\n                                        <stop offset="0%" style="stop-color:#00D3A5;stop-opacity:1" />\n                                        <stop offset="100%" style="stop-color:#00A7D4;stop-opacity:1" />\n                                    </linearGradient>\n                                    <linearGradient id="hugo_grad" x1="0%" y1="0%" x2="100%" y2="0%">\n                                        <stop offset="0%" style="stop-color:#D0D0D0;stop-opacity:1" />\n                                        <stop offset="100%" style="stop-color:#909090;stop-opacity:1" />\n                                    </linearGradient>\n                                    <g id="hugo_up">\n                                        <circle cx="12" cy="12" r="15" fill="transparent" ></circle>\n                                        ${FamilyTree.icon.ft(24,24,"#fff",0,0)}\n                                    </g>\n                                    <g id="hugo_node_menu" style="cursor:pointer;"><rect x="0" y="0" fill="transparent" width="22" height="22"></rect><circle cx="11" cy="4" r="2" fill="#ffffff"></circle><circle cx="11" cy="11" r="2" fill="#ffffff"></circle><circle cx="11" cy="18" r="2" fill="#ffffff"></circle></g>\n                                    <style>\n                                        .hugo .node>rect{\n                                            fill: url(#hugo_grad);\n                                        }\n                                        .hugo .node.male>rect{\n                                            fill: url(#hugo_grad_male);;\n                                        }        \n                                        .hugo .node.female>rect{\n                                            fill: url(#hugo_grad_female);\n                                        }\n                                        .hugo .edit-form-header{\n                                            background: linear-gradient(90deg, #D0D0D0 0%, #909090 100%);\n                                        }\n                                        .hugo.male .edit-form-header{\n                                            background: linear-gradient(90deg, #00D3A5 0%, #00A7D4 100%);\n                                        }\n                                        .hugo.female .edit-form-header{\n                                            background: linear-gradient(90deg, #FF8024 0%, #FF46A3 100%);\n                                        }  \n                                        .hugo .ba-img-button{\n                                            background-color: #909090 !important;\n                                        }      \n                                        .hugo .ba-img-button:hover{\n                                            background-color: #D0D0D0 !important;\n                                        }\n                                        .hugo.male .ba-img-button{\n                                            background-color: #00A7D4 !important;\n                                        }      \n                                        .hugo.male .ba-img-button:hover{\n                                            background-color: #00D3A5 !important;\n                                        }\n                                        .hugo.female .ba-img-button{\n                                            background-color: #FF46A3 !important;\n                                        }      \n                                        .hugo.female .ba-img-button:hover{\n                                            background-color: #FF8024 !important;\n                                        }\n                                        \n                                    </style>`,FamilyTree.templates.hugo.img_0='<use xlink:href="#hugo_img_0_stroke" /><image preserveAspectRatio="xMidYMid slice" clip-path="url(#hugo_img_0)" xlink:href="{val}"  x="90" y="-5"  width="70" height="70"></image>',FamilyTree.templates.hugo.field_0="<text "+FamilyTree.attr.width+'="230" style="font-size: 18px;font-weight:bold;" fill="#ffffff" x="125" y="85" text-anchor="middle">{val}</text>',FamilyTree.templates.hugo.field_1="<text "+FamilyTree.attr.width+'="230" style="font-size: 14px;" fill="#ffffff" x="125" y="105" text-anchor="middle">{val}</text>',FamilyTree.templates.hugo.up='<use x="200" y="10" xlink:href="#hugo_up"/>',FamilyTree.templates.hugo.nodeMenuButton=`<use x="225" y="10" ${FamilyTree.attr.control_node_menu_id}="{id}" xlink:href="#hugo_node_menu"/>`,FamilyTree.templates.mother=Object.assign({},FamilyTree.templates.base),FamilyTree.templates.mother.up="",FamilyTree.templates.mother.node='<rect x="0" y="0" height="{h}" width="{w}" style="fill:transparent;"  stroke-width="1" stroke="#F57C00" rx="5" ry="5"></rect><text style="font-size: 18px;" fill="#F57C00" x="240" y="30" text-anchor="end">Add mother</text>'+FamilyTree.icon.mother(70,70,"#F57C00",10,40),FamilyTree.templates.mother.field_0="",FamilyTree.templates.mother.field_1="",FamilyTree.templates.father=Object.assign({},FamilyTree.templates.mother),FamilyTree.templates.father.node='<rect x="0" y="0" height="{h}" width="{w}" style="fill:transparent;height:{h}; width:{w};stroke-width:1;stroke:#039BE5;rx:5;ry:5;"></rect><text style="font-size: 18px;" fill="#039BE5" x="240" y="30" text-anchor="end">Add father</text>'+FamilyTree.icon.father(70,70,"#039BE5",10,40),FamilyTree.templates.partner=Object.assign({},FamilyTree.templates.mother),FamilyTree.templates.partner.node='<rect x="0" y="0" height="{h}" width="{w}" style="fill:transparent;height:{h}; width:{w};stroke-width:1;stroke:#aeaeae;rx:5;ry:5;"></rect><text style="font-size: 18px;" fill="#aeaeae" x="240" y="30" text-anchor="end">Add partner</text>',FamilyTree.templates.son=Object.assign({},FamilyTree.templates.mother),FamilyTree.templates.son.node='<rect x="0" y="0" height="{h}" width="{w}" style="fill:transparent;height:{h}; width:{w};stroke-width:1;stroke:#039BE5;rx:5;ry:5;"></rect><text style="font-size: 18px;" fill="#039BE5" x="240" y="30" text-anchor="end">Add son</text>'+FamilyTree.icon.son(70,70,"#039BE5",10,40),FamilyTree.templates.daughter=Object.assign({},FamilyTree.templates.mother),FamilyTree.templates.daughter.node='<rect x="0" y="0" height="{h}" width="{w}" style="fill:transparent;height:{h}; width:{w};stroke-width:1;stroke:#F57C00;rx:5;ry:5;"></rect><text style="font-size: 18px;" fill="#F57C00" x="240" y="30" text-anchor="end">Add daughter</text>'+FamilyTree.icon.daughter(70,70,"#F57C00",10,40),FamilyTree.templates.husband=Object.assign({},FamilyTree.templates.mother),FamilyTree.templates.husband.node='<rect x="0" y="0" height="{h}" width="{w}" style="fill:transparent;height:{h}; width:{w};stroke-width:1;stroke:#039BE5;rx:5;ry:5;"></rect><text style="font-size: 18px;" fill="#039BE5" x="240" y="30" text-anchor="end">Add husband</text>'+FamilyTree.icon.husband(70,70,"#039BE5",10,40),FamilyTree.templates.wife=Object.assign({},FamilyTree.templates.mother),FamilyTree.templates.wife.node='<rect x="0" y="0" height="{h}" width="{w}" style="fill:transparent;height:{h}; width:{w};stroke-width:1;stroke:#F57C00;rx:5;ry:5;"></rect><text style="font-size: 18px;" fill="#F57C00" x="240" y="30" text-anchor="end">Add wife</text>'+FamilyTree.icon.wife(70,70,"#F57C00",10,40),FamilyTree.templates.pet=Object.assign({},FamilyTree.templates.mother),FamilyTree.templates.pet.node='<rect x="0" y="0" style="fill:transparent;height:{h}; width:{w};stroke-width:1;stroke:#F57C00;rx:5;ry:5;"></rect><text style="font-size: 18px;" fill="#F57C00" x="240" y="30" text-anchor="end">Add pet</text>'+FamilyTree.icon.teddy(70,70,"#F57C00",10,40),FamilyTree.templates.cgroup=Object.assign({},FamilyTree.templates.base),FamilyTree.templates.cgroup.defs="",FamilyTree.templates.cgroup.size=[250,120],FamilyTree.templates.cgroup.padding=[0,0,0,0],FamilyTree.templates.cgroup.node="",FamilyTree.templates.split=Object.assign({},FamilyTree.templates.base),FamilyTree.templates.split.size=[10,10],FamilyTree.templates.split.node='<circle cx="5" cy="5" r="5" fill="none" stroke-width="1" stroke="#aeaeae"></circle>',FamilyTree.templates.mirror={linkAdjuster:{},link:"",node:"",nodeMenuButton:"",size:[0,0]};export default FamilyTree;